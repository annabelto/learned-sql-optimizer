{"schema":{"fields":[{"name":"index","type":"integer"},{"name":"rewrite rule","type":"string"},{"name":"original query","type":"string"},{"name":"rewritten query","type":"string"}],"primaryKey":["index"],"pandas_version":"1.4.0"},"data":[{"index":1,"rewrite rule":"testPushAggregateThroughJoinOnEmptyLogicalValues","original query":"SELECT COUNT(*) AS \"VOLUME\", SUM(\"t0\".\"SAL\") AS \"C1_SUM_SAL\" FROM (SELECT \"SAL\", \"ENAME\" FROM \"EMP\" WHERE 1 = 2) AS \"t0\" INNER JOIN (SELECT \"ENAME\" FROM \"EMP\") AS \"t1\" ON \"t0\".\"ENAME\" = \"t1\".\"ENAME\"","rewritten query":"SELECT COALESCE(SUM(\"t8\".\"VOLUME\"), 0) AS \"VOLUME\", SUM(CAST(\"t6\".\"SAL\" * \"t8\".\"VOLUME\" AS INTEGER)) AS \"C1_SUM_SAL\" FROM (SELECT \"ENAME\", \"SAL\" FROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\") WHERE 1 = 0) AS \"t6\" INNER JOIN (SELECT \"ENAME\", COUNT(*) AS \"VOLUME\" FROM \"EMP\" GROUP BY \"ENAME\") AS \"t8\" ON \"t6\".\"ENAME\" = \"t8\".\"ENAME\""},{"index":2,"rewrite rule":"testIntersectToDistinct","original query":"SELECT * FROM (SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 10 INTERSECT SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 20) AS \"t\" INTERSECT SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 30","rewritten query":"SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\" FROM (SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\", COUNT(*) AS \"$f9\" FROM \"EMP\" WHERE \"DEPTNO\" = 10 GROUP BY \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\" UNION ALL SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\", COUNT(*) AS \"$f9\" FROM \"EMP\" WHERE \"DEPTNO\" = 20 GROUP BY \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\" UNION ALL SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\", COUNT(*) AS \"$f9\" FROM \"EMP\" WHERE \"DEPTNO\" = 30 GROUP BY \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\") AS \"t16\" GROUP BY \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\" HAVING COUNT(*) = 3"},{"index":3,"rewrite rule":"testEmptyProject2","original query":"SELECT \"X\" + \"Y\" + \"X\" FROM (VALUES (10, 1), (30, 3)) AS \"t\" (\"X\", \"Y\") WHERE \"X\" + \"Y\" > 50","rewritten query":"SELECT * FROM (VALUES (NULL)) AS \"t\" (\"EXPR$0\") WHERE 1 = 0"},{"index":4,"rewrite rule":"testSemiJoinProjectTranspose","original query":"SELECT \"NAME\" FROM \"DEPT\" WHERE EXISTS (SELECT 1 FROM (SELECT 2 * \"DEPTNO\" AS \"$f0\" FROM \"DEPT\" GROUP BY 2 * \"DEPTNO\") AS \"t0\" WHERE \"DEPT\".\"DEPTNO\" = \"t0\".\"$f0\")","rewritten query":"SELECT \"NAME\" FROM (SELECT \"DEPTNO\", \"NAME\" FROM \"DEPT\" WHERE EXISTS (SELECT 1 FROM (SELECT 2 * \"DEPTNO\" AS \"$f0\" FROM \"DEPT\" GROUP BY 2 * \"DEPTNO\") AS \"t5\" WHERE \"DEPTNO\" = \"t5\".\"$f0\")) AS \"t2\""},{"index":5,"rewrite rule":"testEmptyFilterProjectUnion","original query":"SELECT * FROM (SELECT * FROM (VALUES (10, 1), (30, 3)) AS \"t\" (\"X\", \"Y\") UNION ALL SELECT * FROM (VALUES (20, 2)) AS \"t\" (\"EXPR$0\", \"EXPR$1\")) AS \"t3\" WHERE \"X\" + \"Y\" > 30","rewritten query":"SELECT * FROM (VALUES (30, 3)) AS \"t\" (\"X\", \"Y\")"},{"index":6,"rewrite rule":"testExistsWithNoRowSubQuery","original query":"SELECT * FROM \"DEPT\" WHERE NOT EXISTS (SELECT * FROM (VALUES (NULL)) AS \"t\" (\"EXPR$0\") WHERE 1 = 0)","rewritten query":"SELECT * FROM \"DEPT\""},{"index":7,"rewrite rule":"testSortProjectTranspose1","original query":"SELECT \"DEPTNO\", \"DEPTNO\" FROM \"DEPT\" ORDER BY 2 OFFSET 1 ROWS","rewritten query":"SELECT \"DEPTNO\", \"DEPTNO\" FROM \"DEPT\" ORDER BY \"DEPTNO\" OFFSET 1 ROWS"},{"index":8,"rewrite rule":"testSortProjectTranspose2","original query":"SELECT \"DEPTNO\", CAST(\"DEPTNO\" AS DOUBLE PRECISION) FROM \"DEPT\" ORDER BY CAST(\"DEPTNO\" AS DOUBLE PRECISION) OFFSET 1 ROWS","rewritten query":"SELECT \"DEPTNO\", CAST(\"DEPTNO\" AS DOUBLE PRECISION) FROM \"DEPT\" ORDER BY \"DEPTNO\" OFFSET 1 ROWS"},{"index":9,"rewrite rule":"testLeftEmptyLeftJoin","original query":"SELECT * FROM (SELECT * FROM \"EMP\" WHERE FALSE) AS \"t0\" LEFT JOIN \"DEPT\" ON \"t0\".\"DEPTNO\" = \"DEPT\".\"DEPTNO\"","rewritten query":"SELECT * FROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\", \"DEPTNO0\", \"NAME\") WHERE 1 = 0"},{"index":10,"rewrite rule":"testPullNull","original query":"SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 7 AND \"EMPNO\" = 10 AND \"MGR\" IS NULL AND \"EMPNO\" = 10","rewritten query":"SELECT 10 AS \"EMPNO\", \"ENAME\", \"JOB\", CAST(NULL AS INTEGER) AS \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", 7 AS \"DEPTNO\", \"SLACKER\" FROM \"EMP\" WHERE \"DEPTNO\" = 7 AND \"EMPNO\" = 10 AND \"MGR\" IS NULL"},{"index":11,"rewrite rule":"testReduceCastAndConsts","original query":"SELECT * FROM \"EMP\" WHERE CAST(\"EMPNO\" + 10 \/ 2 AS INTEGER) = 13","rewritten query":"SELECT * FROM \"EMP\" WHERE \"EMPNO\" + 5 = 13"},{"index":12,"rewrite rule":"testAggregateCaseToFilter","original query":"SELECT SUM(\"SAL\") AS \"SUM_SAL\", COUNT(DISTINCT CASE WHEN \"JOB\" = 'CLERK' THEN \"DEPTNO\" ELSE NULL END) AS \"COUNT_DISTINCT_CLERK\", SUM(CASE WHEN \"DEPTNO\" = 10 THEN \"SAL\" ELSE NULL END) AS \"SUM_SAL_D10\", SUM(CASE WHEN \"DEPTNO\" = 20 THEN \"SAL\" ELSE 0 END) AS \"SUM_SAL_D20\", SUM(CASE WHEN \"DEPTNO\" = 30 THEN 1 ELSE 0 END) AS \"COUNT_D30\", COUNT(CASE WHEN \"DEPTNO\" = 40 THEN 'x' ELSE NULL END) AS \"COUNT_D40\", SUM(CASE WHEN \"DEPTNO\" = 45 THEN 1 ELSE NULL END) AS \"COUNT_D45\", SUM(CASE WHEN \"DEPTNO\" = 50 THEN 1 ELSE NULL END) AS \"COUNT_D50\", SUM(CAST(NULL AS DECIMAL(19, 9))) AS \"SUM_NULL_D60\", SUM(CASE WHEN \"DEPTNO\" = 70 THEN NULL ELSE 1 END) AS \"SUM_NULL_D70\", COUNT(CASE WHEN \"DEPTNO\" = 20 THEN 1 ELSE NULL END) AS \"COUNT_D20\" FROM \"EMP\"","rewritten query":"SELECT SUM(\"SAL\") AS \"SUM_SAL\", COUNT(DISTINCT \"DEPTNO\") FILTER (WHERE \"JOB\" = 'CLERK') AS \"COUNT_DISTINCT_CLERK\", SUM(\"SAL\") FILTER (WHERE \"DEPTNO\" = 10) AS \"SUM_SAL_D10\", SUM(\"SAL\") FILTER (WHERE \"DEPTNO\" = 20) AS \"SUM_SAL_D20\", CAST(COUNT(*) FILTER (WHERE \"DEPTNO\" = 30) AS INTEGER) AS \"COUNT_D30\", COUNT(*) FILTER (WHERE \"DEPTNO\" = 40) AS \"COUNT_D40\", SUM(1) FILTER (WHERE \"DEPTNO\" = 45) AS \"COUNT_D45\", SUM(1) FILTER (WHERE \"DEPTNO\" = 50) AS \"COUNT_D50\", SUM(CAST(NULL AS DECIMAL(19, 9))) AS \"SUM_NULL_D60\", SUM(1) FILTER (WHERE \"DEPTNO\" <> 70) AS \"SUM_NULL_D70\", COUNT(*) FILTER (WHERE \"DEPTNO\" = 20) AS \"COUNT_D20\" FROM \"EMP\""},{"index":13,"rewrite rule":"testPushCountNullableThroughUnion","original query":"SELECT \"ENAME\", COUNT(\"MGR\") FROM (SELECT * FROM \"EMP\" UNION ALL SELECT * FROM \"EMP\") AS \"t1\" GROUP BY \"ENAME\"","rewritten query":"SELECT \"ENAME\", COALESCE(SUM(\"EXPR$1\"), 0) FROM (SELECT \"ENAME\", COUNT(\"MGR\") AS \"EXPR$1\" FROM \"EMP\" GROUP BY \"ENAME\" UNION ALL SELECT \"ENAME\", COUNT(\"MGR\") AS \"EXPR$1\" FROM \"EMP\" GROUP BY \"ENAME\") AS \"t8\" GROUP BY \"ENAME\""},{"index":14,"rewrite rule":"testReduceCase","original query":"SELECT CASE WHEN FALSE THEN 2.1 ELSE 1 END AS \"NEWCOL\" FROM \"EMP\"","rewritten query":"SELECT 1 AS \"NEWCOL\" FROM \"EMP\""},{"index":15,"rewrite rule":"testEmptyAggregateEmptyKeyWithAggregateValuesRule","original query":"SELECT COUNT(*), SUM(\"EMPNO\") FROM \"EMP\" WHERE FALSE","rewritten query":"SELECT * FROM (VALUES (0, NULL)) AS \"t\" (\"EXPR$0\", \"EXPR$1\")"},{"index":16,"rewrite rule":"testSemiJoinRuleWithJoinOnUniqueInputWithAlias","original query":"SELECT \"t\".\"DEPTNO\" AS \"DEPARTMENT_ID\", \"t\".\"SAL\" AS \"SALARY\" FROM (SELECT \"SAL\", \"DEPTNO\" FROM \"EMP\") AS \"t\" INNER JOIN (SELECT \"DEPTNO\" FROM \"DEPT\") AS \"t0\" ON \"t\".\"DEPTNO\" = \"t0\".\"DEPTNO\"","rewritten query":"SELECT \"DEPTNO\" AS \"DEPARTMENT_ID\", \"SAL\" AS \"SALARY\" FROM (SELECT \"SAL\", \"DEPTNO\" FROM \"EMP\" WHERE EXISTS (SELECT 1 FROM (SELECT \"DEPTNO\" FROM \"DEPT\") AS \"t3\" WHERE \"DEPTNO\" = \"t3\".\"DEPTNO\")) AS \"t2\""},{"index":17,"rewrite rule":"testPullConstantThroughAggregateAllConst","original query":"SELECT \"t\".\"EXPR$0\", 2 + 3 AS \"$f1\", MAX(\"t\".\"FIVE\") FROM \"EMP\", (VALUES (4, 5)) AS \"t\" (\"EXPR$0\", \"FIVE\") GROUP BY \"t\".\"EXPR$0\", 2 + 3","rewritten query":"SELECT \"t2\".\"EXPR$0\", 2 + 3, MAX(\"t2\".\"FIVE\") FROM \"EMP\" AS \"EMP0\", (VALUES (4, 5)) AS \"t2\" (\"EXPR$0\", \"FIVE\") GROUP BY \"t2\".\"EXPR$0\""},{"index":18,"rewrite rule":"testGroupByDateLiteralSimple","original query":"SELECT AVG(\"EMP\".\"SAL\") FROM \"EMP\", (VALUES (DATE '2022-01-01')) AS \"t\" (\"$f0\") GROUP BY \"t\".\"$f0\"","rewritten query":"SELECT AVG(\"EMP0\".\"SAL\") FROM \"EMP\" AS \"EMP0\", (VALUES (DATE '2022-01-01')) AS \"t3\" (\"$f0\") GROUP BY \"t3\".\"$f0\""},{"index":19,"rewrite rule":"testReduceValuesUnderProjectFilter","original query":"SELECT \"A\" + \"B\" AS \"X\", \"B\", \"A\" FROM (VALUES (10, 1), (30, 7), (20, 3)) AS \"t\" (\"A\", \"B\") WHERE \"A\" - \"B\" < 21","rewritten query":"SELECT * FROM (VALUES (11, 1, 10), (23, 3, 20)) AS \"t\" (\"X\", \"B\", \"A\")"},{"index":20,"rewrite rule":"testMergeMinus","original query":"SELECT * FROM (SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 10 EXCEPT SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 20) AS \"t\" EXCEPT SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 30","rewritten query":"SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 10 EXCEPT SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 20 EXCEPT SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 30"},{"index":21,"rewrite rule":"testDistinctWithDiffFiltersAndSameGroupSet","original query":"SELECT COUNT(DISTINCT \"SAL\" > 1000) FILTER (WHERE \"SAL\" < 500), COUNT(DISTINCT \"SAL\" < 500) FILTER (WHERE \"SAL\" > 1000) FROM \"EMP\"","rewritten query":"SELECT COUNT(\"C\") FILTER (WHERE \"$g_0_f_1\"), COUNT(\"D\") FILTER (WHERE \"$g_0_f_0\") FROM (SELECT \"SAL\" > 1000 AS \"C\", \"SAL\" < 500 AS \"D\", GROUPING(\"SAL\" > 1000, \"SAL\" < 500) = 0 AND \"SAL\" > 1000 AS \"$g_0_f_0\", GROUPING(\"SAL\" > 1000, \"SAL\" < 500) = 0 AND \"SAL\" < 500 AS \"$g_0_f_1\" FROM \"EMP\" GROUP BY \"SAL\" > 1000, \"SAL\" < 500) AS \"t3\""},{"index":22,"rewrite rule":"testDecorrelateTwoExists","original query":"SELECT * FROM \"EMP\" WHERE EXISTS (SELECT * FROM \"EMP\" WHERE \"EMP\".\"DEPTNO\" = \"DEPTNO\") AND NOT EXISTS (SELECT * FROM \"EMP\" WHERE \"JOB\" = \"EMP\".\"JOB\" AND \"SAL\" = 34)","rewritten query":"SELECT \"EMP2\".\"EMPNO\", \"EMP2\".\"ENAME\", \"EMP2\".\"JOB\", \"EMP2\".\"MGR\", \"EMP2\".\"HIREDATE\", \"EMP2\".\"SAL\", \"EMP2\".\"COMM\", \"EMP2\".\"DEPTNO\", \"EMP2\".\"SLACKER\" FROM \"EMP\" AS \"EMP2\" INNER JOIN (SELECT \"DEPTNO\", TRUE AS \"$f1\" FROM \"EMP\" GROUP BY \"DEPTNO\") AS \"t5\" ON \"EMP2\".\"DEPTNO\" = \"t5\".\"DEPTNO\" LEFT JOIN (SELECT \"JOB\", TRUE AS \"$f1\" FROM \"EMP\" WHERE \"SAL\" = 34 GROUP BY \"JOB\") AS \"t9\" ON \"EMP2\".\"JOB\" = \"t9\".\"JOB\" WHERE \"t9\".\"$f1\" IS NULL"},{"index":23,"rewrite rule":"testEmptyMinus","original query":"SELECT * FROM (SELECT * FROM (VALUES (30, 3)) AS \"t\" (\"X\", \"Y\") WHERE \"X\" > 30 EXCEPT SELECT * FROM (VALUES (20, 2)) AS \"t\" (\"EXPR$0\", \"EXPR$1\")) AS \"t\" EXCEPT SELECT * FROM (VALUES (40, 4)) AS \"t\" (\"EXPR$0\", \"EXPR$1\")","rewritten query":"SELECT * FROM (VALUES (NULL, NULL)) AS \"t\" (\"X\", \"Y\") WHERE 1 = 0"},{"index":24,"rewrite rule":"testFlattenUncorrelatedTwoLevelCallBelowEqualsSucceeds","original query":"SELECT \"$cor0\".\"EMPNO\", \"$cor0\".\"ENAME\", \"$cor0\".\"JOB\", \"$cor0\".\"MGR\", \"$cor0\".\"HIREDATE\", \"$cor0\".\"SAL\", \"$cor0\".\"COMM\", \"$cor0\".\"DEPTNO\", \"$cor0\".\"SLACKER\" FROM \"EMP\" AS \"$cor0\", LATERAL (SELECT MIN(TRUE) AS \"$f0\" FROM \"EMP\" WHERE \"$cor0\".\"DEPTNO\" = 2 * \"DEPTNO\" + 30) AS \"t1\" WHERE \"$cor0\".\"$f0\" IS NOT NULL","rewritten query":"SELECT \"$cor0\".\"EMPNO\", \"$cor0\".\"ENAME\", \"$cor0\".\"JOB\", \"$cor0\".\"MGR\", \"$cor0\".\"HIREDATE\", \"$cor0\".\"SAL\", \"$cor0\".\"COMM\", \"$cor0\".\"DEPTNO\", \"$cor0\".\"SLACKER\" FROM \"EMP\" AS \"$cor0\", LATERAL (SELECT MIN(TRUE) AS \"$f0\" FROM (SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\", 2 * \"DEPTNO\" + 30 AS \"$f9\" FROM \"EMP\") AS \"t4\" WHERE \"$cor0\".\"DEPTNO\" = \"$f9\") AS \"t8\" WHERE \"$cor0\".\"$f0\" IS NOT NULL"},{"index":25,"rewrite rule":"testReduceValuesUnderProject","original query":"SELECT \"A\" + \"B\" FROM (VALUES (10, 1), (20, 3)) AS \"t\" (\"A\", \"B\")","rewritten query":"SELECT * FROM (VALUES (11), (23)) AS \"t\" (\"EXPR$0\")"},{"index":26,"rewrite rule":"testPushProjectWithIsNotDistinctFromPastJoin","original query":"SELECT \"t\".\"SAL\" + \"t0\".\"COMM\" FROM (SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\", \"ENAME\" || \"JOB\" AS \"$f9\" FROM \"EMP\") AS \"t\" INNER JOIN (SELECT \"ENAME\", \"JOB\", \"SAL\", \"COMM\", \"ENAME\" || \"JOB\" AS \"$f4\" FROM \"BONUS\") AS \"t0\" ON \"t\".\"$f9\" IS NOT DISTINCT FROM \"t0\".\"$f4\" AND \"t\".\"DEPTNO\" = 10","rewritten query":"SELECT \"t3\".\"SAL\" + \"t5\".\"COMM\" FROM (SELECT \"SAL\", \"ENAME\" || \"JOB\" AS \"$f9\", \"DEPTNO\" = 10 AS \"EXPR$0\" FROM \"EMP\") AS \"t3\" INNER JOIN (SELECT \"COMM\", \"ENAME\" || \"JOB\" AS \"$f4\" FROM \"BONUS\") AS \"t5\" ON \"t3\".\"$f9\" IS NOT DISTINCT FROM \"t5\".\"$f4\" AND \"t3\".\"EXPR$0\""},{"index":27,"rewrite rule":"testAggregateConstantKeyRule","original query":"SELECT COUNT(*) AS \"C\" FROM \"EMP\" WHERE \"DEPTNO\" = 10 GROUP BY \"DEPTNO\", \"SAL\"","rewritten query":"SELECT COUNT(*) AS \"C\" FROM \"EMP\" WHERE \"DEPTNO\" = 10 GROUP BY \"SAL\""},{"index":28,"rewrite rule":"testExpandFilterExistsSimpleAnd","original query":"SELECT \"EMPNO\" FROM \"EMP\" WHERE EXISTS (SELECT * FROM \"EMP\" WHERE \"EMPNO\" < 20) AND \"SAL\" < 100","rewritten query":"SELECT \"EMP1\".\"EMPNO\" FROM \"EMP\" AS \"EMP1\", (SELECT \"t3\".\"i\" FROM (SELECT * FROM \"EMP\" WHERE \"EMPNO\" < 20) AS \"t2\", (VALUES (TRUE)) AS \"t3\" (\"i\") GROUP BY \"t3\".\"i\") AS \"t5\" WHERE \"EMP1\".\"SAL\" < 100"},{"index":29,"rewrite rule":"testReduceValuesUnderFilter","original query":"SELECT * FROM (VALUES (10, 'x'), (20, 'y')) AS \"t\" (\"A\", \"B\") WHERE \"A\" < 15","rewritten query":"SELECT * FROM (VALUES (10, 'x')) AS \"t\" (\"A\", \"B\")"},{"index":30,"rewrite rule":"testNestedAggregates","original query":"SELECT CAST((SUM(\"$f1\" + 2 * \"$f2\" + 3 * \"$f3\") OVER (PARTITION BY \"DEPTNO\" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)) \/ (COUNT(\"$f1\" + 2 * \"$f2\" + 3 * \"$f3\") OVER (PARTITION BY \"DEPTNO\" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)) AS INTEGER) FROM (SELECT \"DEPTNO\", SUM(\"SAL\") AS \"$f1\", MIN(\"EMPNO\") AS \"$f2\", AVG(\"EMPNO\") AS \"$f3\" FROM \"EMP\" GROUP BY \"DEPTNO\") AS \"t0\"","rewritten query":"SELECT CAST((SUM(SUM(\"SAL\") + 2 * MIN(\"EMPNO\") + 3 * AVG(\"EMPNO\")) OVER (PARTITION BY \"DEPTNO\" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)) \/ (COUNT(SUM(\"SAL\") + 2 * MIN(\"EMPNO\") + 3 * AVG(\"EMPNO\")) OVER (PARTITION BY \"DEPTNO\" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)) AS INTEGER) FROM \"EMP\" GROUP BY \"DEPTNO\""},{"index":31,"rewrite rule":"testJoinAssociateRuleWithTopAlwaysTrueConditionAllowed","original query":"SELECT * FROM \"EMP\" CROSS JOIN \"BONUS\" INNER JOIN \"DEPT\" ON \"EMP\".\"DEPTNO\" = \"DEPT\".\"DEPTNO\"","rewritten query":"SELECT * FROM \"EMP\" AS \"EMP0\" INNER JOIN (\"BONUS\" AS \"BONUS0\" CROSS JOIN \"DEPT\" AS \"DEPT0\") ON \"EMP0\".\"DEPTNO\" = \"DEPT0\".\"DEPTNO\""},{"index":32,"rewrite rule":"testReduceConstantsDup","original query":"SELECT \"DEPTNO\" FROM \"DEPT\" WHERE \"DEPTNO\" = 7 AND \"DEPTNO\" = 8","rewritten query":"SELECT \"DEPTNO\" FROM (VALUES (NULL, NULL)) AS \"t\" (\"DEPTNO\", \"NAME\") WHERE 1 = 0"},{"index":33,"rewrite rule":"testDistinctCountMixedJoin","original query":"SELECT \"DEPTNO\", COUNT(DISTINCT \"ENAME\"), COUNT(DISTINCT \"JOB\", \"ENAME\"), COUNT(DISTINCT \"DEPTNO\", \"JOB\"), SUM(\"SAL\") FROM \"EMP\" GROUP BY \"DEPTNO\"","rewritten query":"SELECT \"t1\".\"DEPTNO\", \"t3\".\"EXPR$1\", \"t5\".\"EXPR$2\", \"t7\".\"EXPR$3\", \"t1\".\"EXPR$4\" FROM (SELECT \"DEPTNO\", SUM(\"SAL\") AS \"EXPR$4\" FROM \"EMP\" GROUP BY \"DEPTNO\") AS \"t1\" INNER JOIN (SELECT \"DEPTNO\", COUNT(\"ENAME\") AS \"EXPR$1\" FROM (SELECT \"ENAME\", \"DEPTNO\" FROM \"EMP\" GROUP BY \"ENAME\", \"DEPTNO\") AS \"t2\" GROUP BY \"DEPTNO\") AS \"t3\" ON \"t1\".\"DEPTNO\" IS NOT DISTINCT FROM \"t3\".\"DEPTNO\" INNER JOIN (SELECT \"DEPTNO\", COUNT(\"JOB\", \"ENAME\") AS \"EXPR$2\" FROM (SELECT \"ENAME\", \"JOB\", \"DEPTNO\" FROM \"EMP\" GROUP BY \"ENAME\", \"JOB\", \"DEPTNO\") AS \"t4\" GROUP BY \"DEPTNO\") AS \"t5\" ON \"t1\".\"DEPTNO\" IS NOT DISTINCT FROM \"t5\".\"DEPTNO\" INNER JOIN (SELECT \"DEPTNO\", COUNT(\"DEPTNO\", \"JOB\") AS \"EXPR$3\" FROM (SELECT \"JOB\", \"DEPTNO\" FROM \"EMP\" GROUP BY \"JOB\", \"DEPTNO\") AS \"t6\" GROUP BY \"DEPTNO\") AS \"t7\" ON \"t1\".\"DEPTNO\" IS NOT DISTINCT FROM \"t7\".\"DEPTNO\""},{"index":34,"rewrite rule":"testAggregateProjectMerge","original query":"SELECT \"DEPTNO\" AS \"X\", SUM(\"SAL\"), \"EMPNO\" AS \"Y\" FROM \"EMP\" GROUP BY \"DEPTNO\", \"EMPNO\"","rewritten query":"SELECT \"DEPTNO\" AS \"X\", SUM(\"SAL\"), \"EMPNO\" AS \"Y\" FROM \"EMP\" GROUP BY \"EMPNO\", \"DEPTNO\""},{"index":35,"rewrite rule":"testDistinctWithFilterWithoutGroupBy","original query":"SELECT SUM(\"COMM\"), COUNT(DISTINCT \"SAL\") FILTER (WHERE \"SAL\" > 1000) FROM \"EMP\"","rewritten query":"SELECT MIN(\"EXPR$0\") FILTER (WHERE \"$g_3\"), COUNT(\"SAL\") FILTER (WHERE \"$g_0_f_1\") FROM (SELECT \"SAL\", SUM(\"COMM\") AS \"EXPR$0\", GROUPING(\"SAL\", \"SAL\" > 1000) = 0 AND \"SAL\" > 1000 IS TRUE AS \"$g_0_f_1\", GROUPING(\"SAL\", \"SAL\" > 1000) = 3 AS \"$g_3\" FROM \"EMP\" GROUP BY GROUPING SETS((\"SAL\", \"SAL\" > 1000), ())) AS \"t3\""},{"index":36,"rewrite rule":"testReduceConstantsDupNot2Null","original query":"SELECT \"EMPNO\" FROM \"EMP\" WHERE NOT (\"MGR\" = 7 AND \"DEPTNO\" = 8 AND \"MGR\" = 8)","rewritten query":"SELECT \"EMPNO\" FROM \"EMP\" WHERE \"MGR\" IS NOT NULL OR \"DEPTNO\" <> 8"},{"index":37,"rewrite rule":"testOrAlwaysTrue","original query":"SELECT * FROM (SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"SLACKER\" FROM \"EMPNULLABLES\" WHERE \"DEPTNO\" = 20 AND \"SAL\" > 1000) AS \"t0\" WHERE \"SAL\" IS NULL OR \"SAL\" IS NOT NULL","rewritten query":"SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"SLACKER\" FROM \"EMPNULLABLES\" WHERE \"DEPTNO\" = 20 AND \"SAL\" > 1000"},{"index":38,"rewrite rule":"testIsNullPushDown2","original query":"SELECT * FROM (SELECT \"EMPNO\", \"DEPTNO\", COUNT(\"EMPNO\") OVER (RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS \"W_COUNT\" FROM \"EMP\") AS \"t\" WHERE \"W_COUNT\" IS NULL","rewritten query":"SELECT \"EMPNO\", \"DEPTNO\", \"$2\" AS \"W_COUNT\" FROM (VALUES (NULL, NULL, NULL)) AS \"t\" (\"EMPNO\", \"DEPTNO\", \"$2\") WHERE 1 = 0"},{"index":39,"rewrite rule":"testRemoveSemiJoin","original query":"SELECT \"EMP\".\"ENAME\" FROM \"EMP\", \"DEPT\" WHERE \"EMP\".\"DEPTNO\" = \"DEPT\".\"DEPTNO\"","rewritten query":"SELECT \"EMP0\".\"ENAME\" FROM \"EMP\" AS \"EMP0\" INNER JOIN \"DEPT\" AS \"DEPT0\" ON \"EMP0\".\"DEPTNO\" = \"DEPT0\".\"DEPTNO\""},{"index":40,"rewrite rule":"testPushProjectWithOverPastJoin1","original query":"SELECT \"EMP\".\"SAL\" + \"BONUS\".\"COMM\", COUNT(\"EMP\".\"EMPNO\") OVER (PARTITION BY \"EMP\".\"DEPTNO\" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) FROM \"EMP\" INNER JOIN \"BONUS\" ON \"EMP\".\"ENAME\" = \"BONUS\".\"ENAME\" AND \"EMP\".\"DEPTNO\" = 10","rewritten query":"SELECT \"t0\".\"SAL\" + \"t1\".\"COMM\", COUNT(\"t0\".\"EMPNO\") OVER (PARTITION BY \"t0\".\"DEPTNO\" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) FROM (SELECT \"EMPNO\", \"ENAME\", \"SAL\", \"DEPTNO\", \"DEPTNO\" = 10 AS \"EXPR$0\" FROM \"EMP\") AS \"t0\" INNER JOIN (SELECT \"ENAME\", \"COMM\" FROM \"BONUS\") AS \"t1\" ON \"t0\".\"ENAME\" = \"t1\".\"ENAME\" AND \"t0\".\"EXPR$0\""},{"index":41,"rewrite rule":"testPushProjectWithOverPastJoin2","original query":"SELECT \"EMP\".\"SAL\" + \"BONUS\".\"COMM\", COUNT(\"BONUS\".\"SAL\") OVER (PARTITION BY \"BONUS\".\"JOB\" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) FROM \"EMP\" INNER JOIN \"BONUS\" ON \"EMP\".\"ENAME\" = \"BONUS\".\"ENAME\" AND \"EMP\".\"DEPTNO\" = 10","rewritten query":"SELECT \"t0\".\"SAL\" + \"t1\".\"COMM\", COUNT(\"t1\".\"SAL\") OVER (PARTITION BY \"t1\".\"JOB\" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) FROM (SELECT \"ENAME\", \"SAL\", \"DEPTNO\" = 10 AS \"EXPR$0\" FROM \"EMP\") AS \"t0\" INNER JOIN (SELECT * FROM \"BONUS\") AS \"t1\" ON \"t0\".\"ENAME\" = \"t1\".\"ENAME\" AND \"t0\".\"EXPR$0\""},{"index":42,"rewrite rule":"testPushProjectWithOverPastJoin3","original query":"SELECT \"EMP\".\"SAL\" + \"BONUS\".\"COMM\", SUM(\"BONUS\".\"SAL\" + \"BONUS\".\"SAL\" + 100) OVER (PARTITION BY \"BONUS\".\"JOB\" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) FROM \"EMP\" INNER JOIN \"BONUS\" ON \"EMP\".\"ENAME\" = \"BONUS\".\"ENAME\" AND \"EMP\".\"DEPTNO\" = 10","rewritten query":"SELECT \"t0\".\"SAL\" + \"t1\".\"COMM\", SUM(\"t1\".\"EXPR$0\") OVER (PARTITION BY \"t1\".\"JOB\" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) FROM (SELECT \"ENAME\", \"SAL\", \"DEPTNO\" = 10 AS \"EXPR$0\" FROM \"EMP\") AS \"t0\" INNER JOIN (SELECT \"ENAME\", \"JOB\", \"COMM\", \"SAL\" + \"SAL\" + 100 AS \"EXPR$0\" FROM \"BONUS\") AS \"t1\" ON \"t0\".\"ENAME\" = \"t1\".\"ENAME\" AND \"t0\".\"EXPR$0\""},{"index":43,"rewrite rule":"testRightEmptyFullJoin","original query":"SELECT * FROM \"EMP\" FULL JOIN (SELECT * FROM \"DEPT\" WHERE FALSE) AS \"t0\" ON \"EMP\".\"DEPTNO\" = \"t0\".\"DEPTNO\"","rewritten query":"SELECT CAST(\"EMPNO\" AS INTEGER) AS \"EMPNO\", CAST(\"ENAME\" AS VARCHAR(20)) AS \"ENAME\", CAST(\"JOB\" AS VARCHAR(10)) AS \"JOB\", \"MGR\", CAST(\"HIREDATE\" AS TIMESTAMP(0)) AS \"HIREDATE\", CAST(\"SAL\" AS INTEGER) AS \"SAL\", CAST(\"COMM\" AS INTEGER) AS \"COMM\", CAST(\"DEPTNO\" AS INTEGER) AS \"DEPTNO\", CAST(\"SLACKER\" AS BOOLEAN) AS \"SLACKER\", CAST(NULL AS INTEGER) AS \"DEPTNO0\", CAST(NULL AS VARCHAR(10)) AS \"NAME\" FROM \"EMP\""},{"index":44,"rewrite rule":"testPullConstantThroughUnion","original query":"SELECT 2, \"DEPTNO\", \"JOB\" FROM \"EMP\" UNION ALL SELECT 2, \"DEPTNO\", \"JOB\" FROM \"EMP\"","rewritten query":"SELECT 2, \"DEPTNO\", \"JOB\" FROM (SELECT \"DEPTNO\", \"JOB\" FROM \"EMP\" UNION ALL SELECT \"DEPTNO\", \"JOB\" FROM \"EMP\") AS \"t4\""},{"index":45,"rewrite rule":"testWhereNotInCorrelated2","original query":"SELECT * FROM \"EMP\" WHERE \"EMPNO\" NOT IN (SELECT \"EMPNO\" FROM (SELECT \"ENAME\", \"EMPNO\", \"SAL\" AS \"R\" FROM \"EMP\") AS \"t\" WHERE \"R\" > 2 AND \"EMP\".\"ENAME\" = \"ENAME\")","rewritten query":"SELECT \"EMP1\".\"EMPNO\", \"EMP1\".\"ENAME\", \"EMP1\".\"JOB\", \"EMP1\".\"MGR\", \"EMP1\".\"HIREDATE\", \"EMP1\".\"SAL\", \"EMP1\".\"COMM\", \"EMP1\".\"DEPTNO\", \"EMP1\".\"SLACKER\" FROM \"EMP\" AS \"EMP1\" LEFT JOIN (SELECT COUNT(*) AS \"c\", COUNT(*) AS \"ck\", \"ENAME\" FROM (SELECT \"ENAME\", \"EMPNO\", \"SAL\" AS \"R\" FROM \"EMP\") AS \"t4\" WHERE \"R\" > 2 GROUP BY \"ENAME\") AS \"t8\" ON \"EMP1\".\"ENAME\" = \"t8\".\"ENAME\" LEFT JOIN (SELECT \"EMPNO\", TRUE AS \"i\", \"ENAME\" FROM (SELECT \"ENAME\", \"EMPNO\", \"SAL\" AS \"R\" FROM \"EMP\") AS \"t9\" WHERE \"R\" > 2) AS \"t11\" ON \"EMP1\".\"EMPNO\" = \"t11\".\"EMPNO\" AND \"EMP1\".\"ENAME\" = \"t11\".\"ENAME\" WHERE \"t8\".\"c\" = 0 OR (\"t11\".\"i\" IS NOT NULL OR \"t8\".\"ck\" < \"t8\".\"c\") IS NOT TRUE"},{"index":46,"rewrite rule":"testDistinctWithGrouping","original query":"SELECT \"SAL\", SUM(\"COMM\"), MIN(\"COMM\"), SUM(DISTINCT \"SAL\") FROM \"EMP\" GROUP BY \"SAL\"","rewritten query":"SELECT \"SAL\", SUM(\"EXPR$1\"), MIN(\"EXPR$2\"), SUM(\"SAL\") FROM (SELECT \"SAL\", SUM(\"COMM\") AS \"EXPR$1\", MIN(\"COMM\") AS \"EXPR$2\" FROM \"EMP\" GROUP BY \"SAL\") AS \"t2\" GROUP BY \"SAL\""},{"index":47,"rewrite rule":"testWhereNotInCorrelated","original query":"SELECT \"SAL\" FROM \"EMP\" WHERE \"EMPNO\" NOT IN (SELECT \"DEPTNO\" FROM \"DEPT\" WHERE \"EMP\".\"JOB\" = \"NAME\")","rewritten query":"SELECT \"EMP0\".\"SAL\" FROM \"EMP\" AS \"EMP0\" LEFT JOIN (SELECT COUNT(*) AS \"c\", COUNT(*) AS \"ck\", \"NAME\" FROM \"DEPT\" GROUP BY \"NAME\") AS \"t5\" ON \"EMP0\".\"JOB\" = \"t5\".\"NAME\" LEFT JOIN (SELECT \"DEPTNO\", TRUE AS \"i\", \"NAME\" FROM \"DEPT\") AS \"t6\" ON \"EMP0\".\"EMPNO\" = \"t6\".\"DEPTNO\" AND \"EMP0\".\"JOB\" = \"t6\".\"NAME\" WHERE \"t5\".\"c\" = 0 OR (\"t6\".\"i\" IS NOT NULL OR \"t5\".\"ck\" < \"t5\".\"c\") IS NOT TRUE"},{"index":48,"rewrite rule":"testSkipReduceConstantsCaseEquals","original query":"SELECT * FROM \"EMP\", \"EMP\" AS \"EMP0\" WHERE CASE WHEN \"EMP\".\"MGR\" IS NOT NULL THEN CAST(\"EMP\".\"MGR\" AS INTEGER) ELSE -1 END = CASE WHEN \"EMP0\".\"MGR\" IS NOT NULL THEN CAST(\"EMP0\".\"MGR\" AS INTEGER) ELSE -1 END","rewritten query":"SELECT * FROM \"EMP\" AS \"EMP1\" INNER JOIN \"EMP\" AS \"EMP2\" ON CASE WHEN \"EMP1\".\"MGR\" IS NOT NULL THEN CAST(\"EMP1\".\"MGR\" AS INTEGER) ELSE -1 END = CASE WHEN \"EMP2\".\"MGR\" IS NOT NULL THEN CAST(\"EMP2\".\"MGR\" AS INTEGER) ELSE -1 END"},{"index":49,"rewrite rule":"testMinusMergeRule","original query":"SELECT * FROM (SELECT * FROM (SELECT \"NAME\", \"DEPTNO\" FROM (SELECT \"NAME\", \"DEPTNO\", COUNT(*) AS \"EXPR$2\" FROM \"DEPT\" GROUP BY \"NAME\", \"DEPTNO\" EXCEPT ALL SELECT \"NAME\", \"DEPTNO\", 1 AS \"$f2\" FROM \"DEPT\") AS \"t2\" EXCEPT ALL SELECT \"NAME\", \"DEPTNO\" FROM (SELECT \"NAME\", \"DEPTNO\", 1 AS \"$f2\" FROM \"DEPT\" EXCEPT ALL SELECT \"NAME\", \"DEPTNO\", COUNT(*) AS \"EXPR$2\" FROM \"DEPT\" GROUP BY \"NAME\", \"DEPTNO\") AS \"t7\") AS \"t9\" EXCEPT ALL SELECT \"NAME\", \"DEPTNO\" FROM \"DEPT\") AS \"t12\"","rewritten query":"SELECT \"NAME\", \"DEPTNO\" FROM \"DEPT\" GROUP BY \"NAME\", \"DEPTNO\" EXCEPT ALL SELECT \"NAME\", \"DEPTNO\" FROM \"DEPT\" EXCEPT ALL SELECT * FROM (SELECT \"NAME\", \"DEPTNO\" FROM \"DEPT\" EXCEPT ALL SELECT \"NAME\", \"DEPTNO\" FROM \"DEPT\" GROUP BY \"NAME\", \"DEPTNO\") AS \"t\" EXCEPT ALL SELECT \"NAME\", \"DEPTNO\" FROM \"DEPT\""},{"index":50,"rewrite rule":"testWhereInCorrelated","original query":"SELECT \"SAL\" FROM \"EMP\" WHERE \"EMPNO\" IN (SELECT \"DEPTNO\" FROM \"DEPT\" WHERE \"EMP\".\"JOB\" = \"NAME\")","rewritten query":"SELECT \"EMP0\".\"SAL\" FROM \"EMP\" AS \"EMP0\" INNER JOIN (SELECT * FROM \"DEPT\") AS \"t3\" ON \"EMP0\".\"JOB\" = \"t3\".\"NAME\" AND \"EMP0\".\"EMPNO\" = \"t3\".\"DEPTNO\""},{"index":51,"rewrite rule":"testReduceConstantsNullEqualsOne","original query":"SELECT COUNT(*) FROM \"EMP\" WHERE NULL = 1","rewritten query":"SELECT COUNT(*) FROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\") WHERE 1 = 0"},{"index":52,"rewrite rule":"testDistinctCountMultiple","original query":"SELECT \"DEPTNO\", COUNT(DISTINCT \"ENAME\"), COUNT(DISTINCT \"JOB\") FROM \"EMP\" GROUP BY \"DEPTNO\"","rewritten query":"SELECT \"DEPTNO\", COUNT(\"ENAME\") FILTER (WHERE \"$g_1\"), COUNT(\"JOB\") FILTER (WHERE \"$g_2\") FROM (SELECT \"DEPTNO\", \"ENAME\", \"JOB\", GROUPING(\"DEPTNO\", \"ENAME\", \"JOB\") = 1 AS \"$g_1\", GROUPING(\"DEPTNO\", \"ENAME\", \"JOB\") = 2 AS \"$g_2\" FROM \"EMP\" GROUP BY GROUPING SETS((\"ENAME\", \"DEPTNO\"), (\"JOB\", \"DEPTNO\"))) AS \"t3\" GROUP BY \"DEPTNO\""},{"index":53,"rewrite rule":"testReduceAverageAndSumWithNoReduceStddevAndVar","original query":"SELECT \"NAME\", STDDEV_POP(\"DEPTNO\"), AVG(\"DEPTNO\"), VAR_POP(\"DEPTNO\") FROM \"DEPT\" GROUP BY \"NAME\"","rewritten query":"SELECT \"NAME\", STDDEV_POP(\"DEPTNO\"), CAST(COALESCE(SUM(\"DEPTNO\"), 0) \/ COUNT(*) AS INTEGER), VAR_POP(\"DEPTNO\") FROM \"DEPT\" GROUP BY \"NAME\""},{"index":54,"rewrite rule":"testSemiJoinRuleExists","original query":"SELECT \"DEPT\".\"DEPTNO\", \"DEPT\".\"NAME\" FROM \"DEPT\" INNER JOIN (SELECT \"DEPTNO\" FROM (SELECT \"SAL\", \"DEPTNO\" FROM \"EMP\") AS \"t\" WHERE \"SAL\" > 100 GROUP BY \"DEPTNO\") AS \"t2\" ON \"DEPT\".\"DEPTNO\" = \"t2\".\"DEPTNO\"","rewritten query":"SELECT * FROM (SELECT * FROM \"DEPT\" WHERE EXISTS (SELECT 1 FROM (SELECT \"DEPTNO\" FROM \"EMP\" WHERE \"SAL\" > 100) AS \"t5\" WHERE * = \"t5\".\"DEPTNO\")) AS \"DEPT0\""},{"index":55,"rewrite rule":"testJoinConditionPushdown1","original query":"SELECT * FROM \"EMP\", \"EMP\" AS \"EMP0\", \"DEPT\" WHERE \"EMP\".\"DEPTNO\" = \"DEPT\".\"DEPTNO\" AND \"EMP0\".\"DEPTNO\" = \"DEPT\".\"DEPTNO\"","rewritten query":"SELECT * FROM \"EMP\" AS \"EMP1\" INNER JOIN \"EMP\" AS \"EMP2\" ON \"EMP1\".\"DEPTNO\" = \"EMP2\".\"DEPTNO\" INNER JOIN \"DEPT\" AS \"DEPT0\" ON \"EMP1\".\"DEPTNO\" = \"DEPT0\".\"DEPTNO\""},{"index":56,"rewrite rule":"testJoinConditionPushdown2","original query":"SELECT * FROM \"EMP\", \"DEPT\" WHERE \"EMP\".\"DEPTNO\" = \"DEPT\".\"DEPTNO\" AND \"EMP\".\"EMPNO\" = \"DEPT\".\"DEPTNO\"","rewritten query":"SELECT * FROM (SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = \"EMPNO\") AS \"t1\" INNER JOIN \"DEPT\" AS \"DEPT0\" ON \"t1\".\"DEPTNO\" = \"DEPT0\".\"DEPTNO\""},{"index":57,"rewrite rule":"testJoinConditionPushdown6","original query":"SELECT * FROM \"EMP\" RIGHT JOIN \"DEPT\" ON \"EMP\".\"DEPTNO\" = \"DEPT\".\"DEPTNO\" AND \"EMP\".\"EMPNO\" = \"DEPT\".\"DEPTNO\"","rewritten query":"SELECT * FROM (SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = \"EMPNO\") AS \"t0\" RIGHT JOIN \"DEPT\" AS \"DEPT0\" ON \"t0\".\"DEPTNO\" = \"DEPT0\".\"DEPTNO\""},{"index":58,"rewrite rule":"testPullConstantThroughUnionSameTypeNullableField","original query":"SELECT \"DEPTNO\", \"ENAME\" FROM (SELECT \"ENAME\", \"DEPTNO\" FROM \"EMPNULLABLES\") AS \"t\" WHERE \"DEPTNO\" = 1 UNION ALL SELECT \"DEPTNO\", \"ENAME\" FROM (SELECT \"ENAME\", \"DEPTNO\" FROM \"EMPNULLABLES\") AS \"t2\" WHERE \"DEPTNO\" = 1","rewritten query":"SELECT CAST(1 AS INTEGER) AS \"DEPTNO\", \"ENAME\" FROM (SELECT \"ENAME\" FROM (SELECT \"ENAME\", \"DEPTNO\" FROM \"EMPNULLABLES\") AS \"t6\" WHERE \"DEPTNO\" = 1 UNION ALL SELECT \"ENAME\" FROM (SELECT \"ENAME\", \"DEPTNO\" FROM \"EMPNULLABLES\") AS \"t9\" WHERE \"DEPTNO\" = 1) AS \"t12\""},{"index":59,"rewrite rule":"testWhereExpressionInCorrelated","original query":"SELECT \"ENAME\" FROM (SELECT \"ENAME\", \"DEPTNO\", \"SAL\" + 1 AS \"SALPLUS\" FROM \"EMP\") AS \"t\" WHERE \"DEPTNO\" IN (SELECT \"DEPTNO\" FROM \"EMP\" WHERE \"SAL\" + 1 = \"t\".\"SALPLUS\")","rewritten query":"SELECT \"t4\".\"ENAME\" FROM (SELECT \"ENAME\", \"DEPTNO\", \"SAL\" + 1 AS \"SALPLUS\" FROM \"EMP\") AS \"t4\" INNER JOIN (SELECT \"DEPTNO\", \"SAL\" + 1 AS \"$f9\" FROM \"EMP\" GROUP BY \"DEPTNO\", \"SAL\" + 1) AS \"t6\" ON \"t4\".\"SALPLUS\" = \"t6\".\"$f9\" AND \"t4\".\"DEPTNO\" = \"t6\".\"DEPTNO\""},{"index":60,"rewrite rule":"testExpandFilterInComposite","original query":"SELECT \"EMPNO\" FROM \"EMP\" WHERE (\"EMPNO\", \"DEPTNO\") IN (SELECT \"EMPNO\", \"DEPTNO\" FROM \"EMP\" WHERE \"EMPNO\" < 20) OR \"SAL\" < 100","rewritten query":"SELECT \"EMP1\".\"EMPNO\" FROM \"EMP\" AS \"EMP1\" LEFT JOIN (SELECT \"EMPNO\", \"DEPTNO\", TRUE AS \"i\" FROM \"EMP\" WHERE \"EMPNO\" < 20) AS \"t4\" ON \"EMP1\".\"EMPNO\" = \"t4\".\"EMPNO\" AND \"EMP1\".\"DEPTNO\" = \"t4\".\"DEPTNO\" WHERE \"t4\".\"i\" IS NOT NULL OR \"EMP1\".\"SAL\" < 100"},{"index":61,"rewrite rule":"testBitAndReuseDistinctAttrWithMixedOptionality","original query":"SELECT SUM(DISTINCT \"DEPTNO\"), COUNT(DISTINCT \"DEPTNO\"), BIT_AND(\"DEPTNO\") FROM \"EMP\"","rewritten query":"SELECT SUM(\"DEPTNO\"), COUNT(\"DEPTNO\"), BIT_AND(\"DEPTNO\") FROM (SELECT \"DEPTNO\" FROM \"EMP\" GROUP BY \"DEPTNO\") AS \"t2\""},{"index":62,"rewrite rule":"testPullFilterThroughAggregateGroupingSets","original query":"SELECT \"ENAME\", \"SAL\", \"DEPTNO\" FROM \"EMP\" WHERE \"SAL\" > 5000 GROUP BY ROLLUP(\"ENAME\", \"SAL\", \"DEPTNO\")","rewritten query":"SELECT \"ENAME\", \"SAL\", \"DEPTNO\" FROM (SELECT \"ENAME\", \"SAL\", \"DEPTNO\" FROM \"EMP\" GROUP BY \"ENAME\", \"SAL\", \"DEPTNO\" HAVING \"SAL\" > 5000) AS \"t4\" GROUP BY ROLLUP(\"ENAME\", \"SAL\", \"DEPTNO\")"},{"index":63,"rewrite rule":"testReduceConstantsRequiresExecutor","original query":"SELECT * FROM (VALUES (1, 2)) AS \"t\" (\"EXPR$0\", \"EXPR$1\") WHERE 1 + 2 > 3 + NULL","rewritten query":"SELECT * FROM (VALUES (NULL, NULL)) AS \"t\" (\"EXPR$0\", \"EXPR$1\") WHERE 1 = 0"},{"index":64,"rewrite rule":"testExtractYearMonthToRange","original query":"SELECT * FROM \"EMP_B\" WHERE EXTRACT(YEAR FROM \"BIRTHDATE\") = 2014 AND EXTRACT(MONTH FROM \"BIRTHDATE\") = 4","rewritten query":"SELECT * FROM \"EMP_B\" WHERE \"BIRTHDATE\" >= DATE '2014-04-01' AND \"BIRTHDATE\" < DATE '2014-05-01'"},{"index":65,"rewrite rule":"testRightEmptyInnerJoin","original query":"SELECT * FROM \"EMP\" INNER JOIN (SELECT * FROM \"DEPT\" WHERE FALSE) AS \"t0\" ON \"EMP\".\"DEPTNO\" = \"t0\".\"DEPTNO\"","rewritten query":"SELECT * FROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\", \"DEPTNO0\", \"NAME\") WHERE 1 = 0"},{"index":66,"rewrite rule":"testTransitiveInferenceJoin3wayAgg","original query":"SELECT 1 FROM (SELECT \"DEPTNO\", COUNT(*) AS \"EXPR$1\" FROM \"EMP\" WHERE \"DEPTNO\" > 7 GROUP BY \"DEPTNO\") AS \"t1\" INNER JOIN \"EMP\" AS \"EMP0\" ON \"t1\".\"DEPTNO\" = \"EMP0\".\"DEPTNO\" INNER JOIN \"EMP\" AS \"EMP1\" ON \"EMP0\".\"DEPTNO\" = \"EMP1\".\"DEPTNO\"","rewritten query":"SELECT 1 FROM (SELECT \"DEPTNO\", COUNT(*) AS \"EXPR$1\" FROM \"EMP\" WHERE \"DEPTNO\" > 7 GROUP BY \"DEPTNO\") AS \"t5\" INNER JOIN (SELECT * FROM \"EMP\" WHERE \"DEPTNO\" > 7) AS \"t6\" ON \"t5\".\"DEPTNO\" = \"t6\".\"DEPTNO\" INNER JOIN (SELECT * FROM \"EMP\" WHERE \"DEPTNO\" > 7) AS \"t7\" ON \"t6\".\"DEPTNO\" = \"t7\".\"DEPTNO\""},{"index":67,"rewrite rule":"testReduceConstantsProjectNullable","original query":"SELECT \"MGR\" FROM \"EMP\" WHERE \"MGR\" = 10","rewritten query":"SELECT CAST(10 AS INTEGER) AS \"MGR\" FROM \"EMP\" WHERE \"MGR\" = 10"},{"index":68,"rewrite rule":"testWhereOrSubQuery","original query":"SELECT * FROM \"EMP\" WHERE \"SAL\" = 4 OR \"EMPNO\" NOT IN (SELECT \"DEPTNO\" FROM \"DEPT\")","rewritten query":"SELECT \"EMP0\".\"EMPNO\", \"EMP0\".\"ENAME\", \"EMP0\".\"JOB\", \"EMP0\".\"MGR\", \"EMP0\".\"HIREDATE\", \"EMP0\".\"SAL\", \"EMP0\".\"COMM\", \"EMP0\".\"DEPTNO\", \"EMP0\".\"SLACKER\" FROM \"EMP\" AS \"EMP0\" LEFT JOIN (SELECT \"DEPTNO\", TRUE AS \"i\" FROM \"DEPT\") AS \"t2\" ON \"EMP0\".\"EMPNO\" = \"t2\".\"DEPTNO\" WHERE \"EMP0\".\"SAL\" = 4 OR \"t2\".\"i\" IS NULL"},{"index":69,"rewrite rule":"testDecorrelateExists","original query":"SELECT * FROM \"EMP\" WHERE EXISTS (SELECT * FROM \"EMP\" WHERE \"EMP\".\"DEPTNO\" = \"DEPTNO\")","rewritten query":"SELECT \"EMP1\".\"EMPNO\", \"EMP1\".\"ENAME\", \"EMP1\".\"JOB\", \"EMP1\".\"MGR\", \"EMP1\".\"HIREDATE\", \"EMP1\".\"SAL\", \"EMP1\".\"COMM\", \"EMP1\".\"DEPTNO\", \"EMP1\".\"SLACKER\" FROM \"EMP\" AS \"EMP1\" INNER JOIN (SELECT \"DEPTNO\", TRUE AS \"$f1\" FROM \"EMP\" GROUP BY \"DEPTNO\") AS \"t4\" ON \"EMP1\".\"DEPTNO\" = \"t4\".\"DEPTNO\""},{"index":70,"rewrite rule":"testExpressionInWindowFunction","original query":"SELECT SUM(\"DEPTNO\") OVER (PARTITION BY \"DEPTNO\" ORDER BY \"SAL\" RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS \"SUM1\", SUM(\"DEPTNO\" + \"SAL\") OVER (PARTITION BY \"DEPTNO\" ORDER BY \"SAL\" RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS \"SUM2\" FROM \"EMP\"","rewritten query":"SELECT SUM(\"DEPTNO\") OVER (PARTITION BY \"DEPTNO\" ORDER BY \"SAL\" RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS \"$0\", SUM(\"DEPTNO\" + \"SAL\") OVER (PARTITION BY \"DEPTNO\" ORDER BY \"SAL\" RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS \"$1\" FROM \"EMP\""},{"index":71,"rewrite rule":"testTransitiveInferenceJoin3way","original query":"SELECT 1 FROM \"EMP\" INNER JOIN \"EMP\" AS \"EMP0\" ON \"EMP\".\"DEPTNO\" = \"EMP0\".\"DEPTNO\" INNER JOIN \"EMP\" AS \"EMP1\" ON \"EMP0\".\"DEPTNO\" = \"EMP1\".\"DEPTNO\" WHERE \"EMP\".\"DEPTNO\" > 7","rewritten query":"SELECT 1 FROM (SELECT * FROM \"EMP\" WHERE \"DEPTNO\" > 7) AS \"t1\" INNER JOIN (SELECT * FROM \"EMP\" WHERE \"DEPTNO\" > 7) AS \"t2\" ON \"t1\".\"DEPTNO\" = \"t2\".\"DEPTNO\" INNER JOIN (SELECT * FROM \"EMP\" WHERE \"DEPTNO\" > 7) AS \"t3\" ON \"t2\".\"DEPTNO\" = \"t3\".\"DEPTNO\""},{"index":72,"rewrite rule":"testRightEmptyLeftJoin","original query":"SELECT * FROM \"EMP\" LEFT JOIN (SELECT * FROM \"DEPT\" WHERE FALSE) AS \"t0\" ON \"EMP\".\"DEPTNO\" = \"t0\".\"DEPTNO\"","rewritten query":"SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\", CAST(NULL AS INTEGER) AS \"DEPTNO0\", CAST(NULL AS VARCHAR(10)) AS \"NAME\" FROM \"EMP\""},{"index":73,"rewrite rule":"testPushCountStarThroughUnion","original query":"SELECT \"ENAME\", COUNT(*) FROM (SELECT * FROM \"EMP\" UNION ALL SELECT * FROM \"EMP\") AS \"t1\" GROUP BY \"ENAME\"","rewritten query":"SELECT \"ENAME\", COALESCE(SUM(\"EXPR$1\"), 0) FROM (SELECT \"ENAME\", COUNT(*) AS \"EXPR$1\" FROM \"EMP\" GROUP BY \"ENAME\" UNION ALL SELECT \"ENAME\", COUNT(*) AS \"EXPR$1\" FROM \"EMP\" GROUP BY \"ENAME\") AS \"t8\" GROUP BY \"ENAME\""},{"index":74,"rewrite rule":"testRemoveSemiJoinRight","original query":"SELECT \"EMP\".\"ENAME\" FROM \"EMP\", \"DEPT\", \"EMP\" AS \"EMP0\" WHERE \"EMP\".\"DEPTNO\" = \"DEPT\".\"DEPTNO\" AND \"DEPT\".\"DEPTNO\" = \"EMP0\".\"DEPTNO\"","rewritten query":"SELECT \"EMP1\".\"ENAME\" FROM \"EMP\" AS \"EMP1\" INNER JOIN \"DEPT\" AS \"DEPT0\" ON \"EMP1\".\"DEPTNO\" = \"DEPT0\".\"DEPTNO\" INNER JOIN \"EMP\" AS \"EMP2\" ON \"DEPT0\".\"DEPTNO\" = \"EMP2\".\"DEPTNO\""},{"index":75,"rewrite rule":"testPushProjectPastInnerJoin","original query":"SELECT COUNT(*), CASE WHEN \"EMP\".\"SAL\" < 11 THEN 11 ELSE -1 * \"EMP\".\"SAL\" END FROM \"EMP\" INNER JOIN \"BONUS\" ON \"EMP\".\"ENAME\" = \"BONUS\".\"ENAME\" GROUP BY CASE WHEN \"EMP\".\"SAL\" < 11 THEN 11 ELSE -1 * \"EMP\".\"SAL\" END","rewritten query":"SELECT COUNT(*), \"t2\".\"EXPR$1\" FROM (SELECT \"ENAME\", CASE WHEN \"SAL\" < 11 THEN 11 ELSE -1 * \"SAL\" END AS \"EXPR$1\" FROM \"EMP\") AS \"t2\" INNER JOIN (SELECT \"ENAME\" FROM \"BONUS\") AS \"t3\" ON \"t2\".\"ENAME\" = \"t3\".\"ENAME\" GROUP BY \"t2\".\"EXPR$1\""},{"index":76,"rewrite rule":"testPushAggregateFunctionsThroughJoin","original query":"SELECT \"EMP\".\"JOB\", MIN(\"EMP\".\"SAL\") AS \"MIN_SAL\", MIN(\"EMP\".\"DEPTNO\") AS \"MIN_DEPTNO\", SUM(\"EMP\".\"SAL\") + 1 AS \"SUM_SAL_PLUS\", MAX(\"EMP\".\"SAL\") AS \"MAX_SAL\", SUM(\"EMP\".\"SAL\") AS \"SUM_SAL_2\", COUNT(*) AS \"COUNT_SAL\", COUNT(\"EMP\".\"MGR\") AS \"COUNT_MGR\" FROM \"EMP\" INNER JOIN \"DEPT\" ON \"EMP\".\"JOB\" = \"DEPT\".\"NAME\" GROUP BY \"EMP\".\"JOB\", \"DEPT\".\"NAME\"","rewritten query":"SELECT \"t2\".\"JOB\", \"t2\".\"MIN_SAL\", \"t2\".\"MIN_DEPTNO\", CAST(\"t2\".\"SUM_SAL_2\" * \"t3\".\"$f1\" AS INTEGER) + 1 AS \"SUM_SAL_PLUS\", \"t2\".\"MAX_SAL\", CAST(\"t2\".\"SUM_SAL_2\" * \"t3\".\"$f1\" AS INTEGER) AS \"SUM_SAL_2\", \"t2\".\"COUNT_SAL\" * \"t3\".\"$f1\" AS \"COUNT_SAL\", \"t2\".\"COUNT_MGR\" * \"t3\".\"$f1\" AS \"COUNT_MGR\" FROM (SELECT \"JOB\", MIN(\"SAL\") AS \"MIN_SAL\", MIN(\"DEPTNO\") AS \"MIN_DEPTNO\", SUM(\"SAL\") AS \"SUM_SAL_2\", MAX(\"SAL\") AS \"MAX_SAL\", COUNT(*) AS \"COUNT_SAL\", COUNT(\"MGR\") AS \"COUNT_MGR\" FROM \"EMP\" GROUP BY \"JOB\") AS \"t2\" INNER JOIN (SELECT \"NAME\", COUNT(*) AS \"$f1\" FROM \"DEPT\" GROUP BY \"NAME\") AS \"t3\" ON \"t2\".\"JOB\" = \"t3\".\"NAME\""},{"index":77,"rewrite rule":"testTransitiveInferenceProject","original query":"SELECT 1 FROM (SELECT * FROM \"EMP\" WHERE \"DEPTNO\" > 7) AS \"t0\" INNER JOIN \"EMP\" AS \"EMP0\" ON \"t0\".\"DEPTNO\" = \"EMP0\".\"DEPTNO\"","rewritten query":"SELECT 1 FROM (SELECT * FROM \"EMP\" WHERE \"DEPTNO\" > 7) AS \"t3\" INNER JOIN (SELECT * FROM \"EMP\" WHERE \"DEPTNO\" > 7) AS \"t4\" ON \"t3\".\"DEPTNO\" = \"t4\".\"DEPTNO\""},{"index":78,"rewrite rule":"testPushAvgThroughUnion","original query":"SELECT \"ENAME\", AVG(\"EMPNO\") FROM (SELECT * FROM \"EMP\" UNION ALL SELECT * FROM \"EMP\") AS \"t1\" GROUP BY \"ENAME\"","rewritten query":"SELECT \"ENAME\", AVG(\"EMPNO\") FROM (SELECT \"ENAME\", \"EMPNO\" FROM \"EMP\" UNION ALL SELECT \"ENAME\", \"EMPNO\" FROM \"EMP\") AS \"t6\" GROUP BY \"ENAME\""},{"index":79,"rewrite rule":"testPushProjectPastFullJoinStrong","original query":"SELECT COUNT(*), CASE WHEN \"EMP\".\"SAL\" < 11 THEN -1 * \"EMP\".\"SAL\" ELSE \"EMP\".\"SAL\" END FROM \"EMP\" FULL JOIN \"BONUS\" ON \"EMP\".\"ENAME\" = \"BONUS\".\"ENAME\" GROUP BY CASE WHEN \"EMP\".\"SAL\" < 11 THEN -1 * \"EMP\".\"SAL\" ELSE \"EMP\".\"SAL\" END","rewritten query":"SELECT COUNT(*), \"t2\".\"EXPR$1\" FROM (SELECT \"ENAME\", CASE WHEN \"SAL\" < 11 THEN -1 * \"SAL\" ELSE \"SAL\" END AS \"EXPR$1\" FROM \"EMP\") AS \"t2\" FULL JOIN (SELECT \"ENAME\" FROM \"BONUS\") AS \"t3\" ON \"t2\".\"ENAME\" = \"t3\".\"ENAME\" GROUP BY \"t2\".\"EXPR$1\""},{"index":80,"rewrite rule":"testReduceConstantsCalc","original query":"SELECT * FROM (SELECT UPPER(SUBSTRING(\"X\" FROM 1 FOR 2) || SUBSTRING(\"X\" FROM 3)) AS \"U\", SUBSTRING(\"X\" FROM 1 FOR 1) AS \"S\" FROM (SELECT * FROM (SELECT 'table' AS \"X\" FROM (VALUES (TRUE)) AS \"t\" (\"EXPR$0\") UNION SELECT 'view' AS \"EXPR$0\" FROM (VALUES (TRUE)) AS \"t\" (\"EXPR$0\")) AS \"t\" UNION SELECT 'foreign table' AS \"EXPR$0\" FROM (VALUES (TRUE)) AS \"t\" (\"EXPR$0\")) AS \"t6\") AS \"t7\" WHERE \"U\" = 'TABLE'","rewritten query":"SELECT 'TABLE        ' AS \"U\", 't' AS \"S\" FROM (VALUES (TRUE)) AS \"t\" (\"EXPR$0\")"},{"index":81,"rewrite rule":"testReduceConstantsDup2","original query":"SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 7 AND \"DEPTNO\" = 8 AND \"EMPNO\" = 10 AND \"MGR\" IS NULL AND \"EMPNO\" = 10","rewritten query":"SELECT 10 AS \"EMPNO\", \"ENAME\", \"JOB\", CAST(NULL AS INTEGER) AS \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\" FROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\") WHERE 1 = 0"},{"index":82,"rewrite rule":"testReduceConstantsDup3","original query":"SELECT \"DEPTNO\" FROM \"DEPT\" WHERE \"DEPTNO\" <> 7 OR \"DEPTNO\" <> 8","rewritten query":"SELECT \"DEPTNO\" FROM \"DEPT\""},{"index":83,"rewrite rule":"testReduceConstantsNull","original query":"SELECT * FROM (SELECT * FROM (SELECT CAST(NULL AS INTEGER) AS \"N\" FROM \"EMP\") AS \"t\" WHERE \"N\" IS NULL AND \"N\" IS NULL) AS \"t1\" WHERE \"N\" IS NULL","rewritten query":"SELECT CAST(NULL AS INTEGER) AS \"N\" FROM \"EMP\""},{"index":84,"rewrite rule":"testPushCountFilterThroughUnion","original query":"SELECT \"DEPTNO\", COUNT(*) FILTER (WHERE \"JOB\" = 'CLERK') FROM (SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 10 UNION ALL SELECT * FROM \"EMP\" WHERE \"DEPTNO\" > 20) AS \"t3\" GROUP BY \"DEPTNO\"","rewritten query":"SELECT \"DEPTNO\", COALESCE(SUM(\"EXPR$1\"), 0) FROM (SELECT \"DEPTNO\", COUNT(*) FILTER (WHERE \"JOB\" = 'CLERK') AS \"EXPR$1\" FROM \"EMP\" WHERE \"DEPTNO\" = 10 GROUP BY \"DEPTNO\" UNION ALL SELECT \"DEPTNO\", COUNT(*) FILTER (WHERE \"JOB\" = 'CLERK') AS \"EXPR$1\" FROM \"EMP\" WHERE \"DEPTNO\" > 20 GROUP BY \"DEPTNO\") AS \"t12\" GROUP BY \"DEPTNO\""},{"index":85,"rewrite rule":"testReduceConstantsNegatedInverted","original query":"SELECT \"EMPNO\" FROM \"EMP\" WHERE \"EMPNO\" > 10 AND \"EMPNO\" <= 10","rewritten query":"SELECT \"EMPNO\" FROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\") WHERE 1 = 0"},{"index":86,"rewrite rule":"testPushSumCountStarGroupingSetsThroughUnion","original query":"SELECT \"DEPTNO\", \"JOB\", SUM(\"EMPNO\"), COUNT(*), MIN(\"DEPTNO\"), MAX(\"EMPNO\") FROM (SELECT * FROM \"EMP\" UNION ALL SELECT * FROM \"EMP\") AS \"t1\" GROUP BY ROLLUP(\"DEPTNO\", \"JOB\")","rewritten query":"SELECT \"DEPTNO\", \"JOB\", SUM(\"EXPR$2\"), COALESCE(SUM(\"EXPR$3\"), 0), MIN(\"EXPR$4\"), MAX(\"EXPR$5\") FROM (SELECT \"DEPTNO\", \"JOB\", SUM(\"EMPNO\") AS \"EXPR$2\", COUNT(*) AS \"EXPR$3\", MIN(\"DEPTNO\") AS \"EXPR$4\", MAX(\"EMPNO\") AS \"EXPR$5\" FROM \"EMP\" GROUP BY \"DEPTNO\", \"JOB\" UNION ALL SELECT \"DEPTNO\", \"JOB\", SUM(\"EMPNO\") AS \"EXPR$2\", COUNT(*) AS \"EXPR$3\", MIN(\"DEPTNO\") AS \"EXPR$4\", MAX(\"EMPNO\") AS \"EXPR$5\" FROM \"EMP\" GROUP BY \"DEPTNO\", \"JOB\") AS \"t8\" GROUP BY ROLLUP(\"DEPTNO\", \"JOB\")"},{"index":87,"rewrite rule":"testReduceCaseNullabilityChange","original query":"SELECT CASE WHEN \"EMPNO\" = 1 THEN 1 WHEN 1 IS NOT NULL THEN 2 ELSE NULL END AS \"QX\" FROM \"EMP\"","rewritten query":"SELECT CAST(CASE WHEN \"EMPNO\" = 1 THEN 1 ELSE 2 END AS INTEGER) AS \"QX\" FROM \"EMP\""},{"index":88,"rewrite rule":"testExtractJoinFilterRule","original query":"SELECT 1 FROM \"EMP\" INNER JOIN \"DEPT\" ON \"EMP\".\"DEPTNO\" = \"DEPT\".\"DEPTNO\"","rewritten query":"SELECT 1 FROM \"EMP\" AS \"EMP0\", \"DEPT\" AS \"DEPT0\" WHERE \"EMP0\".\"DEPTNO\" = \"DEPT0\".\"DEPTNO\""},{"index":89,"rewrite rule":"testPushAggregateThroughJoinDistinct","original query":"SELECT \"t0\".\"NAME\", SUM(\"EMP\".\"SAL\") AS \"SUM_SAL\", COUNT(*) AS \"C\" FROM \"EMP\" INNER JOIN (SELECT \"NAME\" FROM \"DEPT\" GROUP BY \"NAME\") AS \"t0\" ON \"EMP\".\"JOB\" = \"t0\".\"NAME\" GROUP BY \"t0\".\"NAME\"","rewritten query":"SELECT \"t4\".\"NAME\", \"t3\".\"SUM_SAL\", \"t3\".\"C\" FROM (SELECT \"JOB\", SUM(\"SAL\") AS \"SUM_SAL\", COUNT(*) AS \"C\" FROM \"EMP\" GROUP BY \"JOB\") AS \"t3\" INNER JOIN (SELECT \"NAME\" FROM \"DEPT\" GROUP BY \"NAME\") AS \"t4\" ON \"t3\".\"JOB\" = \"t4\".\"NAME\""},{"index":90,"rewrite rule":"testSortJoinCopySemiJoinOrderBy","original query":"SELECT \"DEPT\".\"DEPTNO\", \"DEPT\".\"NAME\" FROM \"DEPT\" INNER JOIN (SELECT \"DEPTNO\" FROM \"EMP\" GROUP BY \"DEPTNO\") AS \"t0\" ON \"DEPT\".\"DEPTNO\" = \"t0\".\"DEPTNO\" ORDER BY \"DEPT\".\"DEPTNO\"","rewritten query":"SELECT * FROM (SELECT \"DEPTNO\", \"NAME\" FROM \"DEPT\" WHERE EXISTS (SELECT 1 FROM (SELECT \"DEPTNO\" FROM \"EMP\") AS \"t4\" WHERE \"DEPTNO\" = \"t4\".\"DEPTNO\") ORDER BY \"DEPTNO\") AS \"t3\" ORDER BY \"DEPTNO\""},{"index":91,"rewrite rule":"testReduceConstantsDup3Null","original query":"SELECT \"EMPNO\" FROM \"EMP\" WHERE \"MGR\" <> 7 OR \"MGR\" <> 8","rewritten query":"SELECT \"EMPNO\" FROM \"EMP\" WHERE \"MGR\" IS NOT NULL"},{"index":92,"rewrite rule":"testDecorrelateTwoIn","original query":"SELECT \"SAL\" FROM \"EMP\" WHERE \"EMPNO\" IN (SELECT \"DEPTNO\" FROM \"DEPT\" WHERE \"EMP\".\"JOB\" = \"NAME\") AND \"EMPNO\" IN (SELECT \"EMPNO\" FROM \"EMP\" WHERE \"EMP\".\"ENAME\" = \"ENAME\")","rewritten query":"SELECT \"EMP1\".\"SAL\" FROM \"EMP\" AS \"EMP1\" INNER JOIN (SELECT * FROM \"DEPT\") AS \"t5\" ON \"EMP1\".\"JOB\" = \"t5\".\"NAME\" AND \"EMP1\".\"EMPNO\" = \"t5\".\"DEPTNO\" INNER JOIN (SELECT \"EMPNO\", \"ENAME\" FROM \"EMP\") AS \"t6\" ON \"EMP1\".\"ENAME\" = \"t6\".\"ENAME\" AND \"EMP1\".\"EMPNO\" = \"t6\".\"EMPNO\""},{"index":93,"rewrite rule":"testPushProjectPastLeftJoinSwapStrong","original query":"SELECT COUNT(*), CASE WHEN \"EMP\".\"SAL\" < 11 THEN -1 * \"EMP\".\"SAL\" ELSE \"EMP\".\"SAL\" END FROM \"BONUS\" LEFT JOIN \"EMP\" ON \"BONUS\".\"ENAME\" = \"EMP\".\"ENAME\" GROUP BY CASE WHEN \"EMP\".\"SAL\" < 11 THEN -1 * \"EMP\".\"SAL\" ELSE \"EMP\".\"SAL\" END","rewritten query":"SELECT COUNT(*), \"t3\".\"EXPR$1\" FROM (SELECT \"ENAME\" FROM \"BONUS\") AS \"t2\" LEFT JOIN (SELECT \"ENAME\", CASE WHEN \"SAL\" < 11 THEN -1 * \"SAL\" ELSE \"SAL\" END AS \"EXPR$1\" FROM \"EMP\") AS \"t3\" ON \"t2\".\"ENAME\" = \"t3\".\"ENAME\" GROUP BY \"t3\".\"EXPR$1\""},{"index":94,"rewrite rule":"testExpandFilterExistsSimple","original query":"SELECT \"EMPNO\" FROM \"EMP\" WHERE EXISTS (SELECT * FROM \"EMP\" WHERE \"EMPNO\" < 20)","rewritten query":"SELECT \"EMP1\".\"EMPNO\" FROM \"EMP\" AS \"EMP1\", (SELECT \"t3\".\"i\" FROM (SELECT * FROM \"EMP\" WHERE \"EMPNO\" < 20) AS \"t2\", (VALUES (TRUE)) AS \"t3\" (\"i\") GROUP BY \"t3\".\"i\") AS \"t5\""},{"index":95,"rewrite rule":"testLeftEmptyRightJoin","original query":"SELECT * FROM (SELECT * FROM \"EMP\" WHERE FALSE) AS \"t0\" RIGHT JOIN \"DEPT\" ON \"t0\".\"DEPTNO\" = \"DEPT\".\"DEPTNO\"","rewritten query":"SELECT CAST(NULL AS INTEGER) AS \"EMPNO\", CAST(NULL AS VARCHAR(20)) AS \"ENAME\", CAST(NULL AS VARCHAR(10)) AS \"JOB\", CAST(NULL AS INTEGER) AS \"MGR\", CAST(NULL AS TIMESTAMP(0)) AS \"HIREDATE\", CAST(NULL AS INTEGER) AS \"SAL\", CAST(NULL AS INTEGER) AS \"COMM\", CAST(NULL AS INTEGER) AS \"DEPTNO\", CAST(NULL AS BOOLEAN) AS \"SLACKER\", \"DEPTNO\" AS \"DEPTNO0\", \"NAME\" FROM \"DEPT\""},{"index":96,"rewrite rule":"testReduceAverageAndVarWithNoReduceStddev","original query":"SELECT \"NAME\", STDDEV_POP(\"DEPTNO\"), AVG(\"DEPTNO\"), VAR_POP(\"DEPTNO\") FROM \"DEPT\" GROUP BY \"NAME\"","rewritten query":"SELECT \"NAME\", STDDEV_POP(\"DEPTNO\"), CAST(SUM(\"DEPTNO\") \/ COUNT(*) AS INTEGER), CAST((SUM(\"DEPTNO\" * \"DEPTNO\") - SUM(\"DEPTNO\") * SUM(\"DEPTNO\") \/ COUNT(*)) \/ COUNT(*) AS INTEGER) FROM \"DEPT\" GROUP BY \"NAME\""},{"index":97,"rewrite rule":"testSemiJoinRuleWithHint","original query":"SELECT \"DEPT\".\"NAME\" FROM \"DEPT\" INNER JOIN (SELECT \"DEPTNO\" FROM \"EMP\" GROUP BY \"DEPTNO\") AS \"t0\" ON \"DEPT\".\"DEPTNO\" = \"t0\".\"DEPTNO\"","rewritten query":"SELECT \"NAME\" FROM (SELECT * FROM \"DEPT\" WHERE EXISTS (SELECT 1 FROM (SELECT \"DEPTNO\" FROM \"EMP\") AS \"t2\" WHERE * = \"t2\".\"DEPTNO\")) AS \"DEPT0\""},{"index":99,"rewrite rule":"testSortJoinCopyInnerJoinOrderByTwoFields","original query":"SELECT * FROM \"EMP\" INNER JOIN \"DEPT\" ON \"EMP\".\"DEPTNO\" = \"DEPT\".\"DEPTNO\" ORDER BY \"EMP\".\"SAL\", \"DEPT\".\"NAME\"","rewritten query":"SELECT \"t1\".\"EMPNO\", \"t1\".\"ENAME\", \"t1\".\"JOB\", \"t1\".\"MGR\", \"t1\".\"HIREDATE\", \"t1\".\"SAL\", \"t1\".\"COMM\", \"t1\".\"DEPTNO\", \"t1\".\"SLACKER\", \"t2\".\"DEPTNO\" AS \"DEPTNO0\", \"t2\".\"NAME\" FROM (SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\" FROM \"EMP\" ORDER BY \"SAL\") AS \"t1\" INNER JOIN (SELECT \"DEPTNO\", \"NAME\" FROM \"DEPT\" ORDER BY \"NAME\") AS \"t2\" ON \"t1\".\"DEPTNO\" = \"t2\".\"DEPTNO\" ORDER BY \"t1\".\"SAL\", \"t2\".\"NAME\""},{"index":100,"rewrite rule":"testAggregateRemove1","original query":"SELECT \"EMPNO\", SUM(\"SAL\"), MIN(\"SAL\"), MAX(\"SAL\"), BIT_AND(\"SAL\"), BIT_OR(\"SAL\"), COUNT(DISTINCT \"SAL\") FROM \"EMP\" GROUP BY \"EMPNO\", \"DEPTNO\"","rewritten query":"SELECT \"EMPNO\", \"SAL\", \"SAL\", \"SAL\", \"SAL\", \"SAL\", 1 FROM \"EMP\""},{"index":101,"rewrite rule":"testAggregateRemove2","original query":"SELECT \"EMPNO\", \"DEPTNO\" FROM \"EMP\" GROUP BY \"EMPNO\", \"DEPTNO\"","rewritten query":"SELECT \"EMPNO\", \"DEPTNO\" FROM \"EMP\""},{"index":102,"rewrite rule":"testAggregateRemove3","original query":"SELECT \"EMPNO\", COUNT(\"MGR\") FROM \"EMP\" GROUP BY \"EMPNO\", \"DEPTNO\"","rewritten query":"SELECT \"EMPNO\", CASE WHEN \"MGR\" IS NOT NULL THEN 1 ELSE 0 END FROM \"EMP\""},{"index":103,"rewrite rule":"testAggregateRemove7","original query":"SELECT \"MGR\", SUM(\"SUM_SAL\") FROM (SELECT \"MGR\", SUM(\"SAL\") AS \"SUM_SAL\" FROM \"EMP\" GROUP BY \"MGR\", \"DEPTNO\" HAVING \"DEPTNO\" = 100) AS \"t2\" GROUP BY \"MGR\"","rewritten query":"SELECT \"MGR\", SUM(\"SAL\") AS \"SUM_SAL\" FROM \"EMP\" GROUP BY \"MGR\", \"DEPTNO\" HAVING \"DEPTNO\" = 100"},{"index":104,"rewrite rule":"testPullConstantThroughAggregatePermutedConstGroupBy","original query":"SELECT \"DEPTNO\", MAX(\"MGR\") FROM \"EMP\" GROUP BY 42 + 24, \"DEPTNO\"","rewritten query":"SELECT \"DEPTNO\", MAX(\"MGR\") FROM \"EMP\" GROUP BY \"DEPTNO\""},{"index":105,"rewrite rule":"testPullConstantIntoProjectWithIsNotDistinctFromForNull","original query":"SELECT \"MGR\", \"DEPTNO\" FROM \"EMP\" WHERE \"MGR\" IS NULL AND NULL IS NULL OR \"MGR\" = NULL IS TRUE","rewritten query":"SELECT CAST(NULL AS INTEGER) AS \"MGR\", \"DEPTNO\" FROM \"EMP\" WHERE \"MGR\" IS NULL AND NULL IS NULL OR \"MGR\" = NULL IS TRUE"},{"index":106,"rewrite rule":"testPushSumCountStarThroughUnion","original query":"SELECT \"ENAME\", SUM(\"EMPNO\"), COUNT(*), MIN(\"DEPTNO\"), MAX(\"EMPNO\") FROM (SELECT * FROM \"EMP\" UNION ALL SELECT * FROM \"EMP\") AS \"t1\" GROUP BY \"ENAME\"","rewritten query":"SELECT \"ENAME\", SUM(\"EXPR$1\"), COALESCE(SUM(\"EXPR$2\"), 0), MIN(\"EXPR$3\"), MAX(\"EXPR$4\") FROM (SELECT \"ENAME\", SUM(\"EMPNO\") AS \"EXPR$1\", COUNT(*) AS \"EXPR$2\", MIN(\"DEPTNO\") AS \"EXPR$3\", MAX(\"EMPNO\") AS \"EXPR$4\" FROM \"EMP\" GROUP BY \"ENAME\" UNION ALL SELECT \"ENAME\", SUM(\"EMPNO\") AS \"EXPR$1\", COUNT(*) AS \"EXPR$2\", MIN(\"DEPTNO\") AS \"EXPR$3\", MAX(\"EMPNO\") AS \"EXPR$4\" FROM \"EMP\" GROUP BY \"ENAME\") AS \"t8\" GROUP BY \"ENAME\""},{"index":107,"rewrite rule":"testProjectAggregateMerge","original query":"SELECT \"DEPTNO\" + SUM(\"SAL\") FROM \"EMP\" GROUP BY \"JOB\", \"DEPTNO\"","rewritten query":"SELECT \"DEPTNO\" + SUM(\"SAL\") AS \"$f0\" FROM \"EMP\" GROUP BY \"JOB\", \"DEPTNO\""},{"index":108,"rewrite rule":"testPushSumNullableGroupingSetsThroughUnion","original query":"SELECT \"DEPTNO\", \"JOB\", SUM(\"MGR\") FROM (SELECT * FROM \"EMP\" UNION ALL SELECT * FROM \"EMP\") AS \"t1\" GROUP BY ROLLUP(\"DEPTNO\", \"JOB\")","rewritten query":"SELECT \"DEPTNO\", \"JOB\", SUM(\"EXPR$2\") FROM (SELECT \"DEPTNO\", \"JOB\", SUM(\"MGR\") AS \"EXPR$2\" FROM \"EMP\" GROUP BY \"DEPTNO\", \"JOB\" UNION ALL SELECT \"DEPTNO\", \"JOB\", SUM(\"MGR\") AS \"EXPR$2\" FROM \"EMP\" GROUP BY \"DEPTNO\", \"JOB\") AS \"t8\" GROUP BY ROLLUP(\"DEPTNO\", \"JOB\")"},{"index":109,"rewrite rule":"testMergeFilter","original query":"SELECT \"NAME\" FROM (SELECT * FROM \"DEPT\" WHERE \"DEPTNO\" = 10) AS \"t0\" WHERE \"DEPTNO\" = 10","rewritten query":"SELECT \"NAME\" FROM \"DEPT\" WHERE \"DEPTNO\" = 10"},{"index":110,"rewrite rule":"testPushAggregateThroughOuterJoin1","original query":"SELECT \"t0\".\"ENAME\" FROM (SELECT * FROM \"EMP\" WHERE \"ENAME\" = 'A') AS \"t0\" LEFT JOIN \"DEPT\" ON \"t0\".\"JOB\" = \"DEPT\".\"NAME\" GROUP BY \"t0\".\"ENAME\"","rewritten query":"SELECT \"t5\".\"ENAME\" FROM (SELECT \"ENAME\", \"JOB\" FROM \"EMP\" WHERE \"ENAME\" = 'A' GROUP BY \"ENAME\", \"JOB\") AS \"t5\" LEFT JOIN (SELECT \"NAME\" FROM \"DEPT\" GROUP BY \"NAME\") AS \"t6\" ON \"t5\".\"JOB\" = \"t6\".\"NAME\" GROUP BY \"t5\".\"ENAME\""},{"index":111,"rewrite rule":"testPushAggregateThroughOuterJoin2","original query":"SELECT \"EMP0\".\"ENAME\" FROM (SELECT * FROM \"EMP\" WHERE \"ENAME\" = 'A') AS \"t0\" LEFT JOIN \"EMP\" AS \"EMP0\" ON \"t0\".\"JOB\" = \"EMP0\".\"JOB\" GROUP BY \"EMP0\".\"ENAME\"","rewritten query":"SELECT \"t6\".\"ENAME\" FROM (SELECT \"JOB\" FROM \"EMP\" WHERE \"ENAME\" = 'A' GROUP BY \"JOB\") AS \"t5\" LEFT JOIN (SELECT \"ENAME\", \"JOB\" FROM \"EMP\" GROUP BY \"ENAME\", \"JOB\") AS \"t6\" ON \"t5\".\"JOB\" = \"t6\".\"JOB\" GROUP BY \"t6\".\"ENAME\""},{"index":112,"rewrite rule":"testPushAggregateThroughOuterJoin3","original query":"SELECT \"t0\".\"ENAME\", \"EMP0\".\"MGR\" FROM (SELECT * FROM \"EMP\" WHERE \"ENAME\" = 'A') AS \"t0\" LEFT JOIN \"EMP\" AS \"EMP0\" ON \"t0\".\"JOB\" = \"EMP0\".\"JOB\" GROUP BY \"t0\".\"ENAME\", \"EMP0\".\"MGR\"","rewritten query":"SELECT \"t5\".\"ENAME\", \"t6\".\"MGR\" FROM (SELECT \"ENAME\", \"JOB\" FROM \"EMP\" WHERE \"ENAME\" = 'A' GROUP BY \"ENAME\", \"JOB\") AS \"t5\" LEFT JOIN (SELECT \"JOB\", \"MGR\" FROM \"EMP\" GROUP BY \"JOB\", \"MGR\") AS \"t6\" ON \"t5\".\"JOB\" = \"t6\".\"JOB\" GROUP BY \"t5\".\"ENAME\", \"t6\".\"MGR\""},{"index":113,"rewrite rule":"testPushAggregateThroughOuterJoin4","original query":"SELECT \"t0\".\"JOB\" FROM (SELECT * FROM \"EMP\" WHERE \"ENAME\" = 'A') AS \"t0\" LEFT JOIN \"DEPT\" ON \"t0\".\"JOB\" = \"DEPT\".\"NAME\" GROUP BY \"t0\".\"JOB\"","rewritten query":"SELECT \"t5\".\"JOB\" FROM (SELECT \"JOB\" FROM \"EMP\" WHERE \"ENAME\" = 'A' GROUP BY \"JOB\") AS \"t5\" LEFT JOIN (SELECT \"NAME\" FROM \"DEPT\" GROUP BY \"NAME\") AS \"t6\" ON \"t5\".\"JOB\" = \"t6\".\"NAME\""},{"index":114,"rewrite rule":"testPushAggregateThroughOuterJoin5","original query":"SELECT \"DEPT\".\"NAME\" FROM (SELECT * FROM \"EMP\" WHERE \"ENAME\" = 'A') AS \"t0\" LEFT JOIN \"DEPT\" ON \"t0\".\"JOB\" = \"DEPT\".\"NAME\" GROUP BY \"DEPT\".\"NAME\"","rewritten query":"SELECT \"t6\".\"NAME\" FROM (SELECT \"JOB\" FROM \"EMP\" WHERE \"ENAME\" = 'A' GROUP BY \"JOB\") AS \"t5\" LEFT JOIN (SELECT \"NAME\" FROM \"DEPT\" GROUP BY \"NAME\") AS \"t6\" ON \"t5\".\"JOB\" = \"t6\".\"NAME\" GROUP BY \"t6\".\"NAME\""},{"index":115,"rewrite rule":"testPushAggregateThroughOuterJoin6","original query":"SELECT \"t0\".\"JOB\", \"DEPT\".\"NAME\" FROM (SELECT * FROM \"EMP\" WHERE \"ENAME\" = 'A') AS \"t0\" LEFT JOIN \"DEPT\" ON \"t0\".\"JOB\" = \"DEPT\".\"NAME\" GROUP BY \"t0\".\"JOB\", \"DEPT\".\"NAME\"","rewritten query":"SELECT * FROM (SELECT \"JOB\" FROM \"EMP\" WHERE \"ENAME\" = 'A' GROUP BY \"JOB\") AS \"t5\" LEFT JOIN (SELECT \"NAME\" FROM \"DEPT\" GROUP BY \"NAME\") AS \"t6\" ON \"t5\".\"JOB\" = \"t6\".\"NAME\""},{"index":116,"rewrite rule":"testPushAggregateThroughOuterJoin7","original query":"SELECT \"t0\".\"JOB\" FROM (SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\", \"DEPTNO\" + \"EMPNO\" AS \"$f9\" FROM \"EMP\" WHERE \"ENAME\" = 'A') AS \"t0\" LEFT JOIN (SELECT \"DEPTNO\", \"NAME\", \"DEPTNO\" + 5 AS \"$f2\" FROM \"DEPT\") AS \"t1\" ON \"t0\".\"JOB\" = \"t1\".\"NAME\" AND \"t0\".\"$f9\" = \"t1\".\"$f2\" GROUP BY \"t0\".\"JOB\"","rewritten query":"SELECT \"t6\".\"JOB\" FROM (SELECT \"JOB\", \"DEPTNO\" + \"EMPNO\" AS \"$f9\" FROM \"EMP\" WHERE \"ENAME\" = 'A' GROUP BY \"JOB\", \"DEPTNO\" + \"EMPNO\") AS \"t6\" LEFT JOIN (SELECT \"NAME\", \"DEPTNO\" + 5 AS \"$f2\" FROM \"DEPT\" GROUP BY \"NAME\", \"DEPTNO\" + 5) AS \"t8\" ON \"t6\".\"JOB\" = \"t8\".\"NAME\" AND \"t6\".\"$f9\" = \"t8\".\"$f2\" GROUP BY \"t6\".\"JOB\""},{"index":117,"rewrite rule":"testPushAggregateThroughOuterJoin8","original query":"SELECT \"t1\".\"NAME\" FROM (SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\", \"DEPTNO\" + \"EMPNO\" AS \"$f9\" FROM \"EMP\" WHERE \"ENAME\" = 'A') AS \"t0\" LEFT JOIN (SELECT \"DEPTNO\", \"NAME\", \"DEPTNO\" + 5 AS \"$f2\" FROM \"DEPT\") AS \"t1\" ON \"t0\".\"JOB\" = \"t1\".\"NAME\" AND \"t0\".\"$f9\" = \"t1\".\"$f2\" GROUP BY \"t1\".\"NAME\"","rewritten query":"SELECT \"t8\".\"NAME\" FROM (SELECT \"JOB\", \"DEPTNO\" + \"EMPNO\" AS \"$f9\" FROM \"EMP\" WHERE \"ENAME\" = 'A' GROUP BY \"JOB\", \"DEPTNO\" + \"EMPNO\") AS \"t6\" LEFT JOIN (SELECT \"NAME\", \"DEPTNO\" + 5 AS \"$f2\" FROM \"DEPT\" GROUP BY \"NAME\", \"DEPTNO\" + 5) AS \"t8\" ON \"t6\".\"JOB\" = \"t8\".\"NAME\" AND \"t6\".\"$f9\" = \"t8\".\"$f2\" GROUP BY \"t8\".\"NAME\""},{"index":118,"rewrite rule":"testPushAggregateThroughOuterJoin9","original query":"SELECT \"t0\".\"JOB\", \"t1\".\"NAME\" FROM (SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\", \"DEPTNO\" + \"EMPNO\" AS \"$f9\" FROM \"EMP\" WHERE \"ENAME\" = 'A') AS \"t0\" LEFT JOIN (SELECT \"DEPTNO\", \"NAME\", \"DEPTNO\" + 5 AS \"$f2\" FROM \"DEPT\") AS \"t1\" ON \"t0\".\"JOB\" = \"t1\".\"NAME\" AND \"t0\".\"$f9\" = \"t1\".\"$f2\" GROUP BY \"t0\".\"JOB\", \"t1\".\"NAME\"","rewritten query":"SELECT \"t6\".\"JOB\", \"t8\".\"NAME\" FROM (SELECT \"JOB\", \"DEPTNO\" + \"EMPNO\" AS \"$f9\" FROM \"EMP\" WHERE \"ENAME\" = 'A' GROUP BY \"JOB\", \"DEPTNO\" + \"EMPNO\") AS \"t6\" LEFT JOIN (SELECT \"NAME\", \"DEPTNO\" + 5 AS \"$f2\" FROM \"DEPT\" GROUP BY \"NAME\", \"DEPTNO\" + 5) AS \"t8\" ON \"t6\".\"JOB\" = \"t8\".\"NAME\" AND \"t6\".\"$f9\" = \"t8\".\"$f2\" GROUP BY \"t6\".\"JOB\", \"t8\".\"NAME\""},{"index":119,"rewrite rule":"testDistinctCountGroupingSets1","original query":"SELECT \"DEPTNO\", \"JOB\", COUNT(DISTINCT \"ENAME\") FROM \"EMP\" GROUP BY ROLLUP(\"DEPTNO\", \"JOB\")","rewritten query":"SELECT \"DEPTNO\", \"JOB\", COUNT(\"ENAME\") FILTER (WHERE \"$g_0\") FROM (SELECT \"DEPTNO\", \"JOB\", \"ENAME\", GROUPING(\"DEPTNO\", \"JOB\", \"ENAME\") = 0 AS \"$g_0\" FROM \"EMP\" GROUP BY \"DEPTNO\", \"JOB\", \"ENAME\") AS \"t3\" GROUP BY ROLLUP(\"DEPTNO\", \"JOB\")"},{"index":120,"rewrite rule":"testDistinctCountGroupingSets2","original query":"SELECT \"DEPTNO\", \"JOB\", COUNT(DISTINCT \"ENAME\"), SUM(\"SAL\") FROM \"EMP\" GROUP BY ROLLUP(\"DEPTNO\", \"JOB\")","rewritten query":"SELECT \"DEPTNO\", \"JOB\", COUNT(\"ENAME\") FILTER (WHERE \"$g_0\"), CAST(MIN(\"EXPR$3\") FILTER (WHERE \"$g_1\") AS INTEGER) FROM (SELECT \"DEPTNO\", \"JOB\", \"ENAME\", SUM(\"SAL\") AS \"EXPR$3\", GROUPING(\"DEPTNO\", \"JOB\", \"ENAME\") = 0 AS \"$g_0\", GROUPING(\"DEPTNO\", \"JOB\", \"ENAME\") = 1 AS \"$g_1\" FROM \"EMP\" GROUP BY GROUPING SETS((\"DEPTNO\", \"JOB\", \"ENAME\"), (\"DEPTNO\", \"JOB\"))) AS \"t3\" GROUP BY ROLLUP(\"DEPTNO\", \"JOB\")"},{"index":121,"rewrite rule":"testPushProjectPastSetOp","original query":"SELECT \"SAL\" FROM (SELECT * FROM \"EMP\" UNION ALL SELECT * FROM \"EMP\") AS \"t1\"","rewritten query":"SELECT \"SAL\" FROM \"EMP\" UNION ALL SELECT \"SAL\" FROM \"EMP\""},{"index":122,"rewrite rule":"testJoinPushTransitivePredicatesRule2","original query":"SELECT \"t0\".\"SAL\" FROM (SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"SLACKER\", \"SAL\" AS \"SAL0\", \"SAL\" = 4 AS \"$f9\" FROM \"EMPNULLABLES\" WHERE \"DEPTNO\" = 20 AND \"SAL\" > 1000) AS \"t0\" INNER JOIN (SELECT \"t2\".\"SAL\", \"t5\".\"SAL\" AS \"SAL0\", \"t5\".\"$f9\" FROM (SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"SLACKER\" FROM \"EMPNULLABLES\" WHERE \"DEPTNO\" = 20 AND \"SAL\" > 1000) AS \"t2\" INNER JOIN (SELECT \"SAL\", \"SAL\" = 4 AS \"$f9\" FROM \"EMPNULLABLES\" WHERE \"DEPTNO\" = 20 AND \"SAL\" > 1000 GROUP BY \"SAL\", \"SAL\" = 4) AS \"t5\" ON \"t2\".\"SAL\" = \"t5\".\"SAL\" OR \"t5\".\"$f9\" GROUP BY \"t2\".\"SAL\", \"t5\".\"SAL\", \"t5\".\"$f9\" HAVING \"t5\".\"SAL\" = \"t2\".\"SAL\") AS \"t8\" ON \"t0\".\"SAL\" = \"t8\".\"SAL0\" AND \"t0\".\"$f9\" = \"t8\".\"$f9\"","rewritten query":"SELECT \"t12\".\"SAL\" FROM (SELECT * FROM (SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"SLACKER\", \"SAL\" AS \"SAL0\", \"SAL\" = 4 AS \"$f9\" FROM \"EMPNULLABLES\" WHERE \"DEPTNO\" = 20 AND \"SAL\" > 1000) AS \"t11\" WHERE \"SAL\" > 1000) AS \"t12\" INNER JOIN (SELECT \"t14\".\"SAL\", \"t17\".\"SAL\" AS \"SAL0\", \"t17\".\"$f9\" FROM (SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"SLACKER\" FROM \"EMPNULLABLES\" WHERE \"DEPTNO\" = 20 AND \"SAL\" > 1000) AS \"t14\" INNER JOIN (SELECT \"SAL\", \"SAL\" = 4 AS \"$f9\" FROM \"EMPNULLABLES\" WHERE \"DEPTNO\" = 20 AND \"SAL\" > 1000 GROUP BY \"SAL\", \"SAL\" = 4) AS \"t17\" ON \"t14\".\"SAL\" = \"t17\".\"SAL\" OR \"t17\".\"$f9\" GROUP BY \"t14\".\"SAL\", \"t17\".\"SAL\", \"t17\".\"$f9\" HAVING \"t17\".\"SAL\" = \"t14\".\"SAL\") AS \"t20\" ON \"t12\".\"SAL\" = \"t20\".\"SAL0\" AND \"t12\".\"$f9\" = \"t20\".\"$f9\""},{"index":123,"rewrite rule":"testPushFilterPastAgg","original query":"SELECT \"NAME\" AS \"NAME\", COUNT(*) AS \"C\" FROM \"DEPT\" GROUP BY \"NAME\" HAVING \"NAME\" = 'Charlie'","rewritten query":"SELECT \"NAME\", COUNT(*) AS \"C\" FROM (SELECT \"NAME\" AS \"NAME\" FROM \"DEPT\") AS \"t3\" WHERE \"NAME\" = 'Charlie' GROUP BY \"NAME\""},{"index":124,"rewrite rule":"testInferringPredicatesWithNotOperatorInJoinCondition","original query":"SELECT * FROM \"EMP\" INNER JOIN \"EMP\" AS \"EMP0\" ON \"EMP\".\"DEPTNO\" = \"EMP0\".\"DEPTNO\" AND NOT (\"EMP\".\"DEPTNO\" = 4 OR \"EMP\".\"DEPTNO\" = 6)","rewritten query":"SELECT * FROM (SELECT * FROM \"EMP\" WHERE NOT (\"DEPTNO\" = 4 OR \"DEPTNO\" = 6)) AS \"t0\" INNER JOIN (SELECT * FROM \"EMP\" WHERE \"DEPTNO\" NOT IN (4, 6)) AS \"t1\" ON \"t0\".\"DEPTNO\" = \"t1\".\"DEPTNO\""},{"index":125,"rewrite rule":"testFlattenUncorrelatedCallBelowEquals","original query":"SELECT \"$cor0\".\"EMPNO\", \"$cor0\".\"ENAME\", \"$cor0\".\"JOB\", \"$cor0\".\"MGR\", \"$cor0\".\"HIREDATE\", \"$cor0\".\"SAL\", \"$cor0\".\"COMM\", \"$cor0\".\"DEPTNO\", \"$cor0\".\"SLACKER\" FROM \"EMP\" AS \"$cor0\", LATERAL (SELECT MIN(TRUE) AS \"$f0\" FROM \"EMP\" WHERE \"$cor0\".\"DEPTNO\" = \"DEPTNO\" + 30) AS \"t1\" WHERE \"$cor0\".\"$f0\" IS NOT NULL","rewritten query":"SELECT \"$cor0\".\"EMPNO\", \"$cor0\".\"ENAME\", \"$cor0\".\"JOB\", \"$cor0\".\"MGR\", \"$cor0\".\"HIREDATE\", \"$cor0\".\"SAL\", \"$cor0\".\"COMM\", \"$cor0\".\"DEPTNO\", \"$cor0\".\"SLACKER\" FROM \"EMP\" AS \"$cor0\", LATERAL (SELECT MIN(TRUE) AS \"$f0\" FROM (SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\", \"DEPTNO\" + 30 AS \"$f9\" FROM \"EMP\") AS \"t4\" WHERE \"$cor0\".\"DEPTNO\" = \"$f9\") AS \"t8\" WHERE \"$cor0\".\"$f0\" IS NOT NULL"},{"index":126,"rewrite rule":"testSortJoinCopySemiJoinOrderByLimitOffset","original query":"SELECT \"DEPT\".\"DEPTNO\", \"DEPT\".\"NAME\" FROM \"DEPT\" INNER JOIN (SELECT \"DEPTNO\" FROM \"EMP\" GROUP BY \"DEPTNO\") AS \"t0\" ON \"DEPT\".\"DEPTNO\" = \"t0\".\"DEPTNO\" ORDER BY \"DEPT\".\"DEPTNO\" OFFSET 2 ROWS FETCH NEXT 10 ROWS ONLY","rewritten query":"SELECT * FROM (SELECT \"DEPTNO\", \"NAME\" FROM \"DEPT\" WHERE EXISTS (SELECT 1 FROM (SELECT \"DEPTNO\" FROM \"EMP\") AS \"t4\" WHERE \"DEPTNO\" = \"t4\".\"DEPTNO\") ORDER BY \"DEPTNO\") AS \"t3\" ORDER BY \"DEPTNO\" OFFSET 2 ROWS FETCH NEXT 10 ROWS ONLY"},{"index":127,"rewrite rule":"testPushProjectPastFullJoin","original query":"SELECT COUNT(*), CASE WHEN \"EMP\".\"SAL\" < 11 THEN 11 ELSE -1 * \"EMP\".\"SAL\" END FROM \"EMP\" FULL JOIN \"BONUS\" ON \"EMP\".\"ENAME\" = \"BONUS\".\"ENAME\" GROUP BY CASE WHEN \"EMP\".\"SAL\" < 11 THEN 11 ELSE -1 * \"EMP\".\"SAL\" END","rewritten query":"SELECT COUNT(*), CASE WHEN \"t2\".\"EXPR$0\" THEN 11 ELSE \"t2\".\"EXPR$1\" END FROM (SELECT \"ENAME\", \"SAL\" < 11 AS \"EXPR$0\", -1 * \"SAL\" AS \"EXPR$1\" FROM \"EMP\") AS \"t2\" FULL JOIN (SELECT \"ENAME\" FROM \"BONUS\") AS \"t3\" ON \"t2\".\"ENAME\" = \"t3\".\"ENAME\" GROUP BY CASE WHEN \"t2\".\"EXPR$0\" THEN 11 ELSE \"t2\".\"EXPR$1\" END"},{"index":128,"rewrite rule":"testEmptySort","original query":"SELECT * FROM \"EMP\" WHERE FALSE ORDER BY \"DEPTNO\"","rewritten query":"SELECT * FROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\") WHERE 1 = 0"},{"index":129,"rewrite rule":"testReduceConstantsDupNot","original query":"SELECT \"DEPTNO\" FROM \"DEPT\" WHERE NOT (\"DEPTNO\" = 7 AND \"DEPTNO\" = 8)","rewritten query":"SELECT \"DEPTNO\" FROM \"DEPT\""},{"index":130,"rewrite rule":"testCasePushIsAlwaysWorking","original query":"SELECT \"EMPNO\" FROM \"EMP\" WHERE CASE WHEN \"SAL\" > 1000 THEN \"EMPNO\" ELSE \"SAL\" END = 1","rewritten query":"SELECT \"EMPNO\" FROM \"EMP\" WHERE \"SAL\" > 1000 AND \"EMPNO\" = 1 OR \"SAL\" = 1"},{"index":131,"rewrite rule":"testOversimplifiedCaseStatement","original query":"SELECT * FROM \"EMP\" WHERE \"MGR\" > 0 AND CASE WHEN \"MGR\" > 0 THEN \"DEPTNO\" \/ \"MGR\" ELSE NULL END > 1","rewritten query":"SELECT * FROM \"EMP\" WHERE \"MGR\" > 0 AND CASE WHEN \"MGR\" > 0 THEN \"DEPTNO\" \/ \"MGR\" > 1 ELSE FALSE END"},{"index":132,"rewrite rule":"testAnyInProjectNullable","original query":"SELECT \"DEPTNO\", \"NAME\" IN (SELECT \"MGR\" FROM \"EMP\") FROM \"DEPT\"","rewritten query":"SELECT \"DEPT0\".\"DEPTNO\", \"t5\".\"i\" IS NOT NULL AND \"t2\".\"c\" <> 0 OR \"t2\".\"ck\" < \"t2\".\"c\" AND NULL AND \"t2\".\"c\" <> 0 AND \"t5\".\"i\" IS NULL FROM \"DEPT\" AS \"DEPT0\" CROSS JOIN (SELECT COUNT(*) AS \"c\", COUNT(\"MGR\") AS \"ck\" FROM \"EMP\") AS \"t2\" LEFT JOIN (SELECT \"EMP1\".\"MGR\", \"t3\".\"i\" FROM \"EMP\" AS \"EMP1\", (VALUES (TRUE)) AS \"t3\" (\"i\") GROUP BY \"EMP1\".\"MGR\", \"t3\".\"i\") AS \"t5\" ON \"DEPT0\".\"NAME\" = \"t5\".\"MGR\""},{"index":133,"rewrite rule":"testMultipleDistinctWithGrouping","original query":"SELECT \"SAL\", SUM(\"COMM\"), AVG(DISTINCT \"COMM\"), SUM(DISTINCT \"SAL\") FROM \"EMP\" GROUP BY \"SAL\"","rewritten query":"SELECT \"t2\".\"SAL\", \"t2\".\"EXPR$1\", \"t5\".\"EXPR$2\", \"t9\".\"EXPR$3\" FROM (SELECT \"SAL\", SUM(\"COMM\") AS \"EXPR$1\" FROM \"EMP\" GROUP BY \"SAL\") AS \"t2\" INNER JOIN (SELECT \"SAL\", AVG(\"COMM\") AS \"EXPR$2\" FROM (SELECT \"SAL\", \"COMM\" FROM \"EMP\" GROUP BY \"SAL\", \"COMM\") AS \"t4\" GROUP BY \"SAL\") AS \"t5\" ON \"t2\".\"SAL\" IS NOT DISTINCT FROM \"t5\".\"SAL\" INNER JOIN (SELECT \"SAL\", SUM(\"SAL\") AS \"EXPR$3\" FROM (SELECT \"SAL\" FROM \"EMP\" GROUP BY \"SAL\") AS \"t8\" GROUP BY \"SAL\") AS \"t9\" ON \"t2\".\"SAL\" IS NOT DISTINCT FROM \"t9\".\"SAL\""},{"index":134,"rewrite rule":"testMergeFilterWithJoinCondition","original query":"SELECT \"DEPT\".\"NAME\" AS \"NAME\", \"EMP\".\"ENAME\" FROM \"EMP\" INNER JOIN \"DEPT\" ON \"EMP\".\"DEPTNO\" = \"DEPT\".\"DEPTNO\" WHERE \"DEPT\".\"NAME\" = 'Propane'","rewritten query":"SELECT \"DEPT0\".\"NAME\" AS \"NAME\", \"EMP0\".\"ENAME\" FROM \"EMP\" AS \"EMP0\", \"DEPT\" AS \"DEPT0\" WHERE \"EMP0\".\"DEPTNO\" = \"DEPT0\".\"DEPTNO\" AND \"DEPT0\".\"NAME\" = 'Propane'"},{"index":136,"rewrite rule":"testJoinAssociateRuleWithBottomAlwaysTrueConditionAllowed","original query":"SELECT * FROM \"EMP\" INNER JOIN \"DEPT\" ON \"EMP\".\"DEPTNO\" = \"DEPT\".\"DEPTNO\" INNER JOIN \"BONUS\" ON \"EMP\".\"JOB\" = \"BONUS\".\"JOB\"","rewritten query":"SELECT * FROM \"EMP\" AS \"EMP0\" INNER JOIN (\"DEPT\" AS \"DEPT0\" CROSS JOIN \"BONUS\" AS \"BONUS0\") ON \"EMP0\".\"JOB\" = \"BONUS0\".\"JOB\" AND \"EMP0\".\"DEPTNO\" = \"DEPT0\".\"DEPTNO\""},{"index":137,"rewrite rule":"testReduceConstantsIsNull","original query":"SELECT \"EMPNO\" FROM \"EMP\" WHERE \"EMPNO\" = 10 AND \"EMPNO\" IS NULL","rewritten query":"SELECT \"EMPNO\" FROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\") WHERE 1 = 0"},{"index":138,"rewrite rule":"testTransitiveInferenceJoin","original query":"SELECT 1 FROM \"EMP\" INNER JOIN \"EMP\" AS \"EMP0\" ON \"EMP\".\"DEPTNO\" = \"EMP0\".\"DEPTNO\" WHERE \"EMP0\".\"DEPTNO\" > 7","rewritten query":"SELECT 1 FROM (SELECT * FROM \"EMP\" WHERE \"DEPTNO\" > 7) AS \"t1\" INNER JOIN (SELECT * FROM \"EMP\" WHERE \"DEPTNO\" > 7) AS \"t2\" ON \"t1\".\"DEPTNO\" = \"t2\".\"DEPTNO\""},{"index":139,"rewrite rule":"testPullAggregateThroughUnionWithAlias","original query":"SELECT \"JOB\", \"C\" FROM (SELECT \"JOB\", \"DEPTNO\" AS \"C\" FROM \"EMP\" GROUP BY \"JOB\", \"DEPTNO\" UNION ALL SELECT \"JOB\", \"DEPTNO\" AS \"C\" FROM \"EMP\" GROUP BY \"JOB\", \"DEPTNO\") AS \"t3\" GROUP BY \"JOB\", \"C\"","rewritten query":"SELECT \"JOB\", \"DEPTNO\" AS \"C\" FROM (SELECT \"JOB\", \"DEPTNO\" FROM \"EMP\" GROUP BY \"JOB\", \"DEPTNO\" UNION ALL SELECT \"JOB\", \"DEPTNO\" FROM \"EMP\") AS \"t7\" GROUP BY \"JOB\", \"DEPTNO\""},{"index":140,"rewrite rule":"testPushCountNullableGroupingSetsThroughUnion","original query":"SELECT \"DEPTNO\", \"JOB\", COUNT(\"MGR\") FROM (SELECT * FROM \"EMP\" UNION ALL SELECT * FROM \"EMP\") AS \"t1\" GROUP BY ROLLUP(\"DEPTNO\", \"JOB\")","rewritten query":"SELECT \"DEPTNO\", \"JOB\", COALESCE(SUM(\"EXPR$2\"), 0) FROM (SELECT \"DEPTNO\", \"JOB\", COUNT(\"MGR\") AS \"EXPR$2\" FROM \"EMP\" GROUP BY \"DEPTNO\", \"JOB\" UNION ALL SELECT \"DEPTNO\", \"JOB\", COUNT(\"MGR\") AS \"EXPR$2\" FROM \"EMP\" GROUP BY \"DEPTNO\", \"JOB\") AS \"t8\" GROUP BY ROLLUP(\"DEPTNO\", \"JOB\")"},{"index":142,"rewrite rule":"testPushProjectPastRightJoinStrong","original query":"SELECT COUNT(*), CASE WHEN \"EMP\".\"SAL\" < 11 THEN -1 * \"EMP\".\"SAL\" ELSE \"EMP\".\"SAL\" END FROM \"EMP\" RIGHT JOIN \"BONUS\" ON \"EMP\".\"ENAME\" = \"BONUS\".\"ENAME\" GROUP BY CASE WHEN \"EMP\".\"SAL\" < 11 THEN -1 * \"EMP\".\"SAL\" ELSE \"EMP\".\"SAL\" END","rewritten query":"SELECT COUNT(*), \"t2\".\"EXPR$1\" FROM (SELECT \"ENAME\", CASE WHEN \"SAL\" < 11 THEN -1 * \"SAL\" ELSE \"SAL\" END AS \"EXPR$1\" FROM \"EMP\") AS \"t2\" RIGHT JOIN (SELECT \"ENAME\" FROM \"BONUS\") AS \"t3\" ON \"t2\".\"ENAME\" = \"t3\".\"ENAME\" GROUP BY \"t2\".\"EXPR$1\""},{"index":143,"rewrite rule":"testExpressionSimplification1","original query":"SELECT * FROM \"EMP\" WHERE \"ENAME\" <> '' AND \"ENAME\" <> '3'","rewritten query":"SELECT * FROM \"EMP\" WHERE \"ENAME\" NOT IN ('', '3')"},{"index":144,"rewrite rule":"testExpressionSimplification2","original query":"SELECT * FROM \"EMP\" WHERE (\"ENAME\" < '' OR \"ENAME\" > '') AND (\"ENAME\" < '3' OR \"ENAME\" > '3')","rewritten query":"SELECT * FROM \"EMP\" WHERE \"ENAME\" NOT IN ('', '3')"},{"index":145,"rewrite rule":"testPushProjectPastRightJoinSwapStrong","original query":"SELECT COUNT(*), CASE WHEN \"EMP\".\"SAL\" < 11 THEN -1 * \"EMP\".\"SAL\" ELSE \"EMP\".\"SAL\" END FROM \"BONUS\" RIGHT JOIN \"EMP\" ON \"BONUS\".\"ENAME\" = \"EMP\".\"ENAME\" GROUP BY CASE WHEN \"EMP\".\"SAL\" < 11 THEN -1 * \"EMP\".\"SAL\" ELSE \"EMP\".\"SAL\" END","rewritten query":"SELECT COUNT(*), \"t3\".\"EXPR$1\" FROM (SELECT \"ENAME\" FROM \"BONUS\") AS \"t2\" RIGHT JOIN (SELECT \"ENAME\", CASE WHEN \"SAL\" < 11 THEN -1 * \"SAL\" ELSE \"SAL\" END AS \"EXPR$1\" FROM \"EMP\") AS \"t3\" ON \"t2\".\"ENAME\" = \"t3\".\"ENAME\" GROUP BY \"t3\".\"EXPR$1\""},{"index":146,"rewrite rule":"testFullOuterJoinSimplificationToRightOuter","original query":"SELECT 1 FROM \"DEPT\" FULL JOIN \"EMP\" ON \"DEPT\".\"DEPTNO\" = \"EMP\".\"DEPTNO\" WHERE \"EMP\".\"SAL\" > 100","rewritten query":"SELECT 1 FROM \"DEPT\" AS \"DEPT0\" RIGHT JOIN (SELECT * FROM \"EMP\" WHERE \"SAL\" > 100) AS \"t1\" ON \"DEPT0\".\"DEPTNO\" = \"t1\".\"DEPTNO\""},{"index":147,"rewrite rule":"testPushFilterPastAggTwo","original query":"SELECT \"NAME\" AS \"C1\" FROM \"DEPT\" WHERE \"NAME\" > 'b' GROUP BY \"NAME\" HAVING \"NAME\" > 'c' AND (COUNT(*) > 30 OR \"NAME\" < 'z')","rewritten query":"SELECT \"C1\" FROM (SELECT \"NAME\" AS \"C1\" FROM \"DEPT\" WHERE \"NAME\" > 'b') AS \"t5\" WHERE \"C1\" > 'c' GROUP BY \"C1\" HAVING COUNT(*) > 30 OR \"C1\" < 'z'"},{"index":148,"rewrite rule":"testPushAggregateSumNoGroup","original query":"SELECT COUNT(*) FROM \"EMP\" INNER JOIN \"DEPT\" ON \"EMP\".\"JOB\" = \"DEPT\".\"NAME\"","rewritten query":"SELECT COALESCE(SUM(\"t1\".\"EXPR$0\" * \"t2\".\"EXPR$0\"), 0) FROM (SELECT \"JOB\", COUNT(*) AS \"EXPR$0\" FROM \"EMP\" GROUP BY \"JOB\") AS \"t1\" INNER JOIN (SELECT \"NAME\", COUNT(*) AS \"EXPR$0\" FROM \"DEPT\" GROUP BY \"NAME\") AS \"t2\" ON \"t1\".\"JOB\" = \"t2\".\"NAME\""},{"index":149,"rewrite rule":"testPushProjectPastLeftJoin","original query":"SELECT COUNT(*), CASE WHEN \"EMP\".\"SAL\" < 11 THEN 11 ELSE -1 * \"EMP\".\"SAL\" END FROM \"EMP\" LEFT JOIN \"BONUS\" ON \"EMP\".\"ENAME\" = \"BONUS\".\"ENAME\" GROUP BY CASE WHEN \"EMP\".\"SAL\" < 11 THEN 11 ELSE -1 * \"EMP\".\"SAL\" END","rewritten query":"SELECT COUNT(*), \"t2\".\"EXPR$1\" FROM (SELECT \"ENAME\", CASE WHEN \"SAL\" < 11 THEN 11 ELSE -1 * \"SAL\" END AS \"EXPR$1\" FROM \"EMP\") AS \"t2\" LEFT JOIN (SELECT \"ENAME\" FROM \"BONUS\") AS \"t3\" ON \"t2\".\"ENAME\" = \"t3\".\"ENAME\" GROUP BY \"t2\".\"EXPR$1\""},{"index":150,"rewrite rule":"testPushFilterPastAggFour","original query":"SELECT \"DEPTNO\", COUNT(*) FROM \"EMP\" WHERE \"SAL\" > '12' GROUP BY \"DEPTNO\"","rewritten query":"SELECT \"DEPTNO\", COALESCE(SUM(\"EXPR$1\"), 0) FROM (SELECT \"SAL\", \"DEPTNO\", COUNT(*) AS \"EXPR$1\" FROM \"EMP\" WHERE \"SAL\" > 12 GROUP BY \"SAL\", \"DEPTNO\") AS \"t3\" GROUP BY \"DEPTNO\""},{"index":151,"rewrite rule":"testSortUnionTranspose","original query":"SELECT * FROM (SELECT \"NAME\" FROM \"DEPT\" UNION ALL SELECT \"NAME\" FROM \"DEPT\") AS \"t1\" ORDER BY \"NAME\" FETCH NEXT 10 ROWS ONLY","rewritten query":"SELECT * FROM ((SELECT \"NAME\" FROM \"DEPT\" ORDER BY \"NAME\" FETCH NEXT 10 ROWS ONLY) UNION ALL (SELECT \"NAME\" FROM \"DEPT\" ORDER BY \"NAME\" FETCH NEXT 10 ROWS ONLY)) AS \"t\" ORDER BY \"NAME\" FETCH NEXT 10 ROWS ONLY"},{"index":152,"rewrite rule":"testReduceConstantsNegated","original query":"SELECT \"EMPNO\" FROM \"EMP\" WHERE \"EMPNO\" = 10 AND NOT \"EMPNO\" = 10","rewritten query":"SELECT \"EMPNO\" FROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\") WHERE 1 = 0"},{"index":153,"rewrite rule":"testIsNullPushDown","original query":"SELECT * FROM (SELECT \"EMPNO\", \"DEPTNO\", COUNT(\"EMPNO\") OVER (PARTITION BY \"DEPTNO\" ORDER BY \"EMPNO\" RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS \"W_COUNT\" FROM \"EMP\") AS \"t\" WHERE \"W_COUNT\" IS NULL","rewritten query":"SELECT \"EMPNO\", \"DEPTNO\", \"$2\" AS \"W_COUNT\" FROM (VALUES (NULL, NULL, NULL)) AS \"t\" (\"EMPNO\", \"DEPTNO\", \"$2\") WHERE 1 = 0"},{"index":154,"rewrite rule":"testPullAggregateThroughUnion2","original query":"SELECT \"DEPTNO\", \"JOB\" FROM (SELECT \"DEPTNO\", \"JOB\" FROM \"EMP\" GROUP BY \"DEPTNO\", \"JOB\" UNION ALL SELECT \"DEPTNO\", \"JOB\" FROM \"EMP\" GROUP BY \"DEPTNO\", \"JOB\") AS \"t3\" GROUP BY \"DEPTNO\", \"JOB\"","rewritten query":"SELECT \"DEPTNO\", \"JOB\" FROM (SELECT \"DEPTNO\", \"JOB\" FROM \"EMP\" UNION ALL SELECT \"DEPTNO\", \"JOB\" FROM \"EMP\") AS \"t7\" GROUP BY \"DEPTNO\", \"JOB\""},{"index":155,"rewrite rule":"testMaxReuseDistinctAttrWithMixedOptionality","original query":"SELECT SUM(DISTINCT \"DEPTNO\"), COUNT(DISTINCT \"DEPTNO\"), MAX(\"DEPTNO\") FROM \"EMP\"","rewritten query":"SELECT SUM(\"DEPTNO\"), COUNT(\"DEPTNO\"), MAX(\"DEPTNO\") FROM (SELECT \"DEPTNO\" FROM \"EMP\" GROUP BY \"DEPTNO\") AS \"t2\""},{"index":156,"rewrite rule":"testReduceNullableToNotNull","original query":"SELECT \"EMPNO\" + CASE WHEN 'a' = 'a' THEN 1 ELSE NULL END AS \"NEWCOL\" FROM \"EMP\"","rewritten query":"SELECT \"EMPNO\" + 1 AS \"NEWCOL\" FROM \"EMP\""},{"index":157,"rewrite rule":"testAggregateJoinRemove10","original query":"SELECT \"EMP\".\"DEPTNO\", COUNT(DISTINCT \"DEPT\".\"NAME\", \"DEPT0\".\"NAME\") FROM \"EMP\" LEFT JOIN \"DEPT\" ON \"EMP\".\"DEPTNO\" = \"DEPT\".\"DEPTNO\" LEFT JOIN \"DEPT\" AS \"DEPT0\" ON \"EMP\".\"DEPTNO\" = \"DEPT0\".\"DEPTNO\" GROUP BY \"EMP\".\"DEPTNO\"","rewritten query":"SELECT \"EMP0\".\"DEPTNO\", COUNT(DISTINCT \"DEPT1\".\"NAME\", \"DEPT2\".\"NAME\") FROM \"EMP\" AS \"EMP0\" LEFT JOIN \"DEPT\" AS \"DEPT1\" ON \"EMP0\".\"DEPTNO\" = \"DEPT1\".\"DEPTNO\" LEFT JOIN \"DEPT\" AS \"DEPT2\" ON \"EMP0\".\"DEPTNO\" = \"DEPT2\".\"DEPTNO\" GROUP BY \"EMP0\".\"DEPTNO\""},{"index":158,"rewrite rule":"testAggregateJoinRemove11","original query":"SELECT \"EMP\".\"DEPTNO\", COUNT(DISTINCT \"EMP\".\"SLACKER\") FROM \"EMP\" LEFT JOIN \"DEPT\" ON \"EMP\".\"DEPTNO\" = \"DEPT\".\"DEPTNO\" GROUP BY \"EMP\".\"DEPTNO\"","rewritten query":"SELECT \"DEPTNO\", COUNT(DISTINCT \"SLACKER\") FROM \"EMP\" GROUP BY \"DEPTNO\""},{"index":159,"rewrite rule":"testSumAndDistinctSumWithExpandSumType","original query":"SELECT SUM(\"COMM\"), SUM(DISTINCT \"COMM\") FROM \"EMP\"","rewritten query":"SELECT CAST(SUM(\"EXPR$0\") AS BIGINT), SUM(\"COMM\") FROM (SELECT \"COMM\", SUM(\"COMM\") AS \"EXPR$0\" FROM \"EMP\" GROUP BY \"COMM\") AS \"t2\""},{"index":160,"rewrite rule":"testProjectCorrelateTransposeRuleAntiCorrelate","original query":"SELECT \"$cor0\".\"f\" FROM (VALUES ('1', '2')) AS \"$cor0\" (\"f\", \"f2\"), LATERAL (SELECT \"f3\", \"$cor0\".\"f\" AS \"$f1\" FROM (VALUES ('1', '2')) AS \"t\" (\"f3\", \"f4\")) AS \"t1\"","rewritten query":"SELECT * FROM (SELECT \"f\" FROM (VALUES ('1', '2')) AS \"t\" (\"f\", \"f2\")) AS \"$cor0\", LATERAL (SELECT FROM (VALUES ('1', '2')) AS \"t\" (\"f3\", \"f4\")) AS \"t7\""},{"index":161,"rewrite rule":"testProjectJoinRemove10","original query":"SELECT \"EMP\".\"DEPTNO\", \"EMP\".\"SLACKER\" FROM \"EMP\" LEFT JOIN \"DEPT\" ON \"EMP\".\"DEPTNO\" = \"DEPT\".\"DEPTNO\"","rewritten query":"SELECT \"DEPTNO\", \"SLACKER\" FROM \"EMP\""},{"index":162,"rewrite rule":"testSortJoinTranspose1","original query":"SELECT * FROM \"EMP\" LEFT JOIN (SELECT * FROM \"DEPT\") AS \"t\" ON \"EMP\".\"DEPTNO\" = \"t\".\"DEPTNO\" ORDER BY \"EMP\".\"SAL\" FETCH NEXT 10 ROWS ONLY","rewritten query":"SELECT \"t2\".\"EMPNO\", \"t2\".\"ENAME\", \"t2\".\"JOB\", \"t2\".\"MGR\", \"t2\".\"HIREDATE\", \"t2\".\"SAL\", \"t2\".\"COMM\", \"t2\".\"DEPTNO\", \"t2\".\"SLACKER\", \"t3\".\"DEPTNO\" AS \"DEPTNO0\", \"t3\".\"NAME\" FROM (SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\" FROM \"EMP\" ORDER BY \"SAL\" FETCH NEXT 10 ROWS ONLY) AS \"t2\" LEFT JOIN (SELECT * FROM \"DEPT\") AS \"t3\" ON \"t2\".\"DEPTNO\" = \"t3\".\"DEPTNO\" ORDER BY \"t2\".\"SAL\" FETCH NEXT 10 ROWS ONLY"},{"index":163,"rewrite rule":"testSortJoinTranspose2","original query":"SELECT * FROM \"EMP\" RIGHT JOIN (SELECT * FROM \"DEPT\") AS \"t\" ON \"EMP\".\"DEPTNO\" = \"t\".\"DEPTNO\" ORDER BY \"t\".\"NAME\"","rewritten query":"SELECT \"EMP0\".\"EMPNO\", \"EMP0\".\"ENAME\", \"EMP0\".\"JOB\", \"EMP0\".\"MGR\", \"EMP0\".\"HIREDATE\", \"EMP0\".\"SAL\", \"EMP0\".\"COMM\", \"EMP0\".\"DEPTNO\", \"EMP0\".\"SLACKER\", \"t3\".\"DEPTNO\" AS \"DEPTNO0\", \"t3\".\"NAME\" FROM \"EMP\" AS \"EMP0\" RIGHT JOIN (SELECT \"DEPTNO\", \"NAME\" FROM \"DEPT\" ORDER BY \"NAME\") AS \"t3\" ON \"EMP0\".\"DEPTNO\" = \"t3\".\"DEPTNO\" ORDER BY \"t3\".\"NAME\""},{"index":164,"rewrite rule":"testSortJoinTranspose4","original query":"SELECT * FROM \"EMP\" RIGHT JOIN (SELECT * FROM \"DEPT\") AS \"t\" ON \"EMP\".\"DEPTNO\" = \"t\".\"DEPTNO\" ORDER BY \"t\".\"NAME\"","rewritten query":"SELECT \"EMP0\".\"EMPNO\", \"EMP0\".\"ENAME\", \"EMP0\".\"JOB\", \"EMP0\".\"MGR\", \"EMP0\".\"HIREDATE\", \"EMP0\".\"SAL\", \"EMP0\".\"COMM\", \"EMP0\".\"DEPTNO\", \"EMP0\".\"SLACKER\", \"t3\".\"DEPTNO\" AS \"DEPTNO0\", \"t3\".\"NAME\" FROM \"EMP\" AS \"EMP0\" RIGHT JOIN (SELECT \"DEPTNO\", \"NAME\" FROM \"DEPT\" ORDER BY \"NAME\") AS \"t3\" ON \"EMP0\".\"DEPTNO\" = \"t3\".\"DEPTNO\" ORDER BY \"t3\".\"NAME\""},{"index":165,"rewrite rule":"testSortJoinTranspose6","original query":"SELECT \"DEPT\".\"DEPTNO\", \"EMP\".\"EMPNO\" FROM \"DEPT\" RIGHT JOIN \"EMP\" ON \"DEPT\".\"DEPTNO\" = \"EMP\".\"DEPTNO\" OFFSET 2 ROWS FETCH NEXT 10 ROWS ONLY","rewritten query":"SELECT \"DEPT0\".\"DEPTNO\", \"t1\".\"EMPNO\" FROM \"DEPT\" AS \"DEPT0\" RIGHT JOIN (SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\" FROM \"EMP\" OFFSET 2 ROWS FETCH NEXT 10 ROWS ONLY) AS \"t1\" ON \"DEPT0\".\"DEPTNO\" = \"t1\".\"DEPTNO\" OFFSET 2 ROWS FETCH NEXT 10 ROWS ONLY"},{"index":166,"rewrite rule":"testUnionMergeRule","original query":"SELECT * FROM (SELECT * FROM (SELECT \"NAME\", \"DEPTNO\" FROM \"DEPT\" UNION ALL SELECT \"NAME\", \"DEPTNO\" FROM (SELECT \"NAME\", \"DEPTNO\", COUNT(*) AS \"EXPR$2\" FROM \"DEPT\" GROUP BY \"NAME\", \"DEPTNO\" UNION ALL SELECT \"NAME\", \"DEPTNO\", COUNT(*) AS \"EXPR$2\" FROM \"DEPT\" GROUP BY \"NAME\", \"DEPTNO\") AS \"t4\") AS \"t6\" UNION ALL SELECT \"NAME\", \"DEPTNO\" FROM \"DEPT\") AS \"t9\"","rewritten query":"SELECT \"NAME\", \"DEPTNO\" FROM \"DEPT\" UNION ALL SELECT \"NAME\", \"DEPTNO\" FROM \"DEPT\" GROUP BY \"NAME\", \"DEPTNO\" UNION ALL SELECT \"NAME\", \"DEPTNO\" FROM \"DEPT\" GROUP BY \"NAME\", \"DEPTNO\" UNION ALL SELECT \"NAME\", \"DEPTNO\" FROM \"DEPT\""},{"index":167,"rewrite rule":"testJoinDeriveIsNotNullFilterRule1","original query":"SELECT \"EMP\".\"DEPTNO\" FROM \"EMP\" INNER JOIN \"EMP\" AS \"EMP0\" ON \"EMP\".\"MGR\" = \"EMP0\".\"MGR\"","rewritten query":"SELECT \"t0\".\"DEPTNO\" FROM (SELECT * FROM \"EMP\" WHERE \"MGR\" IS NOT NULL) AS \"t0\" INNER JOIN (SELECT * FROM \"EMP\" WHERE \"MGR\" IS NOT NULL) AS \"t1\" ON \"t0\".\"MGR\" = \"t1\".\"MGR\""},{"index":168,"rewrite rule":"testJoinDeriveIsNotNullFilterRule2","original query":"SELECT \"t0\".\"DEPTNO\" FROM (SELECT * FROM \"EMP\" WHERE \"MGR\" IS NOT NULL) AS \"t0\" INNER JOIN \"EMP\" AS \"EMP0\" ON \"t0\".\"MGR\" = \"EMP0\".\"MGR\"","rewritten query":"SELECT \"t3\".\"DEPTNO\" FROM (SELECT * FROM \"EMP\" WHERE \"MGR\" IS NOT NULL) AS \"t3\" INNER JOIN (SELECT * FROM \"EMP\" WHERE \"MGR\" IS NOT NULL) AS \"t4\" ON \"t3\".\"MGR\" = \"t4\".\"MGR\""},{"index":169,"rewrite rule":"testJoinDeriveIsNotNullFilterRule3","original query":"SELECT \"EMP\".\"DEPTNO\" FROM \"EMP\" INNER JOIN \"EMP\" AS \"EMP0\" ON \"EMP\".\"MGR\" > \"EMP0\".\"MGR\"","rewritten query":"SELECT \"t0\".\"DEPTNO\" FROM (SELECT * FROM \"EMP\" WHERE \"MGR\" IS NOT NULL) AS \"t0\" INNER JOIN (SELECT * FROM \"EMP\" WHERE \"MGR\" IS NOT NULL) AS \"t1\" ON \"t0\".\"MGR\" > \"t1\".\"MGR\""},{"index":170,"rewrite rule":"testJoinDeriveIsNotNullFilterRule4","original query":"SELECT \"EMPNULLABLES\".\"DEPTNO\" FROM \"EMPNULLABLES\" INNER JOIN \"EMPNULLABLES\" AS \"EMPNULLABLES0\" ON \"EMPNULLABLES\".\"ENAME\" = \"EMPNULLABLES0\".\"ENAME\" AND \"EMPNULLABLES\".\"MGR\" > \"EMPNULLABLES0\".\"MGR\"","rewritten query":"SELECT \"t0\".\"DEPTNO\" FROM (SELECT * FROM \"EMPNULLABLES\" WHERE \"ENAME\" IS NOT NULL AND \"MGR\" IS NOT NULL) AS \"t0\" INNER JOIN (SELECT * FROM \"EMPNULLABLES\" WHERE \"ENAME\" IS NOT NULL AND \"MGR\" IS NOT NULL) AS \"t1\" ON \"t0\".\"ENAME\" = \"t1\".\"ENAME\" AND \"t0\".\"MGR\" > \"t1\".\"MGR\""},{"index":171,"rewrite rule":"testJoinDeriveIsNotNullFilterRule5","original query":"SELECT \"t0\".\"DEPTNO\" FROM (SELECT \"ENAME\", \"DEPTNO\" + 1 AS \"DEPTNO\" FROM \"EMPNULLABLES\" WHERE \"ENAME\" IS NOT NULL) AS \"t0\" INNER JOIN \"EMPNULLABLES\" AS \"EMPNULLABLES0\" ON \"t0\".\"ENAME\" = \"EMPNULLABLES0\".\"ENAME\"","rewritten query":"SELECT \"t3\".\"DEPTNO\" FROM (SELECT \"ENAME\", \"DEPTNO\" + 1 AS \"DEPTNO\" FROM \"EMPNULLABLES\" WHERE \"ENAME\" IS NOT NULL) AS \"t3\" INNER JOIN (SELECT * FROM \"EMPNULLABLES\" WHERE \"ENAME\" IS NOT NULL) AS \"t4\" ON \"t3\".\"ENAME\" = \"t4\".\"ENAME\""},{"index":172,"rewrite rule":"testSemiJoinRule","original query":"SELECT \"DEPT\".\"DEPTNO\", \"DEPT\".\"NAME\" FROM \"DEPT\" INNER JOIN (SELECT \"DEPTNO\" FROM (SELECT \"SAL\", \"DEPTNO\" FROM \"EMP\") AS \"t\" WHERE \"SAL\" > 100 GROUP BY \"DEPTNO\") AS \"t2\" ON \"DEPT\".\"DEPTNO\" = \"t2\".\"DEPTNO\"","rewritten query":"SELECT * FROM (SELECT * FROM \"DEPT\" WHERE EXISTS (SELECT 1 FROM (SELECT \"DEPTNO\" FROM \"EMP\" WHERE \"SAL\" > 100) AS \"t5\" WHERE * = \"t5\".\"DEPTNO\")) AS \"DEPT0\""},{"index":173,"rewrite rule":"testAggregateMerge1","original query":"SELECT \"C\", MIN(\"Y\"), MAX(\"Z\") AS \"Z\", SUM(\"R\"), SUM(\"M\") AS \"N\", SUM(\"X\") AS \"SAL\" FROM (SELECT \"DEPTNO\" AS \"C\", MIN(\"SAL\") AS \"Y\", MAX(\"SAL\") AS \"Z\", COUNT(\"MGR\") AS \"R\", COUNT(*) AS \"M\", SUM(\"SAL\") AS \"X\" FROM \"EMP\" GROUP BY \"DEPTNO\", \"ENAME\") AS \"t1\" GROUP BY \"C\"","rewritten query":"SELECT \"DEPTNO\", MIN(\"SAL\"), MAX(\"SAL\") AS \"Z\", COUNT(\"MGR\"), COUNT(*) AS \"N\", SUM(\"SAL\") AS \"SAL\" FROM \"EMP\" GROUP BY \"DEPTNO\""},{"index":174,"rewrite rule":"testAggregateMerge2","original query":"SELECT \"DEPTNO\", \"EMPNO\", SUM(\"X\"), SUM(\"Y\") FROM (SELECT \"DEPTNO\", \"EMPNO\", SUM(\"SAL\") AS \"X\", COUNT(\"MGR\") AS \"Y\" FROM \"EMP\" GROUP BY \"DEPTNO\", \"ENAME\", \"EMPNO\") AS \"t1\" GROUP BY GROUPING SETS(\"DEPTNO\", \"EMPNO\")","rewritten query":"SELECT \"DEPTNO\", \"EMPNO\", SUM(\"SAL\"), COUNT(\"MGR\") FROM \"EMP\" GROUP BY GROUPING SETS(\"EMPNO\", \"DEPTNO\")"},{"index":175,"rewrite rule":"testAggregateMerge8","original query":"SELECT SUM(\"X\") AS \"X\", MIN(\"Y\") AS \"Z\" FROM (SELECT SUM(\"SAL\") AS \"X\", MIN(\"SAL\") AS \"Y\" FROM \"EMP\") AS \"t0\"","rewritten query":"SELECT SUM(\"SAL\") AS \"X\", MIN(\"SAL\") AS \"Z\" FROM \"EMP\""},{"index":176,"rewrite rule":"testReduceConstantsDupNot2","original query":"SELECT \"DEPTNO\" FROM \"DEPT\" WHERE NOT (\"DEPTNO\" = 7 AND \"NAME\" = 'foo' AND \"DEPTNO\" = 8)","rewritten query":"SELECT \"DEPTNO\" FROM \"DEPT\""},{"index":177,"rewrite rule":"testReduceConstantsWindow","original query":"SELECT SUM(100) OVER (PARTITION BY \"DEPTNO\", \"SAL\" ORDER BY \"SAL\" RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS \"COL1\", SUM(100) OVER (PARTITION BY \"SAL\" ORDER BY \"DEPTNO\" RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS \"COL2\", SUM(\"SAL\") OVER (PARTITION BY \"DEPTNO\" ORDER BY \"SAL\" RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS \"COL3\" FROM \"EMP\" WHERE \"SAL\" = 5000","rewritten query":"SELECT SUM(100) OVER (PARTITION BY \"DEPTNO\" RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS \"$0\", SUM(100) OVER (ORDER BY \"DEPTNO\" RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS \"$1\", SUM(5000) OVER (PARTITION BY \"DEPTNO\" RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS \"$2\" FROM \"EMP\" WHERE \"SAL\" = 5000"},{"index":178,"rewrite rule":"testProjectFilterTransposeRuleOnEmptyRowType","original query":"SELECT FROM \"EMP\" WHERE \"DEPTNO\" = 20","rewritten query":"SELECT FROM (SELECT \"DEPTNO\" FROM \"EMP\") AS \"t1\" WHERE \"DEPTNO\" = 20"},{"index":179,"rewrite rule":"testReduceValuesToEmpty","original query":"SELECT \"A\" + \"B\" AS \"X\", \"B\", \"A\" FROM (VALUES (10, 1), (30, 7)) AS \"t\" (\"A\", \"B\") WHERE \"A\" - \"B\" < 0","rewritten query":"SELECT * FROM (VALUES (NULL, NULL, NULL)) AS \"t\" (\"X\", \"B\", \"A\") WHERE 1 = 0"},{"index":180,"rewrite rule":"testPushProjectPastFilter","original query":"SELECT \"EMPNO\" + \"DEPTNO\" FROM \"EMP\" WHERE \"SAL\" = 10 * \"COMM\" AND UPPER(\"ENAME\") = 'FOO'","rewritten query":"SELECT \"EMPNO\" + \"DEPTNO\" FROM (SELECT \"EMPNO\", \"ENAME\", \"SAL\", \"COMM\", \"DEPTNO\" FROM \"EMP\") AS \"t1\" WHERE \"SAL\" = 10 * \"COMM\" AND UPPER(\"ENAME\") = 'FOO'"},{"index":181,"rewrite rule":"testJoinProjectTransposeWindow","original query":"SELECT \"t\".\"DEPTNO\", \"t\".\"NAME\", \"t0\".\"R\", \"t0\".\"EXPR$1\" FROM (SELECT \"DEPTNO\", \"NAME\", CAST(\"NAME\" AS BIGINT) AS \"NAME0\" FROM \"DEPT\") AS \"t\" INNER JOIN (SELECT RANK() OVER (ORDER BY \"NAME\") AS \"R\", 1 + 1 AS \"EXPR$1\" FROM \"DEPT\") AS \"t0\" ON \"t\".\"NAME0\" = \"t0\".\"R\"","rewritten query":"SELECT \"DEPT1\".\"DEPTNO\", \"DEPT1\".\"NAME\", \"t2\".\"R\", \"t2\".\"EXPR$1\" FROM \"DEPT\" AS \"DEPT1\" INNER JOIN (SELECT RANK() OVER (ORDER BY \"NAME\") AS \"R\", 1 + 1 AS \"EXPR$1\" FROM \"DEPT\") AS \"t2\" ON \"DEPT1\".\"NAME\" = \"t2\".\"R\""},{"index":182,"rewrite rule":"testAggregateUnionTransposeWithOneInputUnique","original query":"SELECT \"DEPTNO\", SUM(\"T\") FROM (SELECT \"DEPTNO\", 1 AS \"T\" FROM \"EMP\" UNION ALL SELECT \"EMP0\".\"DEPTNO\", \"t0\".\"T\" FROM \"EMP\" AS \"EMP0\", (VALUES (2)) AS \"t0\" (\"T\") GROUP BY \"EMP0\".\"DEPTNO\", \"t0\".\"T\") AS \"t3\" GROUP BY \"DEPTNO\"","rewritten query":"SELECT \"DEPTNO\", SUM(\"EXPR$1\") FROM (SELECT \"DEPTNO\", SUM(1) AS \"EXPR$1\" FROM \"EMP\" GROUP BY \"DEPTNO\" UNION ALL SELECT \"t9\".\"DEPTNO\", SUM(\"t9\".\"T\") AS \"EXPR$1\" FROM (SELECT \"EMP2\".\"DEPTNO\", \"t7\".\"T\" FROM \"EMP\" AS \"EMP2\", (VALUES (2)) AS \"t7\" (\"T\") GROUP BY \"EMP2\".\"DEPTNO\", \"t7\".\"T\") AS \"t9\" GROUP BY \"t9\".\"DEPTNO\") AS \"t11\" GROUP BY \"DEPTNO\""},{"index":183,"rewrite rule":"testDistinctNonDistinctTwoAggregatesWithGrouping","original query":"SELECT \"DEPTNO\", SUM(\"COMM\"), MIN(\"COMM\"), SUM(DISTINCT \"SAL\") FROM \"EMP\" GROUP BY \"DEPTNO\"","rewritten query":"SELECT \"DEPTNO\", SUM(\"EXPR$1\"), MIN(\"EXPR$2\"), SUM(\"SAL\") FROM (SELECT \"DEPTNO\", \"SAL\", SUM(\"COMM\") AS \"EXPR$1\", MIN(\"COMM\") AS \"EXPR$2\" FROM \"EMP\" GROUP BY \"DEPTNO\", \"SAL\") AS \"t2\" GROUP BY \"DEPTNO\""},{"index":184,"rewrite rule":"testAggregateGroupingSetsProjectMerge","original query":"SELECT \"DEPTNO\" AS \"X\", SUM(\"SAL\"), \"EMPNO\" AS \"Y\" FROM \"EMP\" GROUP BY ROLLUP(\"DEPTNO\", \"EMPNO\")","rewritten query":"SELECT \"DEPTNO\" AS \"X\", SUM(\"SAL\"), \"EMPNO\" AS \"Y\" FROM \"EMP\" GROUP BY ROLLUP(\"EMPNO\", \"DEPTNO\")"},{"index":185,"rewrite rule":"testReduceConstantsDupNotNull","original query":"SELECT \"EMPNO\" FROM \"EMP\" WHERE NOT (\"MGR\" = 7 AND \"MGR\" = 8)","rewritten query":"SELECT \"EMPNO\" FROM \"EMP\" WHERE \"MGR\" IS NOT NULL"},{"index":186,"rewrite rule":"testAggregateMergeSum0","original query":"SELECT CASE WHEN SUM(\"COUNT_COMM\") IS NOT NULL THEN CAST(SUM(\"COUNT_COMM\") AS BIGINT) ELSE 0 END FROM (SELECT COUNT(*) AS \"COUNT_COMM\" FROM \"EMP\" GROUP BY \"DEPTNO\", \"MGR\") AS \"t1\"","rewritten query":"SELECT COUNT(*) AS \"$f0\" FROM \"EMP\""},{"index":187,"rewrite rule":"testWindowFunctionOnAggregations","original query":"SELECT \"EXPR$0\", \"EXPR$1\", SUM(\"EXPR$1\") OVER (PARTITION BY \"EXPR$0\" ORDER BY \"EXPR$1\" RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) FROM (SELECT \"DEPTNO\", MIN(\"EMPNO\") AS \"EXPR$0\", SUM(\"SAL\") AS \"EXPR$1\" FROM \"EMP\" GROUP BY \"DEPTNO\") AS \"t0\"","rewritten query":"SELECT MIN(\"EMPNO\"), SUM(\"SAL\"), SUM(SUM(\"SAL\")) OVER (PARTITION BY MIN(\"EMPNO\") ORDER BY SUM(\"SAL\") RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS \"$2\" FROM \"EMP\" GROUP BY \"DEPTNO\""},{"index":188,"rewrite rule":"testPushFilterThroughSemiJoin","original query":"SELECT * FROM (SELECT \"DEPT\".\"DEPTNO\", \"DEPT\".\"NAME\" FROM \"DEPT\" INNER JOIN (SELECT \"DEPTNO\" FROM \"EMP\" GROUP BY \"DEPTNO\") AS \"t0\" ON \"DEPT\".\"DEPTNO\" = \"t0\".\"DEPTNO\") AS \"t1\" WHERE \"t1\".\"DEPTNO\" <= 10","rewritten query":"SELECT * FROM (SELECT * FROM \"DEPT\" WHERE \"DEPTNO\" <= 10 AND EXISTS (SELECT 1 FROM (SELECT \"DEPTNO\" FROM \"EMP\") AS \"t5\" WHERE * = \"t5\".\"DEPTNO\")) AS \"t4\""},{"index":189,"rewrite rule":"testPushAggregateThroughOuterJoin12","original query":"SELECT \"t0\".\"JOB\" FROM (SELECT * FROM \"EMP\" WHERE \"ENAME\" = 'A') AS \"t0\" RIGHT JOIN \"DEPT\" ON \"t0\".\"JOB\" = \"DEPT\".\"NAME\" GROUP BY \"t0\".\"JOB\"","rewritten query":"SELECT \"t5\".\"JOB\" FROM (SELECT \"JOB\" FROM \"EMP\" WHERE \"ENAME\" = 'A' GROUP BY \"JOB\") AS \"t5\" RIGHT JOIN (SELECT \"NAME\" FROM \"DEPT\" GROUP BY \"NAME\") AS \"t6\" ON \"t5\".\"JOB\" = \"t6\".\"NAME\" GROUP BY \"t5\".\"JOB\""},{"index":190,"rewrite rule":"testPushAggregateThroughOuterJoin13","original query":"SELECT \"t0\".\"JOB\" FROM (SELECT * FROM \"EMP\" WHERE \"ENAME\" = 'A') AS \"t0\" FULL JOIN \"DEPT\" ON \"t0\".\"JOB\" = \"DEPT\".\"NAME\" GROUP BY \"t0\".\"JOB\"","rewritten query":"SELECT \"t5\".\"JOB\" FROM (SELECT \"JOB\" FROM \"EMP\" WHERE \"ENAME\" = 'A' GROUP BY \"JOB\") AS \"t5\" FULL JOIN (SELECT \"NAME\" FROM \"DEPT\" GROUP BY \"NAME\") AS \"t6\" ON \"t5\".\"JOB\" = \"t6\".\"NAME\" GROUP BY \"t5\".\"JOB\""},{"index":191,"rewrite rule":"testPushAggregateThroughOuterJoin14","original query":"SELECT \"EMP\".\"MGR\", \"EMP0\".\"MGR\" AS \"MGR0\" FROM \"EMP\" FULL JOIN \"EMP\" AS \"EMP0\" ON \"EMP\".\"MGR\" = \"EMP0\".\"MGR\" GROUP BY \"EMP0\".\"MGR\", \"EMP\".\"MGR\"","rewritten query":"SELECT \"t2\".\"MGR\", \"t3\".\"MGR\" AS \"MGR0\" FROM (SELECT \"MGR\" FROM \"EMP\" GROUP BY \"MGR\") AS \"t2\" FULL JOIN (SELECT \"MGR\" FROM \"EMP\" GROUP BY \"MGR\") AS \"t3\" ON \"t2\".\"MGR\" = \"t3\".\"MGR\" GROUP BY \"t2\".\"MGR\", \"t3\".\"MGR\""},{"index":192,"rewrite rule":"testPushAggregateThroughOuterJoin15","original query":"SELECT \"t0\".\"ENAME\", \"EMP0\".\"MGR\" FROM (SELECT * FROM \"EMP\" WHERE \"ENAME\" = 'A') AS \"t0\" FULL JOIN \"EMP\" AS \"EMP0\" ON \"t0\".\"JOB\" = \"EMP0\".\"JOB\" GROUP BY \"t0\".\"ENAME\", \"EMP0\".\"MGR\"","rewritten query":"SELECT \"t5\".\"ENAME\", \"t6\".\"MGR\" FROM (SELECT \"ENAME\", \"JOB\" FROM \"EMP\" WHERE \"ENAME\" = 'A' GROUP BY \"ENAME\", \"JOB\") AS \"t5\" FULL JOIN (SELECT \"JOB\", \"MGR\" FROM \"EMP\" GROUP BY \"JOB\", \"MGR\") AS \"t6\" ON \"t5\".\"JOB\" = \"t6\".\"JOB\" GROUP BY \"t5\".\"ENAME\", \"t6\".\"MGR\""},{"index":193,"rewrite rule":"testPushAggregateThroughOuterJoin16","original query":"SELECT \"t0\".\"JOB\" FROM (SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\", \"DEPTNO\" + \"EMPNO\" AS \"$f9\" FROM \"EMP\" WHERE \"ENAME\" = 'A') AS \"t0\" FULL JOIN (SELECT \"DEPTNO\", \"NAME\", \"DEPTNO\" + 5 AS \"$f2\" FROM \"DEPT\") AS \"t1\" ON \"t0\".\"JOB\" = \"t1\".\"NAME\" AND \"t0\".\"$f9\" = \"t1\".\"$f2\" GROUP BY \"t0\".\"JOB\"","rewritten query":"SELECT \"t6\".\"JOB\" FROM (SELECT \"JOB\", \"DEPTNO\" + \"EMPNO\" AS \"$f9\" FROM \"EMP\" WHERE \"ENAME\" = 'A' GROUP BY \"JOB\", \"DEPTNO\" + \"EMPNO\") AS \"t6\" FULL JOIN (SELECT \"NAME\", \"DEPTNO\" + 5 AS \"$f2\" FROM \"DEPT\" GROUP BY \"NAME\", \"DEPTNO\" + 5) AS \"t8\" ON \"t6\".\"JOB\" = \"t8\".\"NAME\" AND \"t6\".\"$f9\" = \"t8\".\"$f2\" GROUP BY \"t6\".\"JOB\""},{"index":194,"rewrite rule":"testWhereInJoinCorrelated","original query":"SELECT \"EMP\".\"EMPNO\" FROM \"EMP\" INNER JOIN \"DEPT\" ON \"EMP\".\"DEPTNO\" = \"DEPT\".\"DEPTNO\" WHERE \"EMP\".\"SAL\" IN (SELECT \"SAL\" FROM \"EMP\" WHERE \"DEPTNO\" > \"EMP\".\"DEPTNO\")","rewritten query":"SELECT \"$cor0\".\"EMPNO\" FROM (\"EMP\" AS \"EMP1\" INNER JOIN \"DEPT\" AS \"DEPT0\" ON \"EMP1\".\"DEPTNO\" = \"DEPT0\".\"DEPTNO\") AS \"$cor0\", LATERAL (SELECT \"SAL\" FROM \"EMP\" WHERE \"DEPTNO\" > \"$cor0\".\"DEPTNO\" GROUP BY \"SAL\") AS \"t5\" WHERE \"$cor0\".\"SAL\" = \"$cor0\".\"SAL0\""},{"index":195,"rewrite rule":"testDistinctCountMultipleViaJoin","original query":"SELECT \"DEPTNO\", COUNT(DISTINCT \"ENAME\"), COUNT(DISTINCT \"JOB\", \"ENAME\"), COUNT(DISTINCT \"DEPTNO\", \"JOB\"), SUM(\"SAL\") FROM \"EMP\" GROUP BY \"DEPTNO\"","rewritten query":"SELECT \"t1\".\"DEPTNO\", \"t3\".\"EXPR$1\", \"t5\".\"EXPR$2\", \"t7\".\"EXPR$3\", \"t1\".\"EXPR$4\" FROM (SELECT \"DEPTNO\", SUM(\"SAL\") AS \"EXPR$4\" FROM \"EMP\" GROUP BY \"DEPTNO\") AS \"t1\" INNER JOIN (SELECT \"DEPTNO\", COUNT(\"ENAME\") AS \"EXPR$1\" FROM (SELECT \"ENAME\", \"DEPTNO\" FROM \"EMP\" GROUP BY \"ENAME\", \"DEPTNO\") AS \"t2\" GROUP BY \"DEPTNO\") AS \"t3\" ON \"t1\".\"DEPTNO\" IS NOT DISTINCT FROM \"t3\".\"DEPTNO\" INNER JOIN (SELECT \"DEPTNO\", COUNT(\"JOB\", \"ENAME\") AS \"EXPR$2\" FROM (SELECT \"ENAME\", \"JOB\", \"DEPTNO\" FROM \"EMP\" GROUP BY \"ENAME\", \"JOB\", \"DEPTNO\") AS \"t4\" GROUP BY \"DEPTNO\") AS \"t5\" ON \"t1\".\"DEPTNO\" IS NOT DISTINCT FROM \"t5\".\"DEPTNO\" INNER JOIN (SELECT \"DEPTNO\", COUNT(\"DEPTNO\", \"JOB\") AS \"EXPR$3\" FROM (SELECT \"JOB\", \"DEPTNO\" FROM \"EMP\" GROUP BY \"JOB\", \"DEPTNO\") AS \"t6\" GROUP BY \"DEPTNO\") AS \"t7\" ON \"t1\".\"DEPTNO\" IS NOT DISTINCT FROM \"t7\".\"DEPTNO\""},{"index":196,"rewrite rule":"testPushMinThroughUnion","original query":"SELECT \"ENAME\", MIN(\"EMPNO\") FROM (SELECT * FROM \"EMP\" UNION ALL SELECT * FROM \"EMP\") AS \"t1\" GROUP BY \"ENAME\"","rewritten query":"SELECT \"ENAME\", MIN(\"EXPR$1\") FROM (SELECT \"ENAME\", MIN(\"EMPNO\") AS \"EXPR$1\" FROM \"EMP\" GROUP BY \"ENAME\" UNION ALL SELECT \"ENAME\", MIN(\"EMPNO\") AS \"EXPR$1\" FROM \"EMP\" GROUP BY \"ENAME\") AS \"t8\" GROUP BY \"ENAME\""},{"index":197,"rewrite rule":"testPushSumConstantGroupingSetsThroughUnion","original query":"SELECT \"DEPTNO\", \"JOB\", SUM(\"U\") FROM (SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\", 2 AS \"U\" FROM \"EMP\" UNION ALL SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\", 3 AS \"U\" FROM \"EMP\") AS \"t1\" GROUP BY ROLLUP(\"DEPTNO\", \"JOB\")","rewritten query":"SELECT \"DEPTNO\", \"JOB\", SUM(\"EXPR$2\") FROM (SELECT \"DEPTNO\", \"JOB\", SUM(2) AS \"EXPR$2\" FROM \"EMP\" GROUP BY \"DEPTNO\", \"JOB\" UNION ALL SELECT \"DEPTNO\", \"JOB\", SUM(3) AS \"EXPR$2\" FROM \"EMP\" GROUP BY \"DEPTNO\", \"JOB\") AS \"t8\" GROUP BY ROLLUP(\"DEPTNO\", \"JOB\")"},{"index":198,"rewrite rule":"testPushFilterPastAggWithGroupingSets2","original query":"SELECT \"NAME\" AS \"NAME\", \"DEPTNO\" AS \"DDEPTNO\", COUNT(*) AS \"C\" FROM \"DEPT\" GROUP BY GROUPING SETS((\"NAME\", \"DEPTNO\"), \"NAME\") HAVING \"NAME\" = 'Charlie'","rewritten query":"SELECT \"NAME\", \"DDEPTNO\", COUNT(*) AS \"C\" FROM (SELECT \"NAME\" AS \"NAME\", \"DEPTNO\" AS \"DDEPTNO\" FROM \"DEPT\") AS \"t3\" WHERE \"NAME\" = 'Charlie' GROUP BY GROUPING SETS((\"NAME\", \"DDEPTNO\"), \"NAME\")"},{"index":199,"rewrite rule":"testTransitiveInferenceUnion3way","original query":"SELECT 1 FROM (SELECT * FROM (SELECT \"DEPTNO\" FROM \"EMP\" WHERE \"DEPTNO\" > 7 UNION ALL SELECT \"DEPTNO\" FROM \"EMP\" WHERE \"DEPTNO\" > 10) AS \"t\" UNION ALL SELECT \"DEPTNO\" FROM \"EMP\" WHERE \"DEPTNO\" > 1) AS \"t6\" INNER JOIN \"EMP\" AS \"EMP2\" ON \"t6\".\"DEPTNO\" = \"EMP2\".\"DEPTNO\"","rewritten query":"SELECT 1 FROM (SELECT * FROM (SELECT \"DEPTNO\" FROM \"EMP\" WHERE \"DEPTNO\" > 7 UNION ALL SELECT \"DEPTNO\" FROM \"EMP\" WHERE \"DEPTNO\" > 10) AS \"t\" UNION ALL SELECT \"DEPTNO\" FROM \"EMP\" WHERE \"DEPTNO\" > 1) AS \"t15\" INNER JOIN (SELECT * FROM \"EMP\" WHERE \"DEPTNO\" > 1) AS \"t16\" ON \"t15\".\"DEPTNO\" = \"t16\".\"DEPTNO\""},{"index":200,"rewrite rule":"testReduceNullableToNotNull2","original query":"SELECT \"EMPNO\" + CASE WHEN 'a' = 'a' THEN 1 ELSE NULL END AS \"NEWCOL\" FROM \"EMP\"","rewritten query":"SELECT \"EMPNO\" + 1 AS \"NEWCOL\" FROM \"EMP\""},{"index":201,"rewrite rule":"testCastInAggregateReduceFunctions","original query":"SELECT \"NAME\", STDDEV_POP(\"DEPTNO\"), AVG(\"DEPTNO\"), STDDEV_SAMP(\"DEPTNO\"), VAR_POP(\"DEPTNO\"), VAR_SAMP(\"DEPTNO\") FROM \"DEPT\" GROUP BY \"NAME\"","rewritten query":"SELECT \"NAME\", CAST(POWER((COALESCE(SUM(\"DEPTNO\" * \"DEPTNO\"), 0) - COALESCE(SUM(\"DEPTNO\"), 0) * COALESCE(SUM(\"DEPTNO\"), 0) \/ COUNT(*)) \/ COUNT(*), 0.5) AS INTEGER), CAST(COALESCE(SUM(\"DEPTNO\"), 0) \/ COUNT(*) AS INTEGER), CAST(POWER((COALESCE(SUM(\"DEPTNO\" * \"DEPTNO\"), 0) - COALESCE(SUM(\"DEPTNO\"), 0) * COALESCE(SUM(\"DEPTNO\"), 0) \/ COUNT(*)) \/ CASE WHEN COUNT(*) = 1 THEN NULL ELSE COUNT(*) - 1 END, 0.5) AS INTEGER), CAST((COALESCE(SUM(\"DEPTNO\" * \"DEPTNO\"), 0) - COALESCE(SUM(\"DEPTNO\"), 0) * COALESCE(SUM(\"DEPTNO\"), 0) \/ COUNT(*)) \/ COUNT(*) AS INTEGER), CAST((COALESCE(SUM(\"DEPTNO\" * \"DEPTNO\"), 0) - COALESCE(SUM(\"DEPTNO\"), 0) * COALESCE(SUM(\"DEPTNO\"), 0) \/ COUNT(*)) \/ CASE WHEN COUNT(*) = 1 THEN NULL ELSE COUNT(*) - 1 END AS INTEGER) FROM \"DEPT\" GROUP BY \"NAME\""},{"index":202,"rewrite rule":"testLeftEmptyInnerJoin","original query":"SELECT * FROM (SELECT * FROM \"EMP\" WHERE FALSE) AS \"t0\" INNER JOIN \"DEPT\" ON \"t0\".\"DEPTNO\" = \"DEPT\".\"DEPTNO\"","rewritten query":"SELECT * FROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\", \"DEPTNO0\", \"NAME\") WHERE 1 = 0"},{"index":203,"rewrite rule":"testPullConstantThroughConstLast","original query":"SELECT \"EMP\".\"DEPTNO\", MAX(\"EMP\".\"MGR\") FROM \"EMP\", (VALUES (4)) AS \"t\" (\"FOUR\") GROUP BY \"EMP\".\"DEPTNO\", \"t\".\"FOUR\"","rewritten query":"SELECT \"DEPTNO\", MAX(\"MGR\") FROM \"EMP\" GROUP BY \"DEPTNO\""},{"index":204,"rewrite rule":"testIntersectToDistinctAll","original query":"SELECT * FROM (SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 10 INTERSECT SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 20) AS \"t\" INTERSECT ALL SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 30","rewritten query":"SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\" FROM (SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\", COUNT(*) AS \"$f9\" FROM \"EMP\" WHERE \"DEPTNO\" = 10 GROUP BY \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\" UNION ALL SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\", COUNT(*) AS \"$f9\" FROM \"EMP\" WHERE \"DEPTNO\" = 20 GROUP BY \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\") AS \"t13\" GROUP BY \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\" HAVING COUNT(*) = 2 INTERSECT ALL SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 30"},{"index":205,"rewrite rule":"testTransitiveInferenceLeftOuterJoin","original query":"SELECT 1 FROM \"EMP\" LEFT JOIN \"EMP\" AS \"EMP0\" ON \"EMP\".\"DEPTNO\" = \"EMP0\".\"DEPTNO\" WHERE \"EMP\".\"DEPTNO\" > 7 AND \"EMP0\".\"DEPTNO\" > 9","rewritten query":"SELECT 1 FROM (SELECT * FROM \"EMP\" WHERE \"DEPTNO\" > 7) AS \"t1\" LEFT JOIN (SELECT * FROM \"EMP\" WHERE \"DEPTNO\" > 7) AS \"t2\" ON \"t1\".\"DEPTNO\" = \"t2\".\"DEPTNO\" WHERE \"t2\".\"DEPTNO\" > 9"},{"index":206,"rewrite rule":"testPushMaxNullableGroupingSetsThroughUnion","original query":"SELECT \"DEPTNO\", \"JOB\", MAX(\"MGR\") FROM (SELECT * FROM \"EMP\" UNION ALL SELECT * FROM \"EMP\") AS \"t1\" GROUP BY ROLLUP(\"DEPTNO\", \"JOB\")","rewritten query":"SELECT \"DEPTNO\", \"JOB\", MAX(\"EXPR$2\") FROM (SELECT \"DEPTNO\", \"JOB\", MAX(\"MGR\") AS \"EXPR$2\" FROM \"EMP\" GROUP BY \"DEPTNO\", \"JOB\" UNION ALL SELECT \"DEPTNO\", \"JOB\", MAX(\"MGR\") AS \"EXPR$2\" FROM \"EMP\" GROUP BY \"DEPTNO\", \"JOB\") AS \"t8\" GROUP BY ROLLUP(\"DEPTNO\", \"JOB\")"},{"index":207,"rewrite rule":"testReduceConstants3","original query":"SELECT \"EMP\".\"MGR\" IS NULL AND \"EMP0\".\"MGR\" IS NULL OR \"EMP\".\"MGR\" = \"EMP0\".\"MGR\" IS TRUE FROM \"EMP\" INNER JOIN \"EMP\" AS \"EMP0\" ON \"EMP\".\"MGR\" = \"EMP0\".\"MGR\" WHERE \"EMP\".\"MGR\" IS NULL","rewritten query":"SELECT \"EMP2\".\"MGR\" IS NULL FROM \"EMP\" AS \"EMP1\" INNER JOIN \"EMP\" AS \"EMP2\" ON \"EMP1\".\"MGR\" = \"EMP2\".\"MGR\" WHERE \"EMP1\".\"MGR\" IS NULL"},{"index":208,"rewrite rule":"testPushJoinThroughUnionOnRight","original query":"SELECT \"EMP\".\"SAL\" FROM \"EMP\", (SELECT * FROM \"EMP\" UNION ALL SELECT * FROM \"EMP\") AS \"t1\"","rewritten query":"SELECT \"SAL\" FROM (SELECT * FROM \"EMP\" AS \"EMP2\", (SELECT * FROM \"EMP\") AS \"t3\" UNION ALL SELECT * FROM \"EMP\" AS \"EMP4\", (SELECT * FROM \"EMP\") AS \"t4\") AS \"t5\""},{"index":209,"rewrite rule":"testFullOuterJoinSimplificationToInner","original query":"SELECT 1 FROM \"DEPT\" FULL JOIN \"EMP\" ON \"DEPT\".\"DEPTNO\" = \"EMP\".\"DEPTNO\" WHERE \"DEPT\".\"NAME\" = 'Charlie' AND \"EMP\".\"SAL\" > 100","rewritten query":"SELECT 1 FROM (SELECT * FROM \"DEPT\" WHERE \"NAME\" = 'Charlie') AS \"t1\" INNER JOIN (SELECT * FROM \"EMP\" WHERE \"SAL\" > 100) AS \"t2\" ON \"t1\".\"DEPTNO\" = \"t2\".\"DEPTNO\""},{"index":210,"rewrite rule":"testPushAggregateThroughJoinWithUniqueInput","original query":"SELECT \"EMP\".\"JOB\", \"t0\".\"MGR\", \"EMP\".\"DEPTNO\", MAX(\"t0\".\"HIREDATE1\") AS \"HIREDATE1\", SUM(\"t0\".\"COMM1\") AS \"COMM1\" FROM \"EMP\" INNER JOIN (SELECT \"MGR\", \"SAL\", MAX(\"HIREDATE\") AS \"HIREDATE1\", SUM(\"COMM\") AS \"COMM1\" FROM \"EMP\" GROUP BY \"MGR\", \"SAL\") AS \"t0\" ON \"EMP\".\"SAL\" = \"t0\".\"SAL\" GROUP BY \"EMP\".\"JOB\", \"t0\".\"MGR\", \"EMP\".\"DEPTNO\"","rewritten query":"SELECT \"t3\".\"JOB\", \"t4\".\"MGR\" AS \"MGR0\", \"t3\".\"DEPTNO\", MAX(\"t4\".\"HIREDATE1\") AS \"HIREDATE1\", SUM(CAST(\"t3\".\"$f3\" * \"t4\".\"COMM1\" AS INTEGER)) AS \"COMM1\" FROM (SELECT \"JOB\", \"SAL\", \"DEPTNO\", COUNT(*) AS \"$f3\" FROM \"EMP\" GROUP BY \"JOB\", \"SAL\", \"DEPTNO\") AS \"t3\" INNER JOIN (SELECT \"MGR\", \"SAL\", MAX(\"HIREDATE\") AS \"HIREDATE1\", SUM(\"COMM\") AS \"COMM1\" FROM \"EMP\" GROUP BY \"MGR\", \"SAL\") AS \"t4\" ON \"t3\".\"SAL\" = \"t4\".\"SAL\" GROUP BY \"t3\".\"JOB\", \"t3\".\"DEPTNO\", \"t4\".\"MGR\""},{"index":211,"rewrite rule":"testPushAvgGroupingSetsThroughUnion","original query":"SELECT \"DEPTNO\", \"JOB\", AVG(\"EMPNO\") FROM (SELECT * FROM \"EMP\" UNION ALL SELECT * FROM \"EMP\") AS \"t1\" GROUP BY ROLLUP(\"DEPTNO\", \"JOB\")","rewritten query":"SELECT \"DEPTNO\", \"JOB\", AVG(\"EMPNO\") FROM (SELECT \"DEPTNO\", \"JOB\", \"EMPNO\" FROM \"EMP\" UNION ALL SELECT \"DEPTNO\", \"JOB\", \"EMPNO\" FROM \"EMP\") AS \"t6\" GROUP BY ROLLUP(\"DEPTNO\", \"JOB\")"},{"index":212,"rewrite rule":"testReduceOrCaseWhen","original query":"SELECT \"SAL\" FROM \"EMP\" WHERE CASE WHEN \"SAL\" = 1000 THEN NULL ELSE 1 END IS NULL OR CASE WHEN \"SAL\" = 2000 THEN NULL ELSE 1 END IS NULL","rewritten query":"SELECT \"SAL\" FROM \"EMP\" WHERE \"SAL\" IN (1000, 2000)"},{"index":213,"rewrite rule":"testPushAboveFiltersIntoInnerJoinCondition","original query":"SELECT * FROM \"DEPT\" INNER JOIN \"EMP\" ON \"DEPT\".\"DEPTNO\" = \"EMP\".\"DEPTNO\" AND \"DEPT\".\"DEPTNO\" > \"EMP\".\"MGR\" WHERE \"DEPT\".\"DEPTNO\" > \"EMP\".\"MGR\"","rewritten query":"SELECT * FROM \"DEPT\" AS \"DEPT0\" INNER JOIN \"EMP\" AS \"EMP0\" ON \"DEPT0\".\"DEPTNO\" = \"EMP0\".\"DEPTNO\" AND \"DEPT0\".\"DEPTNO\" > \"EMP0\".\"MGR\""},{"index":214,"rewrite rule":"testBitOrReuseDistinctAttrWithMixedOptionality","original query":"SELECT SUM(DISTINCT \"DEPTNO\"), COUNT(DISTINCT \"DEPTNO\"), BIT_OR(\"DEPTNO\") FROM \"EMP\"","rewritten query":"SELECT SUM(\"DEPTNO\"), COUNT(\"DEPTNO\"), BIT_OR(\"DEPTNO\") FROM (SELECT \"DEPTNO\" FROM \"EMP\" GROUP BY \"DEPTNO\") AS \"t2\""},{"index":215,"rewrite rule":"testExistsWithAtLeastOneRowSubQuery","original query":"SELECT * FROM \"DEPT\" WHERE EXISTS (SELECT COUNT(*) FROM \"EMP\" WHERE \"DEPT\".\"DEPTNO\" = \"DEPTNO\")","rewritten query":"SELECT * FROM \"DEPT\""},{"index":217,"rewrite rule":"testMergeJoinCollation","original query":"SELECT \"EMP\".\"ENAME\", \"BONUS\".\"SAL\" FROM \"EMP\" INNER JOIN \"BONUS\" ON \"EMP\".\"ENAME\" = \"BONUS\".\"ENAME\" WHERE \"EMP\".\"SAL\" + 1 = \"BONUS\".\"SAL\"","rewritten query":"SELECT \"EMP0\".\"ENAME\", \"BONUS0\".\"SAL\" FROM \"BONUS\" AS \"BONUS0\" INNER JOIN \"EMP\" AS \"EMP0\" ON \"BONUS0\".\"ENAME\" = \"EMP0\".\"ENAME\" AND \"EMP0\".\"SAL\" + 1 = \"BONUS0\".\"SAL\""},{"index":218,"rewrite rule":"testReduceAverage","original query":"SELECT \"NAME\", MAX(\"NAME\"), AVG(\"DEPTNO\"), MIN(\"NAME\") FROM \"DEPT\" GROUP BY \"NAME\"","rewritten query":"SELECT \"NAME\", \"NAME\", CAST(COALESCE(SUM(\"DEPTNO\"), 0) \/ COUNT(*) AS INTEGER), \"NAME\" FROM \"DEPT\" GROUP BY \"NAME\""},{"index":219,"rewrite rule":"testGroupByBooleanLiteralSimple","original query":"SELECT AVG(\"EMP\".\"SAL\") FROM \"EMP\", (VALUES (TRUE)) AS \"t\" (\"$f0\") GROUP BY \"t\".\"$f0\"","rewritten query":"SELECT AVG(\"EMP0\".\"SAL\") FROM \"EMP\" AS \"EMP0\", (VALUES (TRUE)) AS \"t3\" (\"$f0\") GROUP BY \"t3\".\"$f0\""},{"index":220,"rewrite rule":"testAggregateJoinRemove1","original query":"SELECT \"EMP\".\"DEPTNO\" FROM \"EMP\" LEFT JOIN \"DEPT\" ON \"EMP\".\"DEPTNO\" = \"DEPT\".\"DEPTNO\" GROUP BY \"EMP\".\"DEPTNO\"","rewritten query":"SELECT \"DEPTNO\" FROM \"EMP\" GROUP BY \"DEPTNO\""},{"index":221,"rewrite rule":"testAggregateJoinRemove2","original query":"SELECT \"EMP\".\"DEPTNO\", COUNT(DISTINCT \"EMP\".\"JOB\") FROM \"EMP\" LEFT JOIN \"DEPT\" ON \"EMP\".\"DEPTNO\" = \"DEPT\".\"DEPTNO\" GROUP BY \"EMP\".\"DEPTNO\"","rewritten query":"SELECT \"DEPTNO\", COUNT(DISTINCT \"JOB\") FROM \"EMP\" GROUP BY \"DEPTNO\""},{"index":222,"rewrite rule":"testAggregateJoinRemove3","original query":"SELECT \"EMP\".\"DEPTNO\", COUNT(DISTINCT \"DEPT\".\"NAME\") FROM \"EMP\" LEFT JOIN \"DEPT\" ON \"EMP\".\"DEPTNO\" = \"DEPT\".\"DEPTNO\" GROUP BY \"EMP\".\"DEPTNO\"","rewritten query":"SELECT \"EMP0\".\"DEPTNO\", COUNT(DISTINCT \"DEPT0\".\"NAME\") FROM \"EMP\" AS \"EMP0\" LEFT JOIN \"DEPT\" AS \"DEPT0\" ON \"EMP0\".\"DEPTNO\" = \"DEPT0\".\"DEPTNO\" GROUP BY \"EMP0\".\"DEPTNO\""},{"index":223,"rewrite rule":"testAggregateJoinRemove4","original query":"SELECT \"DEPT\".\"DEPTNO\" FROM \"EMP\" RIGHT JOIN \"DEPT\" ON \"EMP\".\"DEPTNO\" = \"DEPT\".\"DEPTNO\" GROUP BY \"DEPT\".\"DEPTNO\"","rewritten query":"SELECT \"DEPTNO\" FROM \"DEPT\""},{"index":224,"rewrite rule":"testAggregateJoinRemove5","original query":"SELECT \"DEPT\".\"DEPTNO\", COUNT(DISTINCT \"DEPT\".\"NAME\") FROM \"EMP\" RIGHT JOIN \"DEPT\" ON \"EMP\".\"DEPTNO\" = \"DEPT\".\"DEPTNO\" GROUP BY \"DEPT\".\"DEPTNO\"","rewritten query":"SELECT \"DEPTNO\", COUNT(DISTINCT \"NAME\") FROM \"DEPT\" GROUP BY \"DEPTNO\""},{"index":225,"rewrite rule":"testAggregateJoinRemove6","original query":"SELECT \"DEPT\".\"DEPTNO\", COUNT(DISTINCT \"EMP\".\"JOB\") FROM \"EMP\" RIGHT JOIN \"DEPT\" ON \"EMP\".\"DEPTNO\" = \"DEPT\".\"DEPTNO\" GROUP BY \"DEPT\".\"DEPTNO\"","rewritten query":"SELECT \"DEPT0\".\"DEPTNO\" AS \"DEPTNO0\", COUNT(DISTINCT \"EMP0\".\"JOB\") FROM \"EMP\" AS \"EMP0\" RIGHT JOIN \"DEPT\" AS \"DEPT0\" ON \"EMP0\".\"DEPTNO\" = \"DEPT0\".\"DEPTNO\" GROUP BY \"DEPT0\".\"DEPTNO\""},{"index":226,"rewrite rule":"testAggregateJoinRemove7","original query":"SELECT \"EMP\".\"DEPTNO\" FROM \"EMP\" LEFT JOIN \"DEPT\" ON \"EMP\".\"DEPTNO\" = \"DEPT\".\"DEPTNO\" LEFT JOIN \"DEPT\" AS \"DEPT0\" ON \"EMP\".\"DEPTNO\" = \"DEPT0\".\"DEPTNO\" GROUP BY \"EMP\".\"DEPTNO\"","rewritten query":"SELECT \"EMP0\".\"DEPTNO\" FROM \"EMP\" AS \"EMP0\" LEFT JOIN \"DEPT\" AS \"DEPT1\" ON \"EMP0\".\"DEPTNO\" = \"DEPT1\".\"DEPTNO\" GROUP BY \"EMP0\".\"DEPTNO\""},{"index":227,"rewrite rule":"testAggregateJoinRemove8","original query":"SELECT \"EMP\".\"DEPTNO\", COUNT(DISTINCT \"DEPT0\".\"NAME\") FROM \"EMP\" LEFT JOIN \"DEPT\" ON \"EMP\".\"DEPTNO\" = \"DEPT\".\"DEPTNO\" LEFT JOIN \"DEPT\" AS \"DEPT0\" ON \"EMP\".\"DEPTNO\" = \"DEPT0\".\"DEPTNO\" GROUP BY \"EMP\".\"DEPTNO\"","rewritten query":"SELECT \"EMP0\".\"DEPTNO\", COUNT(DISTINCT \"DEPT1\".\"NAME\") FROM \"EMP\" AS \"EMP0\" LEFT JOIN \"DEPT\" AS \"DEPT1\" ON \"EMP0\".\"DEPTNO\" = \"DEPT1\".\"DEPTNO\" GROUP BY \"EMP0\".\"DEPTNO\""},{"index":228,"rewrite rule":"testAggregateJoinRemove9","original query":"SELECT \"EMP\".\"DEPTNO\", \"DEPT0\".\"NAME\" FROM \"EMP\" LEFT JOIN \"DEPT\" ON \"EMP\".\"DEPTNO\" = \"DEPT\".\"DEPTNO\" LEFT JOIN \"DEPT\" AS \"DEPT0\" ON \"EMP\".\"DEPTNO\" = \"DEPT0\".\"DEPTNO\" GROUP BY \"EMP\".\"DEPTNO\", \"DEPT0\".\"NAME\"","rewritten query":"SELECT \"EMP0\".\"DEPTNO\", \"DEPT1\".\"NAME\" FROM \"EMP\" AS \"EMP0\" LEFT JOIN \"DEPT\" AS \"DEPT1\" ON \"EMP0\".\"DEPTNO\" = \"DEPT1\".\"DEPTNO\" GROUP BY \"EMP0\".\"DEPTNO\", \"DEPT1\".\"NAME\""},{"index":229,"rewrite rule":"testReduceAggregateFunctionsByGroup","original query":"SELECT \"SAL\", MAX(\"SAL\") AS \"SAL_MAX\", MIN(\"SAL\") AS \"SAL_MIN\", AVG(\"SAL\") AS \"SAL_AVG\", ANY_VALUE(\"SAL\") AS \"SAL_VAL\", FIRST_VALUE(\"SAL\") AS \"SAL_FIRST\", LAST_VALUE(\"SAL\") AS \"SAL_LAST\" FROM \"EMP\" GROUP BY \"SAL\", \"DEPTNO\"","rewritten query":"SELECT \"SAL\", \"SAL\" AS \"SAL_MAX\", \"SAL\" AS \"SAL_MIN\", \"SAL\" AS \"SAL_AVG\", \"SAL\" AS \"SAL_VAL\", \"SAL\" AS \"SAL_FIRST\", \"SAL\" AS \"SAL_LAST\" FROM \"EMP\" GROUP BY \"SAL\", \"DEPTNO\""},{"index":230,"rewrite rule":"testMergeUnionAll","original query":"SELECT * FROM (SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 10 UNION ALL SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 20) AS \"t\" UNION ALL SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 30","rewritten query":"SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 10 UNION ALL SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 20 UNION ALL SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 30"},{"index":231,"rewrite rule":"testReduceWithNonTypePredicate","original query":"SELECT AVG(\"SAL\"), AVG(\"SAL\") FROM \"EMP\"","rewritten query":"SELECT AVG(\"SAL\"), CAST(CASE WHEN COUNT(*) = 0 THEN NULL ELSE COALESCE(SUM(\"SAL\"), 0) END \/ COUNT(*) AS INTEGER) FROM \"EMP\""},{"index":232,"rewrite rule":"testReduceCasts","original query":"SELECT CAST(\"NAME\" AS VARCHAR(128)), CAST(\"EMPNO\" AS INTEGER) FROM (SELECT \"t\".\"DEPTNO\", \"t\".\"NAME\", \"t0\".\"EMPNO\", \"t0\".\"ENAME\", \"t0\".\"JOB\", \"t0\".\"MGR\", \"t0\".\"HIREDATE\", \"t0\".\"SAL\", \"t0\".\"COMM\", \"t0\".\"DEPTNO\" AS \"DEPTNO1\", \"t0\".\"SLACKER\" FROM (SELECT \"DEPTNO\", \"NAME\", CAST(\"DEPTNO\" AS INTEGER) AS \"DEPTNO0\" FROM \"DEPT\") AS \"t\" INNER JOIN (SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\", CAST(\"DEPTNO\" AS INTEGER) AS \"DEPTNO0\" FROM \"EMP\") AS \"t0\" ON \"t\".\"DEPTNO0\" = \"t0\".\"DEPTNO0\") AS \"t1\" WHERE CAST(\"t1\".\"JOB\" AS VARCHAR(1)) = 'Manager'","rewritten query":"SELECT CAST(\"NAME\" AS VARCHAR(128)), \"EMPNO\" FROM (SELECT \"t4\".\"DEPTNO\", \"t4\".\"NAME\", \"t5\".\"EMPNO\", \"t5\".\"ENAME\", \"t5\".\"JOB\", \"t5\".\"MGR\", \"t5\".\"HIREDATE\", \"t5\".\"SAL\", \"t5\".\"COMM\", \"t5\".\"DEPTNO\" AS \"DEPTNO1\", \"t5\".\"SLACKER\" FROM (SELECT \"DEPTNO\", \"NAME\", \"DEPTNO\" AS \"DEPTNO0\" FROM \"DEPT\") AS \"t4\" INNER JOIN (SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\", \"DEPTNO\" AS \"DEPTNO0\" FROM \"EMP\") AS \"t5\" ON \"t4\".\"DEPTNO0\" = \"t5\".\"DEPTNO0\") AS \"t6\" WHERE CAST(\"t6\".\"JOB\" AS VARCHAR(1)) = 'Manager'"},{"index":233,"rewrite rule":"testReduceAverageWithNoReduceSum","original query":"SELECT \"NAME\", MAX(\"NAME\"), AVG(\"DEPTNO\"), MIN(\"NAME\") FROM \"DEPT\" GROUP BY \"NAME\"","rewritten query":"SELECT \"NAME\", \"NAME\", CAST(SUM(\"DEPTNO\") \/ COUNT(*) AS INTEGER), \"NAME\" FROM \"DEPT\" GROUP BY \"NAME\""},{"index":234,"rewrite rule":"testLeftOuterJoinSimplificationToInner","original query":"SELECT 1 FROM \"DEPT\" LEFT JOIN \"EMP\" ON \"DEPT\".\"DEPTNO\" = \"EMP\".\"DEPTNO\" WHERE \"EMP\".\"SAL\" > 100","rewritten query":"SELECT 1 FROM \"DEPT\" AS \"DEPT0\" INNER JOIN (SELECT * FROM \"EMP\" WHERE \"SAL\" > 100) AS \"t1\" ON \"DEPT0\".\"DEPTNO\" = \"t1\".\"DEPTNO\""},{"index":235,"rewrite rule":"testPushSumNullableNOGBYThroughUnion","original query":"SELECT SUM(\"MGR\") FROM (SELECT * FROM \"EMP\" UNION ALL SELECT * FROM \"EMP\") AS \"t1\"","rewritten query":"SELECT SUM(\"EXPR$0\") FROM (SELECT SUM(\"MGR\") AS \"EXPR$0\" FROM \"EMP\" UNION ALL SELECT SUM(\"MGR\") AS \"EXPR$0\" FROM \"EMP\") AS \"t8\""},{"index":236,"rewrite rule":"testDistinctWithFilterAndGroupBy","original query":"SELECT \"DEPTNO\", SUM(\"COMM\"), COUNT(DISTINCT \"SAL\") FILTER (WHERE \"SAL\" > 1000) FROM \"EMP\" GROUP BY \"DEPTNO\"","rewritten query":"SELECT \"DEPTNO\", CAST(MIN(\"EXPR$1\") FILTER (WHERE \"$g_3\") AS INTEGER), COUNT(\"SAL\") FILTER (WHERE \"$g_0_f_2\") FROM (SELECT \"DEPTNO\", \"SAL\", SUM(\"COMM\") AS \"EXPR$1\", GROUPING(\"DEPTNO\", \"SAL\", \"SAL\" > 1000) = 0 AND \"SAL\" > 1000 IS TRUE AS \"$g_0_f_2\", GROUPING(\"DEPTNO\", \"SAL\", \"SAL\" > 1000) = 3 AS \"$g_3\" FROM \"EMP\" GROUP BY GROUPING SETS((\"DEPTNO\", \"SAL\", \"SAL\" > 1000), \"DEPTNO\")) AS \"t3\" GROUP BY \"DEPTNO\""},{"index":237,"rewrite rule":"testEmptyMinus2","original query":"SELECT * FROM (SELECT * FROM (SELECT * FROM (VALUES (30, 3)) AS \"t\" (\"X\", \"Y\") EXCEPT SELECT * FROM (VALUES (20, 2)) AS \"t1\" (\"X\", \"Y\") WHERE \"X\" > 30) AS \"t\" EXCEPT SELECT * FROM (VALUES (40, 4)) AS \"t\" (\"EXPR$0\", \"EXPR$1\")) AS \"t\" EXCEPT SELECT * FROM (VALUES (50, 5)) AS \"t8\" (\"X\", \"Y\") WHERE \"X\" > 50","rewritten query":"SELECT * FROM (VALUES (30, 3)) AS \"t\" (\"X\", \"Y\") EXCEPT SELECT * FROM (VALUES (40, 4)) AS \"t\" (\"EXPR$0\", \"EXPR$1\")"},{"index":238,"rewrite rule":"testSomeWithEquality","original query":"SELECT * FROM \"EMP\" WHERE \"DEPTNO\" IN (SELECT \"DEPTNO\" FROM \"DEPT\")","rewritten query":"SELECT \"EMP0\".\"EMPNO\", \"EMP0\".\"ENAME\", \"EMP0\".\"JOB\", \"EMP0\".\"MGR\", \"EMP0\".\"HIREDATE\", \"EMP0\".\"SAL\", \"EMP0\".\"COMM\", \"EMP0\".\"DEPTNO\", \"EMP0\".\"SLACKER\" FROM \"EMP\" AS \"EMP0\" INNER JOIN (SELECT \"DEPTNO\" FROM \"DEPT\") AS \"t2\" ON \"EMP0\".\"DEPTNO\" = \"t2\".\"DEPTNO\""},{"index":239,"rewrite rule":"testPushAggregateThroughJoin1","original query":"SELECT \"t0\".\"JOB\", \"DEPT\".\"NAME\" FROM (SELECT * FROM \"EMP\" WHERE \"ENAME\" = 'A') AS \"t0\" INNER JOIN \"DEPT\" ON \"t0\".\"JOB\" = \"DEPT\".\"NAME\" GROUP BY \"t0\".\"JOB\", \"DEPT\".\"NAME\"","rewritten query":"SELECT * FROM (SELECT \"JOB\" FROM \"EMP\" WHERE \"ENAME\" = 'A' GROUP BY \"JOB\") AS \"t5\" INNER JOIN (SELECT \"NAME\" FROM \"DEPT\" GROUP BY \"NAME\") AS \"t6\" ON \"t5\".\"JOB\" = \"t6\".\"NAME\""},{"index":240,"rewrite rule":"testPushAggregateThroughJoin2","original query":"SELECT \"t0\".\"JOB\", \"t1\".\"NAME\" FROM (SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\", \"DEPTNO\" + \"EMPNO\" AS \"$f9\" FROM \"EMP\" WHERE \"ENAME\" = 'A') AS \"t0\" INNER JOIN (SELECT \"DEPTNO\", \"NAME\", \"DEPTNO\" + 5 AS \"$f2\" FROM \"DEPT\") AS \"t1\" ON \"t0\".\"JOB\" = \"t1\".\"NAME\" AND \"t0\".\"$f9\" = \"t1\".\"$f2\" GROUP BY \"t0\".\"JOB\", \"t1\".\"NAME\"","rewritten query":"SELECT \"t6\".\"JOB\", \"t8\".\"NAME\" FROM (SELECT \"JOB\", \"DEPTNO\" + \"EMPNO\" AS \"$f9\" FROM \"EMP\" WHERE \"ENAME\" = 'A' GROUP BY \"JOB\", \"DEPTNO\" + \"EMPNO\") AS \"t6\" INNER JOIN (SELECT \"NAME\", \"DEPTNO\" + 5 AS \"$f2\" FROM \"DEPT\" GROUP BY \"NAME\", \"DEPTNO\" + 5) AS \"t8\" ON \"t6\".\"JOB\" = \"t8\".\"NAME\" AND \"t6\".\"$f9\" = \"t8\".\"$f2\" GROUP BY \"t6\".\"JOB\", \"t8\".\"NAME\""},{"index":241,"rewrite rule":"testPushAggregateThroughJoin4","original query":"SELECT \"EMP\".\"DEPTNO\" FROM \"EMP\" INNER JOIN \"DEPT\" ON \"EMP\".\"DEPTNO\" = \"DEPT\".\"DEPTNO\" GROUP BY \"EMP\".\"DEPTNO\"","rewritten query":"SELECT \"t1\".\"DEPTNO\" FROM (SELECT \"DEPTNO\" FROM \"EMP\" GROUP BY \"DEPTNO\") AS \"t1\" INNER JOIN (SELECT \"DEPTNO\" FROM \"DEPT\") AS \"t2\" ON \"t1\".\"DEPTNO\" = \"t2\".\"DEPTNO\""},{"index":242,"rewrite rule":"testPushAggregateThroughJoin5","original query":"SELECT \"EMP\".\"DEPTNO\", \"DEPT\".\"DEPTNO\" AS \"DEPTNO0\" FROM \"EMP\" INNER JOIN \"DEPT\" ON \"EMP\".\"DEPTNO\" = \"DEPT\".\"DEPTNO\" GROUP BY \"EMP\".\"DEPTNO\", \"DEPT\".\"DEPTNO\"","rewritten query":"SELECT * FROM (SELECT \"DEPTNO\" FROM \"EMP\" GROUP BY \"DEPTNO\") AS \"t2\" INNER JOIN (SELECT \"DEPTNO\" FROM \"DEPT\") AS \"t3\" ON \"t2\".\"DEPTNO\" = \"t3\".\"DEPTNO\""},{"index":243,"rewrite rule":"testPushAggregateThroughJoin6","original query":"SELECT SUM(\"t0\".\"SAL\") FROM \"EMP\" INNER JOIN (SELECT \"SAL\" FROM \"EMP\" GROUP BY \"SAL\") AS \"t0\" ON \"EMP\".\"SAL\" = \"t0\".\"SAL\"","rewritten query":"SELECT SUM(CAST(\"t3\".\"$f1\" * \"t4\".\"SAL\" AS INTEGER)) FROM (SELECT \"SAL\", COUNT(*) AS \"$f1\" FROM \"EMP\" GROUP BY \"SAL\") AS \"t3\" INNER JOIN (SELECT \"SAL\" FROM \"EMP\" GROUP BY \"SAL\") AS \"t4\" ON \"t3\".\"SAL\" = \"t4\".\"SAL\""},{"index":244,"rewrite rule":"testPushAggregateThroughJoin7","original query":"SELECT ANY_VALUE(\"t0\".\"SAL\") FROM \"EMP\" INNER JOIN (SELECT \"SAL\" FROM \"EMP\" GROUP BY \"SAL\") AS \"t0\" ON \"EMP\".\"SAL\" = \"t0\".\"SAL\"","rewritten query":"SELECT ANY_VALUE(\"t4\".\"SAL\") FROM (SELECT \"SAL\" FROM \"EMP\" GROUP BY \"SAL\") AS \"t3\" INNER JOIN (SELECT \"SAL\" FROM \"EMP\" GROUP BY \"SAL\") AS \"t4\" ON \"t3\".\"SAL\" = \"t4\".\"SAL\""},{"index":245,"rewrite rule":"testPushAggregateThroughJoin8","original query":"SELECT SINGLE_VALUE(\"t0\".\"SAL\") FROM \"EMP\" INNER JOIN (SELECT \"SAL\" FROM \"EMP\" GROUP BY \"SAL\") AS \"t0\" ON \"EMP\".\"SAL\" = \"t0\".\"SAL\"","rewritten query":"SELECT SINGLE_VALUE(\"t4\".\"SAL\") FROM (SELECT \"SAL\" FROM \"EMP\" GROUP BY \"SAL\") AS \"t3\" INNER JOIN (SELECT \"SAL\" FROM \"EMP\" GROUP BY \"SAL\") AS \"t4\" ON \"t3\".\"SAL\" = \"t4\".\"SAL\""},{"index":246,"rewrite rule":"testAntiJoinProjectTranspose","original query":"SELECT \"NAME\" FROM \"DEPT\" WHERE NOT EXISTS (SELECT 1 FROM (SELECT 2 * \"DEPTNO\" AS \"$f0\" FROM \"DEPT\" GROUP BY 2 * \"DEPTNO\") AS \"t0\" WHERE \"DEPT\".\"DEPTNO\" = \"t0\".\"$f0\")","rewritten query":"SELECT \"NAME\" FROM (SELECT \"DEPTNO\", \"NAME\" FROM \"DEPT\" WHERE NOT EXISTS (SELECT 1 FROM (SELECT 2 * \"DEPTNO\" AS \"$f0\" FROM \"DEPT\" GROUP BY 2 * \"DEPTNO\") AS \"t5\" WHERE \"DEPTNO\" = \"t5\".\"$f0\")) AS \"t2\""},{"index":247,"rewrite rule":"testNoOversimplificationBelowIsNull","original query":"SELECT * FROM \"EMP\" WHERE (\"EMPNO\" = 1 AND \"MGR\" = 1 OR \"EMPNO\" = NULL AND \"MGR\" = 1) IS NULL","rewritten query":"SELECT * FROM \"EMP\" WHERE (\"EMPNO\" = 1 AND \"MGR\" = 1 OR NULL AND \"MGR\" = 1) IS NULL"},{"index":248,"rewrite rule":"testPushFilterPastProject","original query":"SELECT \"t0\".\"NAME\" FROM (SELECT \"DEPT\".\"DEPTNO\", \"DEPT\".\"NAME\", \"t\".\"DEPTNO\" AS \"DEPTNO0\", \"t\".\"NAME\" AS \"NAME0\", \"t\".\"DEPTNO\" > 10 AS \"$f4\" FROM \"DEPT\" LEFT JOIN (SELECT \"DEPTNO\", \"NAME\", \"DEPTNO\" > 10 AS \"$f2\" FROM \"DEPT\") AS \"t\" ON \"t\".\"$f2\") AS \"t0\" RIGHT JOIN \"DEPT\" AS \"DEPT1\" ON \"t0\".\"$f4\"","rewritten query":"SELECT \"t6\".\"NAME\" FROM (SELECT \"DEPT2\".\"DEPTNO\", \"DEPT2\".\"NAME\", CAST(\"t4\".\"DEPTNO\" AS INTEGER) AS \"DEPTNO0\", CAST(\"t4\".\"NAME\" AS VARCHAR(10)) AS \"NAME0\", CAST(\"t4\".\"DEPTNO\" AS INTEGER) > 10 AS \"$f4\" FROM \"DEPT\" AS \"DEPT2\", (SELECT \"DEPTNO\", \"NAME\", \"DEPTNO\" > 10 AS \"$f2\" FROM (SELECT * FROM \"DEPT\" WHERE \"DEPTNO\" > 10) AS \"t2\" WHERE \"DEPTNO\" > 10) AS \"t4\") AS \"t6\" RIGHT JOIN \"DEPT\" AS \"DEPT4\" ON TRUE"},{"index":249,"rewrite rule":"testPushBoolAndBoolOrThroughUnion","original query":"SELECT \"ENAME\", BOOL_AND(\"EMPBOL\"), BOOL_OR(\"EMPBOL\") FROM (SELECT \"ENAME\", MOD(\"EMPNO\", 2) = 1 AS \"EMPBOL\" FROM \"EMP\" UNION ALL SELECT \"ENAME\", MOD(\"EMPNO\", 2) = 1 AS \"EMPBOL\" FROM \"EMP\") AS \"t1\" GROUP BY \"ENAME\"","rewritten query":"SELECT \"ENAME\", BOOL_AND(\"EXPR$1\"), BOOL_OR(\"EXPR$2\") FROM (SELECT \"ENAME\", BOOL_AND(MOD(\"EMPNO\", 2) = 1) AS \"EXPR$1\", BOOL_OR(MOD(\"EMPNO\", 2) = 1) AS \"EXPR$2\" FROM \"EMP\" GROUP BY \"ENAME\" UNION ALL SELECT \"ENAME\", BOOL_AND(MOD(\"EMPNO\", 2) = 1) AS \"EXPR$1\", BOOL_OR(MOD(\"EMPNO\", 2) = 1) AS \"EXPR$2\" FROM \"EMP\" GROUP BY \"ENAME\") AS \"t7\" GROUP BY \"ENAME\""},{"index":250,"rewrite rule":"testSelectNotInCorrelated","original query":"SELECT \"SAL\", \"EMPNO\" NOT IN (SELECT \"DEPTNO\" FROM \"DEPT\" WHERE \"EMP\".\"JOB\" = \"NAME\") FROM \"EMP\"","rewritten query":"SELECT \"EMP0\".\"SAL\", \"t2\".\"i\" IS NULL FROM \"EMP\" AS \"EMP0\" LEFT JOIN (SELECT \"DEPTNO\", TRUE AS \"i\", \"NAME\" FROM \"DEPT\") AS \"t2\" ON \"EMP0\".\"EMPNO\" = \"t2\".\"DEPTNO\" AND \"EMP0\".\"JOB\" = \"t2\".\"NAME\""},{"index":251,"rewrite rule":"testReduceConstants","original query":"SELECT 1 + 2, \"DEPTNO\" + (3 + 4), 5 + 6 + \"DEPTNO\", CAST(NULL AS INTEGER), CASE WHEN 2 IS NOT NULL THEN 2 ELSE NULL END, (7 + 8) FROM (SELECT \"DEPT\".\"DEPTNO\", \"DEPT\".\"NAME\", \"t\".\"EMPNO\", \"t\".\"ENAME\", \"t\".\"JOB\", \"t\".\"MGR\", \"t\".\"HIREDATE\", \"t\".\"SAL\", \"t\".\"COMM\", \"t\".\"DEPTNO\" AS \"DEPTNO0\", \"t\".\"SLACKER\" FROM \"DEPT\" INNER JOIN (SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\", \"DEPTNO\" + (5 - 5) AS \"$f9\" FROM \"EMP\") AS \"t\" ON \"DEPT\".\"DEPTNO\" = \"t\".\"$f9\") AS \"t0\" WHERE \"t0\".\"DEPTNO\" = 7 + 8 AND \"t0\".\"DEPTNO\" = 8 + 7 AND \"t0\".\"DEPTNO\" = CASE WHEN 2 IS NOT NULL THEN 2 ELSE NULL END","rewritten query":"SELECT 3, 22, 26, CAST(NULL AS INTEGER), CAST(2 AS INTEGER), (15) FROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"DEPTNO\", \"NAME\", \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO0\", \"SLACKER\") WHERE 1 = 0"},{"index":252,"rewrite rule":"testPushSumNullConstantThroughUnion","original query":"SELECT \"ENAME\", SUM(\"U\") FROM (SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\", CAST(NULL AS INTEGER) AS \"U\" FROM \"EMP\" UNION ALL SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\", CAST(NULL AS INTEGER) AS \"U\" FROM \"EMP\") AS \"t1\" GROUP BY \"ENAME\"","rewritten query":"SELECT \"ENAME\", SUM(\"EXPR$1\") FROM (SELECT \"ENAME\", SUM(CAST(NULL AS INTEGER)) AS \"EXPR$1\" FROM \"EMP\" GROUP BY \"ENAME\" UNION ALL SELECT \"ENAME\", SUM(CAST(NULL AS INTEGER)) AS \"EXPR$1\" FROM \"EMP\" GROUP BY \"ENAME\") AS \"t8\" GROUP BY \"ENAME\""},{"index":253,"rewrite rule":"testMergeJoinFilter","original query":"SELECT * FROM (SELECT \"DEPT\".\"DEPTNO\", \"EMP\".\"ENAME\" FROM \"EMP\" INNER JOIN \"DEPT\" ON \"EMP\".\"DEPTNO\" = \"DEPT\".\"DEPTNO\" AND \"DEPT\".\"DEPTNO\" = 10) AS \"t\" WHERE \"t\".\"DEPTNO\" = 10","rewritten query":"SELECT \"t2\".\"DEPTNO\", \"EMP0\".\"ENAME\" FROM \"EMP\" AS \"EMP0\" INNER JOIN (SELECT * FROM \"DEPT\" WHERE \"DEPTNO\" = 10) AS \"t2\" ON \"EMP0\".\"DEPTNO\" = \"t2\".\"DEPTNO\""},{"index":254,"rewrite rule":"testFilterJoinRuleOrIsNotNull","original query":"SELECT * FROM \"EMP\" LEFT JOIN \"DEPT\" ON \"EMP\".\"EMPNO\" = \"DEPT\".\"DEPTNO\" WHERE \"DEPT\".\"DEPTNO\" IS NOT NULL OR \"DEPT\".\"NAME\" IS NOT NULL","rewritten query":"SELECT \"EMP0\".\"EMPNO\", \"EMP0\".\"ENAME\", \"EMP0\".\"JOB\", \"EMP0\".\"MGR\", \"EMP0\".\"HIREDATE\", \"EMP0\".\"SAL\", \"EMP0\".\"COMM\", \"EMP0\".\"DEPTNO\", \"EMP0\".\"SLACKER\", CAST(\"DEPT0\".\"DEPTNO\" AS INTEGER) AS \"DEPTNO0\", CAST(\"DEPT0\".\"NAME\" AS VARCHAR(10)) AS \"NAME\" FROM \"EMP\" AS \"EMP0\" INNER JOIN \"DEPT\" AS \"DEPT0\" ON \"EMP0\".\"EMPNO\" = \"DEPT0\".\"DEPTNO\""},{"index":255,"rewrite rule":"testMergeUnionDistinct","original query":"SELECT * FROM (SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 10 UNION SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 20) AS \"t\" UNION SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 30","rewritten query":"SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 10 UNION SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 20 UNION SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 30"},{"index":256,"rewrite rule":"testStrengthenJoinType","original query":"SELECT * FROM \"DEPT\" LEFT JOIN \"EMP\" ON \"DEPT\".\"DEPTNO\" = \"EMP\".\"DEPTNO\" WHERE \"EMP\".\"DEPTNO\" IS NOT NULL AND \"EMP\".\"SAL\" > 100","rewritten query":"SELECT \"DEPT0\".\"DEPTNO\", \"DEPT0\".\"NAME\", CAST(\"t1\".\"EMPNO\" AS INTEGER) AS \"EMPNO\", CAST(\"t1\".\"ENAME\" AS VARCHAR(20)) AS \"ENAME\", CAST(\"t1\".\"JOB\" AS VARCHAR(10)) AS \"JOB\", \"t1\".\"MGR\", CAST(\"t1\".\"HIREDATE\" AS TIMESTAMP(0)) AS \"HIREDATE\", CAST(\"t1\".\"SAL\" AS INTEGER) AS \"SAL\", CAST(\"t1\".\"COMM\" AS INTEGER) AS \"COMM\", CAST(\"t1\".\"DEPTNO\" AS INTEGER) AS \"DEPTNO0\", CAST(\"t1\".\"SLACKER\" AS BOOLEAN) AS \"SLACKER\" FROM \"DEPT\" AS \"DEPT0\" INNER JOIN (SELECT * FROM \"EMP\" WHERE \"SAL\" > 100) AS \"t1\" ON \"DEPT0\".\"DEPTNO\" = \"t1\".\"DEPTNO\""},{"index":257,"rewrite rule":"testWithinDistinctCountDistinct","original query":"SELECT \"DEPTNO\", SUM(\"SAL\") AS \"SS_C\", COUNT(DISTINCT \"JOB\") AS \"CDJ\", COUNT(*) AS \"CJ_J\", COUNT(DISTINCT \"JOB\") AS \"CDJ_J\", COUNT(DISTINCT \"JOB\") FILTER (WHERE \"SAL\" > 1000) AS \"CDJ_FILTERED\" FROM \"EMP\" GROUP BY \"DEPTNO\"","rewritten query":"SELECT \"DEPTNO\", COALESCE(SUM(\"$f3\") FILTER (WHERE \"$f7\"), 0) AS \"$f1\", COUNT(*) FILTER (WHERE \"$f8\") AS \"$f2\", COUNT(*) FILTER (WHERE \"$f8\") AS \"$f20\", COUNT(*) FILTER (WHERE \"$f8\") AS \"$f21\", COUNT(\"$f4\") FILTER (WHERE \"$f9\") AS \"$f3\" FROM (SELECT \"DEPTNO\", MIN(\"SAL\") AS \"$f3\", MIN(\"JOB\") FILTER (WHERE \"SAL\" > 1000) AS \"$f4\", GROUPING(\"DEPTNO\", \"COMM\", \"JOB\") = 1 AS \"$f7\", GROUPING(\"DEPTNO\", \"COMM\", \"JOB\") = 2 AS \"$f8\", GROUPING(\"DEPTNO\", \"COMM\", \"JOB\") = 2 AND (COUNT(*) FILTER (WHERE \"SAL\" > 1000)) > 0 AS \"$f9\" FROM \"EMP\" GROUP BY GROUPING SETS((\"DEPTNO\", \"COMM\"), (\"DEPTNO\", \"JOB\"))) AS \"t3\" GROUP BY \"DEPTNO\""},{"index":258,"rewrite rule":"testPullConstantIntoProjectWithIsNotDistinctFrom","original query":"SELECT \"DEPTNO\", \"DEPTNO\" + 1, \"EMPNO\" + \"DEPTNO\" FROM \"EMP\" WHERE \"DEPTNO\" IS NULL AND 10 IS NULL OR \"DEPTNO\" = 10 IS TRUE","rewritten query":"SELECT 10 AS \"DEPTNO\", 11, \"EMPNO\" + 10 FROM \"EMP\" WHERE \"DEPTNO\" IS NULL AND 10 IS NULL OR \"DEPTNO\" = 10 IS TRUE"},{"index":259,"rewrite rule":"testDistinctCountWithExpandSumType","original query":"SELECT COUNT(*), COUNT(DISTINCT \"COMM\") FROM \"EMP\"","rewritten query":"SELECT CAST(COALESCE(SUM(\"EXPR$0\"), 0) AS BIGINT), COUNT(\"COMM\") FROM (SELECT \"COMM\", COUNT(*) AS \"EXPR$0\" FROM \"EMP\" GROUP BY \"COMM\") AS \"t2\""},{"index":260,"rewrite rule":"testExpandWhereComparisonCorrelated","original query":"SELECT \"EMPNO\" FROM \"EMP\" WHERE \"SAL\" = (((SELECT MAX(\"SAL\") FROM \"EMP\" WHERE \"EMPNO\" = \"EMP\".\"EMPNO\")))","rewritten query":"SELECT \"$cor0\".\"EMPNO\" FROM \"EMP\" AS \"$cor0\", LATERAL (SELECT MAX(\"SAL\") AS \"EXPR$0\" FROM \"EMP\" WHERE \"EMPNO\" = \"$cor0\".\"EMPNO\") AS \"t6\" WHERE \"$cor0\".\"SAL\" = \"$cor0\".\"EXPR$0\""},{"index":261,"rewrite rule":"testPushAggregateSumThroughJoin","original query":"SELECT \"t0\".\"JOB\", SUM(\"t0\".\"SAL\") FROM (SELECT * FROM \"EMP\" WHERE \"ENAME\" = 'A') AS \"t0\" INNER JOIN \"DEPT\" ON \"t0\".\"JOB\" = \"DEPT\".\"NAME\" GROUP BY \"t0\".\"JOB\", \"DEPT\".\"NAME\"","rewritten query":"SELECT \"t6\".\"JOB\", CAST(\"t6\".\"EXPR$1\" * \"t7\".\"$f1\" AS INTEGER) FROM (SELECT \"JOB\", SUM(\"SAL\") AS \"EXPR$1\" FROM \"EMP\" WHERE \"ENAME\" = 'A' GROUP BY \"JOB\") AS \"t6\" INNER JOIN (SELECT \"NAME\", COUNT(*) AS \"$f1\" FROM \"DEPT\" GROUP BY \"NAME\") AS \"t7\" ON \"t6\".\"JOB\" = \"t7\".\"NAME\""},{"index":262,"rewrite rule":"testExpandFilterIn","original query":"SELECT \"EMPNO\" FROM \"EMP\" WHERE \"DEPTNO\" IN (SELECT \"DEPTNO\" FROM \"EMP\" WHERE \"EMPNO\" < 20) OR \"SAL\" < 100","rewritten query":"SELECT \"EMP1\".\"EMPNO\" FROM \"EMP\" AS \"EMP1\" LEFT JOIN (SELECT \"t3\".\"DEPTNO\", \"t4\".\"i\" FROM (SELECT * FROM \"EMP\" WHERE \"EMPNO\" < 20) AS \"t3\", (VALUES (TRUE)) AS \"t4\" (\"i\") GROUP BY \"t3\".\"DEPTNO\", \"t4\".\"i\") AS \"t6\" ON \"EMP1\".\"DEPTNO\" = \"t6\".\"DEPTNO\" WHERE \"t6\".\"i\" IS NOT NULL OR \"EMP1\".\"SAL\" < 100"},{"index":263,"rewrite rule":"testPushAggregateSumWithoutGroupKeyThroughJoin","original query":"SELECT SUM(\"t0\".\"SAL\") FROM (SELECT * FROM \"EMP\" WHERE \"ENAME\" = 'A') AS \"t0\" INNER JOIN \"DEPT\" ON \"t0\".\"JOB\" = \"DEPT\".\"NAME\"","rewritten query":"SELECT SUM(CAST(\"t5\".\"EXPR$0\" * \"t6\".\"$f1\" AS INTEGER)) FROM (SELECT \"JOB\", SUM(\"SAL\") AS \"EXPR$0\" FROM \"EMP\" WHERE \"ENAME\" = 'A' GROUP BY \"JOB\") AS \"t5\" INNER JOIN (SELECT \"NAME\", COUNT(*) AS \"$f1\" FROM \"DEPT\" GROUP BY \"NAME\") AS \"t6\" ON \"t5\".\"JOB\" = \"t6\".\"NAME\""},{"index":264,"rewrite rule":"testProjectAggregateMergeSum0AndSum","original query":"SELECT SUM(\"SAL\") * 2, CASE WHEN SUM(\"SAL\") IS NOT NULL THEN CAST(SUM(\"SAL\") AS INTEGER) ELSE 0 END AS \"SS0\" FROM \"EMP\"","rewritten query":"SELECT SUM(\"SAL\") * 2 AS \"$f0\", COALESCE(SUM(\"SAL\"), 0) AS \"$f1\" FROM \"EMP\""},{"index":265,"rewrite rule":"testReduceConstantsCaseEquals","original query":"SELECT COUNT(*) FROM \"EMP\" WHERE CASE WHEN \"DEPTNO\" = 20 THEN 2 WHEN \"DEPTNO\" = 10 THEN 1 ELSE 3 END = 1","rewritten query":"SELECT COUNT(*) FROM \"EMP\" WHERE \"DEPTNO\" = 10"},{"index":266,"rewrite rule":"testEmptyProject","original query":"SELECT \"X\" + \"Y\" + \"X\" FROM (VALUES (10, 1), (30, 3)) AS \"t\" (\"X\", \"Y\") WHERE \"X\" + \"Y\" > 50","rewritten query":"SELECT * FROM (VALUES (NULL)) AS \"t\" (\"EXPR$0\") WHERE 1 = 0"},{"index":267,"rewrite rule":"testTransitiveInferenceConjunctInPullUp","original query":"SELECT 1 FROM \"EMP\" INNER JOIN \"EMP\" AS \"EMP0\" ON \"EMP\".\"DEPTNO\" = \"EMP0\".\"DEPTNO\" WHERE \"EMP\".\"DEPTNO\" = 7 OR \"EMP\".\"DEPTNO\" = 9 OR \"EMP\".\"DEPTNO\" > 10","rewritten query":"SELECT 1 FROM (SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 7 OR \"DEPTNO\" = 9 OR \"DEPTNO\" > 10) AS \"t1\" INNER JOIN (SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 7 OR \"DEPTNO\" = 9 OR \"DEPTNO\" > 10) AS \"t2\" ON \"t1\".\"DEPTNO\" = \"t2\".\"DEPTNO\""},{"index":268,"rewrite rule":"testPullConstantThroughAggregateSimpleNonNullable","original query":"SELECT \"EMP\".\"DEPTNO\", MAX(\"EMP\".\"ENAME\") FROM \"EMP\", (VALUES (4)) AS \"t\" (\"FOUR\") GROUP BY \"EMP\".\"DEPTNO\", \"t\".\"FOUR\"","rewritten query":"SELECT \"DEPTNO\", MAX(\"ENAME\") FROM \"EMP\" GROUP BY \"DEPTNO\""},{"index":269,"rewrite rule":"testUnionToDistinctRule","original query":"SELECT * FROM \"DEPT\" UNION SELECT * FROM \"DEPT\"","rewritten query":"SELECT \"DEPTNO\", \"NAME\" FROM (SELECT * FROM \"DEPT\" UNION ALL SELECT * FROM \"DEPT\") AS \"t4\" GROUP BY \"DEPTNO\", \"NAME\""},{"index":270,"rewrite rule":"testWhereExpressionInCorrelated2","original query":"SELECT \"NAME\" FROM (SELECT \"NAME\", \"DEPTNO\", \"DEPTNO\" - 10 AS \"DEPTNOMINUS\" FROM \"DEPT\") AS \"t\" WHERE \"DEPTNO\" IN (SELECT \"DEPTNO\" FROM \"EMP\" WHERE \"SAL\" + 1 = \"t\".\"DEPTNOMINUS\")","rewritten query":"SELECT \"t4\".\"NAME\" FROM (SELECT \"NAME\", \"DEPTNO\", \"DEPTNO\" - 10 AS \"DEPTNOMINUS\" FROM \"DEPT\") AS \"t4\" INNER JOIN (SELECT \"DEPTNO\", \"SAL\" + 1 AS \"$f9\" FROM \"EMP\" GROUP BY \"DEPTNO\", \"SAL\" + 1) AS \"t6\" ON \"t4\".\"DEPTNOMINUS\" = \"t6\".\"$f9\" AND \"t4\".\"DEPTNO\" = \"t6\".\"DEPTNO\""},{"index":271,"rewrite rule":"testPullAggregateThroughUnion","original query":"SELECT \"DEPTNO\", \"JOB\" FROM (SELECT \"DEPTNO\", \"JOB\" FROM \"EMP\" GROUP BY \"DEPTNO\", \"JOB\" UNION ALL SELECT \"DEPTNO\", \"JOB\" FROM \"EMP\" GROUP BY \"DEPTNO\", \"JOB\") AS \"t3\" GROUP BY \"DEPTNO\", \"JOB\"","rewritten query":"SELECT \"DEPTNO\", \"JOB\" FROM (SELECT \"DEPTNO\", \"JOB\" FROM \"EMP\" UNION ALL SELECT \"DEPTNO\", \"JOB\" FROM \"EMP\") AS \"t7\" GROUP BY \"DEPTNO\", \"JOB\""},{"index":272,"rewrite rule":"testPushProjectPastOutJoinWithCastNonNullExpr","original query":"SELECT \"EMP\".\"EMPNO\" + 1 AS \"C1\", CASE WHEN \"DEPT\".\"NAME\" IS NOT NULL THEN CAST(\"DEPT\".\"NAME\" AS VARCHAR(10)) WHEN \"BONUS\".\"JOB\" IS NOT NULL THEN CAST(\"BONUS\".\"JOB\" AS VARCHAR(10)) ELSE '' END AS \"C2\" FROM \"EMP\" LEFT JOIN \"BONUS\" ON \"EMP\".\"ENAME\" = \"BONUS\".\"ENAME\" LEFT JOIN \"DEPT\" ON \"EMP\".\"DEPTNO\" = \"DEPT\".\"DEPTNO\"","rewritten query":"SELECT \"t2\".\"C1\", CASE WHEN \"t3\".\"NAME\" IS NOT NULL THEN CAST(\"t3\".\"NAME\" AS VARCHAR(10)) WHEN \"t2\".\"EXPR$1\" THEN CAST(\"t2\".\"JOB0\" AS VARCHAR(10)) ELSE '' END AS \"C2\" FROM (SELECT \"t0\".\"DEPTNO\", \"t1\".\"JOB\" AS \"JOB0\", \"t0\".\"C1\", \"t1\".\"JOB\" IS NOT NULL AS \"EXPR$1\" FROM (SELECT \"ENAME\", \"DEPTNO\", \"EMPNO\" + 1 AS \"C1\" FROM \"EMP\") AS \"t0\" LEFT JOIN (SELECT \"ENAME\", \"JOB\" FROM \"BONUS\") AS \"t1\" ON \"t0\".\"ENAME\" = \"t1\".\"ENAME\") AS \"t2\" LEFT JOIN (SELECT * FROM \"DEPT\") AS \"t3\" ON \"t2\".\"DEPTNO\" = \"t3\".\"DEPTNO\""},{"index":273,"rewrite rule":"testPullConstantIntoFilter","original query":"SELECT * FROM (SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 10) AS \"t0\" WHERE \"DEPTNO\" + 5 > \"EMPNO\"","rewritten query":"SELECT * FROM (SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 10) AS \"t3\" WHERE 15 > \"EMPNO\""},{"index":274,"rewrite rule":"testSimplifyFilter","original query":"SELECT * FROM (SELECT * FROM \"EMP\" WHERE \"DEPTNO\" > 10) AS \"t0\" WHERE \"EMPNO\" > 3 AND \"DEPTNO\" > 5","rewritten query":"SELECT * FROM (SELECT * FROM \"EMP\" WHERE \"DEPTNO\" > 10) AS \"t3\" WHERE \"EMPNO\" > 3"},{"index":275,"rewrite rule":"testReduceAllAggregateFunctions","original query":"SELECT \"NAME\", STDDEV_POP(\"DEPTNO\"), AVG(\"DEPTNO\"), STDDEV_SAMP(\"DEPTNO\"), VAR_POP(\"DEPTNO\"), VAR_SAMP(\"DEPTNO\") FROM \"DEPT\" GROUP BY \"NAME\"","rewritten query":"SELECT \"NAME\", CAST(POWER((COALESCE(SUM(\"DEPTNO\" * \"DEPTNO\"), 0) - COALESCE(SUM(\"DEPTNO\"), 0) * COALESCE(SUM(\"DEPTNO\"), 0) \/ COUNT(*)) \/ COUNT(*), 0.5) AS INTEGER), CAST(COALESCE(SUM(\"DEPTNO\"), 0) \/ COUNT(*) AS INTEGER), CAST(POWER((COALESCE(SUM(\"DEPTNO\" * \"DEPTNO\"), 0) - COALESCE(SUM(\"DEPTNO\"), 0) * COALESCE(SUM(\"DEPTNO\"), 0) \/ COUNT(*)) \/ CASE WHEN COUNT(*) = 1 THEN NULL ELSE COUNT(*) - 1 END, 0.5) AS INTEGER), CAST((COALESCE(SUM(\"DEPTNO\" * \"DEPTNO\"), 0) - COALESCE(SUM(\"DEPTNO\"), 0) * COALESCE(SUM(\"DEPTNO\"), 0) \/ COUNT(*)) \/ COUNT(*) AS INTEGER), CAST((COALESCE(SUM(\"DEPTNO\" * \"DEPTNO\"), 0) - COALESCE(SUM(\"DEPTNO\"), 0) * COALESCE(SUM(\"DEPTNO\"), 0) \/ COUNT(*)) \/ CASE WHEN COUNT(*) = 1 THEN NULL ELSE COUNT(*) - 1 END AS INTEGER) FROM \"DEPT\" GROUP BY \"NAME\""},{"index":276,"rewrite rule":"testDistinctWithMultipleInputs","original query":"SELECT \"DEPTNO\", SUM(\"COMM\"), MIN(\"COMM\"), COUNT(DISTINCT \"SAL\", \"COMM\") FROM \"EMP\" GROUP BY \"DEPTNO\"","rewritten query":"SELECT \"DEPTNO\", SUM(\"EXPR$1\"), MIN(\"EXPR$2\"), COUNT(\"SAL\", \"COMM\") FROM (SELECT \"DEPTNO\", \"COMM\", \"SAL\", SUM(\"COMM\") AS \"EXPR$1\", MIN(\"COMM\") AS \"EXPR$2\" FROM \"EMP\" GROUP BY \"DEPTNO\", \"COMM\", \"SAL\") AS \"t2\" GROUP BY \"DEPTNO\""},{"index":277,"rewrite rule":"testPushSumNullableThroughUnion","original query":"SELECT \"ENAME\", SUM(\"MGR\") FROM (SELECT * FROM \"EMP\" UNION ALL SELECT * FROM \"EMP\") AS \"t1\" GROUP BY \"ENAME\"","rewritten query":"SELECT \"ENAME\", SUM(\"EXPR$1\") FROM (SELECT \"ENAME\", SUM(\"MGR\") AS \"EXPR$1\" FROM \"EMP\" GROUP BY \"ENAME\" UNION ALL SELECT \"ENAME\", SUM(\"MGR\") AS \"EXPR$1\" FROM \"EMP\" GROUP BY \"ENAME\") AS \"t8\" GROUP BY \"ENAME\""},{"index":278,"rewrite rule":"testEmptyAggregate","original query":"SELECT SUM(\"EMPNO\") FROM \"EMP\" WHERE FALSE GROUP BY \"DEPTNO\"","rewritten query":"SELECT * FROM (VALUES (NULL)) AS \"t\" (\"EXPR$0\") WHERE 1 = 0"},{"index":279,"rewrite rule":"testProjectToWindowRuleForMultipleWindows","original query":"SELECT COUNT(*) OVER (PARTITION BY \"EMPNO\" ORDER BY \"SAL\" RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS \"COUNT1\", COUNT(*) OVER (PARTITION BY \"DEPTNO\" ORDER BY \"SAL\" RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS \"COUNT2\", SUM(\"DEPTNO\") OVER (PARTITION BY \"EMPNO\" ORDER BY \"SAL\" RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS \"SUM1\", SUM(\"DEPTNO\") OVER (PARTITION BY \"DEPTNO\" ORDER BY \"SAL\" RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS \"SUM2\" FROM \"EMP\"","rewritten query":"SELECT COUNT(*) OVER (PARTITION BY \"EMPNO\" ORDER BY \"SAL\" RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS \"$0\", COUNT(*) OVER (PARTITION BY \"DEPTNO\" ORDER BY \"SAL\" RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS \"$1\", SUM(\"DEPTNO\") OVER (PARTITION BY \"EMPNO\" ORDER BY \"SAL\" RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS \"$2\", SUM(\"DEPTNO\") OVER (PARTITION BY \"DEPTNO\" ORDER BY \"SAL\" RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS \"$3\" FROM \"EMP\""},{"index":280,"rewrite rule":"testPushAggregateSumThroughJoinAfterAggregateReduce","original query":"SELECT SUM(\"t0\".\"SAL\") FROM (SELECT * FROM \"EMP\" WHERE \"ENAME\" = 'A') AS \"t0\" INNER JOIN \"DEPT\" ON \"t0\".\"JOB\" = \"DEPT\".\"NAME\"","rewritten query":"SELECT CASE WHEN COALESCE(SUM(\"t5\".\"$f2\" * \"t6\".\"$f1\"), 0) = 0 THEN NULL ELSE COALESCE(SUM(CAST(\"t5\".\"EXPR$0\" * \"t6\".\"$f1\" AS INTEGER)), 0) END FROM (SELECT \"JOB\", COALESCE(SUM(\"SAL\"), 0) AS \"EXPR$0\", COUNT(*) AS \"$f2\" FROM \"EMP\" WHERE \"ENAME\" = 'A' GROUP BY \"JOB\") AS \"t5\" INNER JOIN (SELECT \"NAME\", COUNT(*) AS \"$f1\" FROM \"DEPT\" GROUP BY \"NAME\") AS \"t6\" ON \"t5\".\"JOB\" = \"t6\".\"NAME\""},{"index":281,"rewrite rule":"testTransitiveInferencePullUpThruAlias","original query":"SELECT 1 FROM (SELECT \"COMM\" AS \"DEPTNO\" FROM \"EMP\" WHERE \"COMM\" > 7) AS \"t0\" INNER JOIN \"EMP\" AS \"EMP0\" ON \"t0\".\"DEPTNO\" = \"EMP0\".\"DEPTNO\"","rewritten query":"SELECT 1 FROM (SELECT \"COMM\" AS \"DEPTNO\" FROM \"EMP\" WHERE \"COMM\" > 7) AS \"t3\" INNER JOIN (SELECT * FROM \"EMP\" WHERE \"DEPTNO\" > 7) AS \"t4\" ON \"t3\".\"DEPTNO\" = \"t4\".\"DEPTNO\""},{"index":283,"rewrite rule":"testTransitiveInferenceAggregate","original query":"SELECT 1 FROM (SELECT \"DEPTNO\", COUNT(*) AS \"EXPR$1\" FROM \"EMP\" WHERE \"DEPTNO\" > 7 GROUP BY \"DEPTNO\") AS \"t1\" INNER JOIN \"EMP\" AS \"EMP0\" ON \"t1\".\"DEPTNO\" = \"EMP0\".\"DEPTNO\"","rewritten query":"SELECT 1 FROM (SELECT \"DEPTNO\", COUNT(*) AS \"EXPR$1\" FROM \"EMP\" WHERE \"DEPTNO\" > 7 GROUP BY \"DEPTNO\") AS \"t5\" INNER JOIN (SELECT * FROM \"EMP\" WHERE \"DEPTNO\" > 7) AS \"t6\" ON \"t5\".\"DEPTNO\" = \"t6\".\"DEPTNO\""},{"index":284,"rewrite rule":"testSortJoinCopyInnerJoinOrderBy","original query":"SELECT * FROM \"EMP\" INNER JOIN \"DEPT\" ON \"EMP\".\"DEPTNO\" = \"DEPT\".\"DEPTNO\" ORDER BY \"EMP\".\"SAL\"","rewritten query":"SELECT \"t1\".\"EMPNO\", \"t1\".\"ENAME\", \"t1\".\"JOB\", \"t1\".\"MGR\", \"t1\".\"HIREDATE\", \"t1\".\"SAL\", \"t1\".\"COMM\", \"t1\".\"DEPTNO\", \"t1\".\"SLACKER\", \"DEPT0\".\"DEPTNO\" AS \"DEPTNO0\", \"DEPT0\".\"NAME\" FROM (SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\" FROM \"EMP\" ORDER BY \"SAL\") AS \"t1\" INNER JOIN \"DEPT\" AS \"DEPT0\" ON \"t1\".\"DEPTNO\" = \"DEPT0\".\"DEPTNO\" ORDER BY \"t1\".\"SAL\""},{"index":285,"rewrite rule":"testExtractYearToRange","original query":"SELECT * FROM \"EMP_B\" WHERE EXTRACT(YEAR FROM \"BIRTHDATE\") = 2014","rewritten query":"SELECT * FROM \"EMP_B\" WHERE \"BIRTHDATE\" >= DATE '2014-01-01' AND \"BIRTHDATE\" < DATE '2015-01-01'"},{"index":286,"rewrite rule":"testEmptySortLimitZero","original query":"SELECT * FROM \"EMP\" ORDER BY \"DEPTNO\" FETCH NEXT 0 ROWS ONLY","rewritten query":"SELECT * FROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\") WHERE 1 = 0"},{"index":287,"rewrite rule":"testCastInAggregateExpandDistinctAggregatesRule","original query":"SELECT \"NAME\", SUM(DISTINCT \"CN\"), SUM(DISTINCT \"SM\") FROM (SELECT \"NAME\", COUNT(*) AS \"CN\", SUM(\"DEPTNO\") AS \"SM\" FROM \"DEPT\" GROUP BY \"NAME\") AS \"t0\" GROUP BY \"NAME\"","rewritten query":"SELECT \"NAME\", CAST(SUM(\"CN\") FILTER (WHERE \"$g_1\") AS BIGINT), CAST(SUM(\"SM\") FILTER (WHERE \"$g_2\") AS INTEGER) FROM (SELECT \"NAME\", \"CN\", \"SM\", GROUPING(\"NAME\", \"CN\", \"SM\") = 1 AS \"$g_1\", GROUPING(\"NAME\", \"CN\", \"SM\") = 2 AS \"$g_2\" FROM (SELECT \"NAME\", COUNT(*) AS \"CN\", SUM(\"DEPTNO\") AS \"SM\" FROM \"DEPT\" GROUP BY \"NAME\") AS \"t3\" GROUP BY GROUPING SETS((\"NAME\", \"CN\"), (\"NAME\", \"SM\"))) AS \"t5\" GROUP BY \"NAME\""},{"index":288,"rewrite rule":"testRemoveDistinctOnAgg","original query":"SELECT \"EMPNO\", SUM(DISTINCT \"SAL\"), MIN(\"SAL\"), MIN(\"SAL\"), MAX(\"SAL\"), BIT_AND(\"SAL\"), BIT_OR(\"SAL\"), COUNT(DISTINCT \"SAL\") FROM \"EMP\" GROUP BY \"EMPNO\", \"DEPTNO\"","rewritten query":"SELECT \"EMPNO\", \"SAL\", \"SAL\", \"SAL\", \"SAL\", \"SAL\", \"SAL\", 1 FROM \"EMP\""},{"index":289,"rewrite rule":"testDistinctCount1","original query":"SELECT \"DEPTNO\", COUNT(DISTINCT \"ENAME\") FROM \"EMP\" GROUP BY \"DEPTNO\"","rewritten query":"SELECT \"DEPTNO\", COUNT(\"ENAME\") FROM (SELECT \"ENAME\", \"DEPTNO\" FROM \"EMP\" GROUP BY \"ENAME\", \"DEPTNO\") AS \"t1\" GROUP BY \"DEPTNO\""},{"index":290,"rewrite rule":"testDistinctCount2","original query":"SELECT \"DEPTNO\", COUNT(DISTINCT \"ENAME\"), SUM(\"SAL\") FROM \"EMP\" GROUP BY \"DEPTNO\"","rewritten query":"SELECT \"DEPTNO\", COUNT(\"ENAME\") FILTER (WHERE \"$g_0\"), CAST(MIN(\"EXPR$2\") FILTER (WHERE \"$g_1\") AS INTEGER) FROM (SELECT \"DEPTNO\", \"ENAME\", SUM(\"SAL\") AS \"EXPR$2\", GROUPING(\"DEPTNO\", \"ENAME\") = 0 AS \"$g_0\", GROUPING(\"DEPTNO\", \"ENAME\") = 1 AS \"$g_1\" FROM \"EMP\" GROUP BY GROUPING SETS((\"ENAME\", \"DEPTNO\"), \"DEPTNO\")) AS \"t3\" GROUP BY \"DEPTNO\""},{"index":291,"rewrite rule":"testDistinctCount3","original query":"SELECT COUNT(DISTINCT \"DEPTNO\"), SUM(\"SAL\") FROM \"EMP\" GROUP BY \"DEPTNO\"","rewritten query":"SELECT COUNT(\"DEPTNO\") FILTER (WHERE \"$g_0\"), CAST(MIN(\"EXPR$1\") FILTER (WHERE \"$g_0\") AS INTEGER) FROM (SELECT \"DEPTNO\", SUM(\"SAL\") AS \"EXPR$1\", GROUPING(\"DEPTNO\") = 0 AS \"$g_0\" FROM \"EMP\" GROUP BY \"DEPTNO\") AS \"t4\" GROUP BY \"DEPTNO\""},{"index":292,"rewrite rule":"testExpandProjectIn","original query":"SELECT \"EMPNO\", \"DEPTNO\" IN (SELECT \"DEPTNO\" FROM \"EMP\" WHERE \"EMPNO\" < 20) AS \"D\" FROM \"EMP\"","rewritten query":"SELECT \"EMP1\".\"EMPNO\", CASE WHEN \"t5\".\"i\" IS NOT NULL THEN TRUE ELSE FALSE END AS \"D\" FROM \"EMP\" AS \"EMP1\" LEFT JOIN (SELECT \"t2\".\"DEPTNO\", \"t3\".\"i\" FROM (SELECT * FROM \"EMP\" WHERE \"EMPNO\" < 20) AS \"t2\", (VALUES (TRUE)) AS \"t3\" (\"i\") GROUP BY \"t2\".\"DEPTNO\", \"t3\".\"i\") AS \"t5\" ON \"EMP1\".\"DEPTNO\" = \"t5\".\"DEPTNO\""},{"index":293,"rewrite rule":"testPushCountStarGroupingSetsThroughUnion","original query":"SELECT \"DEPTNO\", \"JOB\", COUNT(*) FROM (SELECT * FROM \"EMP\" UNION ALL SELECT * FROM \"EMP\") AS \"t1\" GROUP BY ROLLUP(\"DEPTNO\", \"JOB\")","rewritten query":"SELECT \"DEPTNO\", \"JOB\", COALESCE(SUM(\"EXPR$2\"), 0) FROM (SELECT \"DEPTNO\", \"JOB\", COUNT(*) AS \"EXPR$2\" FROM \"EMP\" GROUP BY \"DEPTNO\", \"JOB\" UNION ALL SELECT \"DEPTNO\", \"JOB\", COUNT(*) AS \"EXPR$2\" FROM \"EMP\" GROUP BY \"DEPTNO\", \"JOB\") AS \"t8\" GROUP BY ROLLUP(\"DEPTNO\", \"JOB\")"},{"index":294,"rewrite rule":"testDistinctNonDistinctAggregates","original query":"SELECT \"EMP\".\"EMPNO\", COUNT(*), AVG(DISTINCT \"DEPT\".\"DEPTNO\") FROM \"EMP\" INNER JOIN \"DEPT\" ON \"EMP\".\"DEPTNO\" = \"DEPT\".\"DEPTNO\" GROUP BY \"EMP\".\"EMPNO\"","rewritten query":"SELECT \"t2\".\"EMPNO\", COALESCE(SUM(\"t2\".\"EXPR$1\"), 0), AVG(\"t2\".\"DEPTNO0\") FROM (SELECT \"EMP0\".\"EMPNO\", \"DEPT0\".\"DEPTNO\" AS \"DEPTNO0\", COUNT(*) AS \"EXPR$1\" FROM \"EMP\" AS \"EMP0\" INNER JOIN \"DEPT\" AS \"DEPT0\" ON \"EMP0\".\"DEPTNO\" = \"DEPT0\".\"DEPTNO\" GROUP BY \"EMP0\".\"EMPNO\", \"DEPT0\".\"DEPTNO\") AS \"t2\" GROUP BY \"t2\".\"EMPNO\""},{"index":295,"rewrite rule":"testOrAlwaysTrue2","original query":"SELECT * FROM (SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"SLACKER\" FROM \"EMPNULLABLES\" WHERE \"DEPTNO\" = 20 AND \"SAL\" > 1000) AS \"t0\" WHERE \"SAL\" IS NOT NULL OR \"SAL\" IS NULL","rewritten query":"SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"SLACKER\" FROM \"EMPNULLABLES\" WHERE \"DEPTNO\" = 20 AND \"SAL\" > 1000"},{"index":296,"rewrite rule":"testProjectWindowTransposeRuleWithConstants","original query":"SELECT SUM(100) OVER (PARTITION BY \"DEPTNO\" ORDER BY \"SAL\" RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS \"COL1\", SUM(1000) OVER (PARTITION BY \"DEPTNO\" ORDER BY \"SAL\" RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS \"COL2\" FROM \"EMP\"","rewritten query":"SELECT SUM(100) OVER (PARTITION BY \"DEPTNO\" ORDER BY \"SAL\" RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS \"$0\", SUM(1000) OVER (PARTITION BY \"DEPTNO\" ORDER BY \"SAL\" RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS \"$1\" FROM \"EMP\""},{"index":297,"rewrite rule":"testAggregateProjectPullUpConstants2","original query":"SELECT \"ENAME\", \"SAL\" FROM \"EMP\" WHERE \"ENAME\" = 'John' GROUP BY \"ENAME\", \"SAL\"","rewritten query":"SELECT 'John' AS \"ENAME\", \"SAL\" FROM \"EMP\" WHERE \"ENAME\" = 'John' GROUP BY \"SAL\""},{"index":298,"rewrite rule":"testDistinctNonDistinctAggregatesWithGrouping1","original query":"SELECT \"DEPTNO\", SUM(\"DEPTNO\"), SUM(DISTINCT \"SAL\"), MAX(\"DEPTNO\"), MAX(\"COMM\") FROM \"EMP\" GROUP BY \"DEPTNO\"","rewritten query":"SELECT \"DEPTNO\", SUM(\"EXPR$1\"), SUM(\"SAL\"), MAX(\"EXPR$3\"), MAX(\"EXPR$4\") FROM (SELECT \"DEPTNO\", \"SAL\", SUM(\"DEPTNO\") AS \"EXPR$1\", MAX(\"DEPTNO\") AS \"EXPR$3\", MAX(\"COMM\") AS \"EXPR$4\" FROM \"EMP\" GROUP BY \"DEPTNO\", \"SAL\") AS \"t2\" GROUP BY \"DEPTNO\""},{"index":299,"rewrite rule":"testDistinctNonDistinctAggregatesWithGrouping2","original query":"SELECT \"DEPTNO\", COUNT(*), SUM(DISTINCT \"SAL\") FROM \"EMP\" GROUP BY \"DEPTNO\"","rewritten query":"SELECT \"DEPTNO\", COALESCE(SUM(\"EXPR$1\"), 0), SUM(\"SAL\") FROM (SELECT \"DEPTNO\", \"SAL\", COUNT(*) AS \"EXPR$1\" FROM \"EMP\" GROUP BY \"DEPTNO\", \"SAL\") AS \"t2\" GROUP BY \"DEPTNO\""},{"index":300,"rewrite rule":"testReduceConstantsIsNotNull","original query":"SELECT \"EMPNO\" FROM \"EMP\" WHERE \"EMPNO\" = 10 AND \"EMPNO\" IS NOT NULL","rewritten query":"SELECT \"EMPNO\" FROM \"EMP\" WHERE \"EMPNO\" = 10"},{"index":301,"rewrite rule":"testJoinProjectTranspose1","original query":"SELECT \"t0\".\"NAME\" FROM (SELECT \"DEPT\".\"DEPTNO\", \"DEPT\".\"NAME\", \"t\".\"DEPTNO\" AS \"DEPTNO0\", \"t\".\"NAME\" AS \"NAME0\", \"t\".\"DEPTNO\" > 10 AS \"$f4\" FROM \"DEPT\" LEFT JOIN (SELECT \"DEPTNO\", \"NAME\", \"DEPTNO\" > 10 AS \"$f2\" FROM \"DEPT\") AS \"t\" ON \"t\".\"$f2\") AS \"t0\" RIGHT JOIN \"DEPT\" AS \"DEPT1\" ON \"t0\".\"$f4\"","rewritten query":"SELECT \"DEPT2\".\"NAME\" FROM \"DEPT\" AS \"DEPT2\" LEFT JOIN \"DEPT\" AS \"DEPT3\" ON \"DEPT3\".\"DEPTNO\" > 10 RIGHT JOIN \"DEPT\" AS \"DEPT4\" ON \"DEPT3\".\"DEPTNO\" > 10"},{"index":302,"rewrite rule":"testJoinProjectTranspose7","original query":"SELECT * FROM \"DEPT\" LEFT JOIN (SELECT \"NAME\" FROM \"DEPT\") AS \"t\" ON \"DEPT\".\"NAME\" = \"t\".\"NAME\"","rewritten query":"SELECT \"DEPT1\".\"DEPTNO\", \"DEPT1\".\"NAME\", \"DEPT2\".\"NAME\" AS \"NAME0\" FROM \"DEPT\" AS \"DEPT1\" LEFT JOIN \"DEPT\" AS \"DEPT2\" ON \"DEPT1\".\"NAME\" = \"DEPT2\".\"NAME\""},{"index":303,"rewrite rule":"testJoinProjectTranspose8","original query":"SELECT * FROM \"DEPT\" LEFT JOIN (SELECT \"NAME\", \"DEPTNO\" > 10 AND NULL AS \"EXPR$1\" FROM \"DEPT\") AS \"t\" ON \"DEPT\".\"NAME\" = \"t\".\"NAME\"","rewritten query":"SELECT \"DEPT1\".\"DEPTNO\", \"DEPT1\".\"NAME\", \"DEPT2\".\"NAME\" AS \"NAME0\", \"DEPT2\".\"DEPTNO\" > 10 AND NULL FROM \"DEPT\" AS \"DEPT1\" LEFT JOIN \"DEPT\" AS \"DEPT2\" ON \"DEPT1\".\"NAME\" = \"DEPT2\".\"NAME\""},{"index":304,"rewrite rule":"testPushMinGroupingSetsThroughUnion","original query":"SELECT \"DEPTNO\", \"JOB\", MIN(\"EMPNO\") FROM (SELECT * FROM \"EMP\" UNION ALL SELECT * FROM \"EMP\") AS \"t1\" GROUP BY ROLLUP(\"DEPTNO\", \"JOB\")","rewritten query":"SELECT \"DEPTNO\", \"JOB\", MIN(\"EXPR$2\") FROM (SELECT \"DEPTNO\", \"JOB\", MIN(\"EMPNO\") AS \"EXPR$2\" FROM \"EMP\" GROUP BY \"DEPTNO\", \"JOB\" UNION ALL SELECT \"DEPTNO\", \"JOB\", MIN(\"EMPNO\") AS \"EXPR$2\" FROM \"EMP\" GROUP BY \"DEPTNO\", \"JOB\") AS \"t8\" GROUP BY ROLLUP(\"DEPTNO\", \"JOB\")"},{"index":305,"rewrite rule":"testPullConstantThroughAggregateConstGroupBy","original query":"SELECT \"t\".\"EXPR$0\", 2 + 3 AS \"$f1\", MAX(\"EMP\".\"MGR\") FROM \"EMP\", (VALUES (4)) AS \"t\" (\"EXPR$0\") GROUP BY \"t\".\"EXPR$0\", 2 + 3","rewritten query":"SELECT \"t2\".\"EXPR$0\", 2 + 3, MAX(\"EMP0\".\"MGR\") FROM \"EMP\" AS \"EMP0\", (VALUES (4)) AS \"t2\" (\"EXPR$0\") GROUP BY \"t2\".\"EXPR$0\""},{"index":306,"rewrite rule":"testPushProjectPastJoin","original query":"SELECT \"EMP\".\"SAL\" + \"BONUS\".\"COMM\" FROM \"EMP\" INNER JOIN \"BONUS\" ON \"EMP\".\"ENAME\" = \"BONUS\".\"ENAME\" AND \"EMP\".\"DEPTNO\" = 10","rewritten query":"SELECT \"t0\".\"SAL\" + \"t1\".\"COMM\" FROM (SELECT \"ENAME\", \"SAL\", \"DEPTNO\" = 10 AS \"EXPR$0\" FROM \"EMP\") AS \"t0\" INNER JOIN (SELECT \"ENAME\", \"COMM\" FROM \"BONUS\") AS \"t1\" ON \"t0\".\"ENAME\" = \"t1\".\"ENAME\" AND \"t0\".\"EXPR$0\""},{"index":307,"rewrite rule":"testPullConstantThroughAggregatePermuted","original query":"SELECT \"EMP\".\"DEPTNO\", MAX(\"EMP\".\"MGR\") FROM \"EMP\", (VALUES (4)) AS \"t\" (\"FOUR\") GROUP BY \"EMP\".\"DEPTNO\", \"t\".\"FOUR\", 2 + 3, \"EMP\".\"DEPTNO\" + 42","rewritten query":"SELECT \"DEPTNO\", MAX(\"MGR\") FROM \"EMP\" GROUP BY \"DEPTNO\", \"DEPTNO\" + 42"},{"index":308,"rewrite rule":"testEmptyIntersect","original query":"SELECT * FROM (SELECT * FROM (VALUES (30, 3)) AS \"t\" (\"EXPR$0\", \"EXPR$1\") INTERSECT SELECT * FROM (VALUES (10, 1), (30, 3)) AS \"t1\" (\"X\", \"Y\") WHERE \"X\" > 50) AS \"t\" INTERSECT SELECT * FROM (VALUES (30, 3)) AS \"t\" (\"EXPR$0\", \"EXPR$1\")","rewritten query":"SELECT * FROM (VALUES (NULL, NULL)) AS \"t\" (\"EXPR$0\", \"EXPR$1\") WHERE 1 = 0"},{"index":309,"rewrite rule":"testPushProjectPastRightJoinSwap","original query":"SELECT COUNT(*), CASE WHEN \"EMP\".\"SAL\" < 11 THEN 11 ELSE -1 * \"EMP\".\"SAL\" END FROM \"BONUS\" RIGHT JOIN \"EMP\" ON \"BONUS\".\"ENAME\" = \"EMP\".\"ENAME\" GROUP BY CASE WHEN \"EMP\".\"SAL\" < 11 THEN 11 ELSE -1 * \"EMP\".\"SAL\" END","rewritten query":"SELECT COUNT(*), \"t3\".\"EXPR$1\" FROM (SELECT \"ENAME\" FROM \"BONUS\") AS \"t2\" RIGHT JOIN (SELECT \"ENAME\", CASE WHEN \"SAL\" < 11 THEN 11 ELSE -1 * \"SAL\" END AS \"EXPR$1\" FROM \"EMP\") AS \"t3\" ON \"t2\".\"ENAME\" = \"t3\".\"ENAME\" GROUP BY \"t3\".\"EXPR$1\""},{"index":310,"rewrite rule":"testExpandJoinExists","original query":"SELECT \"EMP\".\"EMPNO\" FROM \"EMP\" LEFT JOIN \"DEPT\" ON EXISTS (SELECT * FROM \"EMP\" WHERE \"EMPNO\" < 20)","rewritten query":"SELECT \"EMP1\".\"EMPNO\" FROM \"EMP\" AS \"EMP1\" LEFT JOIN (\"DEPT\" AS \"DEPT0\" CROSS JOIN (SELECT \"t2\".\"i\" FROM (SELECT * FROM \"EMP\" WHERE \"EMPNO\" < 20) AS \"t1\", (VALUES (TRUE)) AS \"t2\" (\"i\") GROUP BY \"t2\".\"i\") AS \"t4\") ON TRUE"},{"index":311,"rewrite rule":"testPullConstantIntoProject","original query":"SELECT \"DEPTNO\", \"DEPTNO\" + 1, \"EMPNO\" + \"DEPTNO\" FROM \"EMP\" WHERE \"DEPTNO\" = 10","rewritten query":"SELECT 10 AS \"DEPTNO\", 11, \"EMPNO\" + 10 FROM \"EMP\" WHERE \"DEPTNO\" = 10"},{"index":312,"rewrite rule":"testTransitiveInferenceUnionAlwaysTrue","original query":"SELECT * FROM (SELECT \"DEPTNO\" FROM \"EMP\" WHERE \"DEPTNO\" < 4) AS \"t0\" INNER JOIN (SELECT \"DEPTNO\" FROM \"EMP\" WHERE \"DEPTNO\" > 7 UNION ALL SELECT \"DEPTNO\" FROM \"EMP\") AS \"t4\" ON \"t0\".\"DEPTNO\" = \"t4\".\"DEPTNO\"","rewritten query":"SELECT * FROM (SELECT \"DEPTNO\" FROM \"EMP\" WHERE \"DEPTNO\" < 4) AS \"t7\" INNER JOIN (SELECT * FROM (SELECT \"DEPTNO\" FROM \"EMP\" WHERE \"DEPTNO\" > 7 UNION ALL SELECT \"DEPTNO\" FROM \"EMP\") AS \"t11\" WHERE \"DEPTNO\" < 4) AS \"t12\" ON \"t7\".\"DEPTNO\" = \"t12\".\"DEPTNO\""},{"index":313,"rewrite rule":"testReduceCompositeInSubQuery","original query":"SELECT * FROM \"EMP\" WHERE (\"EMPNO\", \"DEPTNO\") IN (SELECT \"EMPNO\", \"DEPTNO\" FROM \"EMP\" GROUP BY \"EMPNO\", \"DEPTNO\") OR \"DEPTNO\" < 40 + 60","rewritten query":"SELECT * FROM \"EMP\" WHERE (\"EMPNO\", \"DEPTNO\") IN (SELECT \"EMPNO\", \"DEPTNO\" FROM \"EMP\" GROUP BY \"EMPNO\", \"DEPTNO\") OR \"DEPTNO\" < 100"},{"index":314,"rewrite rule":"testProjectAggregateMergeSum0","original query":"SELECT CASE WHEN SUM(\"SAL\") IS NOT NULL THEN CAST(SUM(\"SAL\") AS INTEGER) ELSE 0 END AS \"SS0\" FROM \"EMP\"","rewritten query":"SELECT COALESCE(SUM(\"SAL\"), 0) AS \"$f0\" FROM \"EMP\""},{"index":315,"rewrite rule":"testMergeIntersect","original query":"SELECT * FROM (SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 10 INTERSECT SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 20) AS \"t\" INTERSECT SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 30","rewritten query":"SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 10 INTERSECT SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 20 INTERSECT SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 30"},{"index":316,"rewrite rule":"testPushSumConstantThroughUnion","original query":"SELECT \"ENAME\", SUM(\"U\") FROM (SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\", 2 AS \"U\" FROM \"EMP\" UNION ALL SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\", 3 AS \"U\" FROM \"EMP\") AS \"t1\" GROUP BY \"ENAME\"","rewritten query":"SELECT \"ENAME\", SUM(\"EXPR$1\") FROM (SELECT \"ENAME\", SUM(2) AS \"EXPR$1\" FROM \"EMP\" GROUP BY \"ENAME\" UNION ALL SELECT \"ENAME\", SUM(3) AS \"EXPR$1\" FROM \"EMP\" GROUP BY \"ENAME\") AS \"t8\" GROUP BY \"ENAME\""},{"index":317,"rewrite rule":"testProjectCorrelateTransposeRuleLeftCorrelate","original query":"SELECT \"$cor0\".\"EMPNO\" FROM \"EMP\" AS \"$cor0\", LATERAL (SELECT MIN(TRUE) AS \"$f0\" FROM \"DEPT\" WHERE \"$cor0\".\"DEPTNO\" = \"DEPTNO\") AS \"t1\" WHERE \"$cor0\".\"$f0\" IS NOT NULL","rewritten query":"SELECT \"EMPNO\" FROM (SELECT \"$cor2\".\"EMPNO\", \"$cor2\".\"$f0\" FROM (SELECT \"EMPNO\", \"DEPTNO\" FROM \"EMP\") AS \"$cor2\", LATERAL (SELECT MIN(TRUE) AS \"$f0\" FROM (SELECT \"DEPTNO\" FROM \"DEPT\") AS \"t5\" WHERE \"$cor2\".\"DEPTNO\" = \"DEPTNO\") AS \"t9\") AS \"t10\" WHERE \"t10\".\"$f0\" IS NOT NULL"},{"index":318,"rewrite rule":"testExpandProjectExists","original query":"SELECT \"EMPNO\", EXISTS (SELECT * FROM \"EMP\" WHERE \"EMPNO\" < 20) AS \"D\" FROM \"EMP\"","rewritten query":"SELECT \"EMP1\".\"EMPNO\", \"t4\".\"i\" IS NOT NULL AS \"D\" FROM \"EMP\" AS \"EMP1\" LEFT JOIN (SELECT \"t2\".\"i\" FROM (SELECT * FROM \"EMP\" WHERE \"EMPNO\" < 20) AS \"t1\", (VALUES (TRUE)) AS \"t2\" (\"i\") GROUP BY \"t2\".\"i\") AS \"t4\" ON TRUE"},{"index":319,"rewrite rule":"testRemoveSemiJoinWithFilter","original query":"SELECT \"EMP\".\"ENAME\" FROM \"EMP\", \"DEPT\" WHERE \"EMP\".\"DEPTNO\" = \"DEPT\".\"DEPTNO\" AND \"EMP\".\"ENAME\" = 'foo'","rewritten query":"SELECT \"t1\".\"ENAME\" FROM (SELECT * FROM \"EMP\" WHERE \"ENAME\" = 'foo') AS \"t1\" INNER JOIN \"DEPT\" AS \"DEPT0\" ON \"t1\".\"DEPTNO\" = \"DEPT0\".\"DEPTNO\""},{"index":320,"rewrite rule":"testSortJoinCopyInnerJoinOrderByLimit","original query":"SELECT * FROM \"EMP\" INNER JOIN (SELECT * FROM \"DEPT\") AS \"t\" ON \"EMP\".\"DEPTNO\" = \"t\".\"DEPTNO\" ORDER BY \"EMP\".\"SAL\" FETCH NEXT 10 ROWS ONLY","rewritten query":"SELECT \"t2\".\"EMPNO\", \"t2\".\"ENAME\", \"t2\".\"JOB\", \"t2\".\"MGR\", \"t2\".\"HIREDATE\", \"t2\".\"SAL\", \"t2\".\"COMM\", \"t2\".\"DEPTNO\", \"t2\".\"SLACKER\", \"t3\".\"DEPTNO\" AS \"DEPTNO0\", \"t3\".\"NAME\" FROM (SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\" FROM \"EMP\" ORDER BY \"SAL\") AS \"t2\" INNER JOIN (SELECT * FROM \"DEPT\") AS \"t3\" ON \"t2\".\"DEPTNO\" = \"t3\".\"DEPTNO\" ORDER BY \"t2\".\"SAL\" FETCH NEXT 10 ROWS ONLY"},{"index":321,"rewrite rule":"testRightOuterJoinSimplificationToInner","original query":"SELECT 1 FROM \"DEPT\" RIGHT JOIN \"EMP\" ON \"DEPT\".\"DEPTNO\" = \"EMP\".\"DEPTNO\" WHERE \"DEPT\".\"NAME\" = 'Charlie'","rewritten query":"SELECT 1 FROM (SELECT * FROM \"DEPT\" WHERE \"NAME\" = 'Charlie') AS \"t1\" INNER JOIN \"EMP\" AS \"EMP0\" ON \"t1\".\"DEPTNO\" = \"EMP0\".\"DEPTNO\""},{"index":322,"rewrite rule":"testDistinctCountMixed","original query":"SELECT \"DEPTNO\", COUNT(DISTINCT \"DEPTNO\", \"JOB\") AS \"CDDJ\", SUM(\"SAL\") AS \"S\" FROM \"EMP\" GROUP BY \"DEPTNO\"","rewritten query":"SELECT \"DEPTNO\", COUNT(\"DEPTNO\", \"JOB\") FILTER (WHERE \"$g_0\") AS \"CDDJ\", CAST(MIN(\"S\") FILTER (WHERE \"$g_1\") AS INTEGER) AS \"S\" FROM (SELECT \"DEPTNO\", \"JOB\", SUM(\"SAL\") AS \"S\", GROUPING(\"DEPTNO\", \"JOB\") = 0 AS \"$g_0\", GROUPING(\"DEPTNO\", \"JOB\") = 1 AS \"$g_1\" FROM \"EMP\" GROUP BY GROUPING SETS((\"DEPTNO\", \"JOB\"), \"DEPTNO\")) AS \"t3\" GROUP BY \"DEPTNO\""},{"index":323,"rewrite rule":"testPushFilterSemijoin","original query":"SELECT \"NAME\" FROM \"DEPT\" WHERE EXISTS (SELECT 1 FROM \"EMP\" WHERE \"DEPT\".\"DEPTNO\" = \"EMP\".\"DEPTNO\" AND \"EMP\".\"SAL\" = 100)","rewritten query":"SELECT \"NAME\" FROM (SELECT * FROM \"DEPT\" WHERE EXISTS (SELECT 1 FROM (SELECT * FROM \"EMP\" WHERE \"SAL\" = 100) AS \"t0\" WHERE * = \"t0\".\"DEPTNO\")) AS \"DEPT0\""},{"index":324,"rewrite rule":"testPushJoinCondDownToProject","original query":"SELECT \"DEPT\".\"DEPTNO\", \"EMP\".\"DEPTNO\" AS \"DEPTNO0\" FROM \"DEPT\", \"EMP\" WHERE \"DEPT\".\"DEPTNO\" + 10 = \"EMP\".\"DEPTNO\" * 2","rewritten query":"SELECT \"t1\".\"DEPTNO\", \"t2\".\"DEPTNO\" AS \"DEPTNO0\" FROM (SELECT \"DEPTNO\", \"NAME\", \"DEPTNO\" + 10 AS \"$f2\" FROM \"DEPT\") AS \"t1\" INNER JOIN (SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\", \"DEPTNO\" * 2 AS \"$f9\" FROM \"EMP\") AS \"t2\" ON \"t1\".\"$f2\" = \"t2\".\"$f9\""},{"index":325,"rewrite rule":"testWithinDistinctUniformDistinctKeysNoThrow","original query":"SELECT \"DEPTNO\", SUM(\"SAL\"), AVG(\"COMM\") FROM \"EMP\" GROUP BY \"DEPTNO\"","rewritten query":"SELECT \"DEPTNO\", COALESCE(SUM(\"$f2\"), 0), CAST(COALESCE(SUM(\"$f3\"), 0) \/ COUNT(*) AS INTEGER) FROM (SELECT \"DEPTNO\", \"JOB\", MIN(\"SAL\") AS \"$f2\", MIN(\"COMM\") AS \"$f3\" FROM \"EMP\" GROUP BY \"DEPTNO\", \"JOB\") AS \"t2\" GROUP BY \"DEPTNO\""},{"index":326,"rewrite rule":"testRemoveSemiJoinRightWithFilter","original query":"SELECT \"EMP\".\"ENAME\" FROM \"EMP\", \"DEPT\", \"EMP\" AS \"EMP0\" WHERE \"EMP\".\"DEPTNO\" = \"DEPT\".\"DEPTNO\" AND \"DEPT\".\"DEPTNO\" = \"EMP0\".\"DEPTNO\" AND \"DEPT\".\"NAME\" = 'foo'","rewritten query":"SELECT \"EMP1\".\"ENAME\" FROM \"EMP\" AS \"EMP1\" INNER JOIN (SELECT * FROM \"DEPT\" WHERE \"NAME\" = 'foo') AS \"t1\" ON \"EMP1\".\"DEPTNO\" = \"t1\".\"DEPTNO\" INNER JOIN \"EMP\" AS \"EMP2\" ON \"t1\".\"DEPTNO\" = \"EMP2\".\"DEPTNO\""},{"index":327,"rewrite rule":"testFullOuterJoinSimplificationToLeftOuter","original query":"SELECT 1 FROM \"DEPT\" FULL JOIN \"EMP\" ON \"DEPT\".\"DEPTNO\" = \"EMP\".\"DEPTNO\" WHERE \"DEPT\".\"NAME\" = 'Charlie'","rewritten query":"SELECT 1 FROM (SELECT * FROM \"DEPT\" WHERE \"NAME\" = 'Charlie') AS \"t1\" LEFT JOIN \"EMP\" AS \"EMP0\" ON \"t1\".\"DEPTNO\" = \"EMP0\".\"DEPTNO\""},{"index":328,"rewrite rule":"testGroupByMultipleLiterals","original query":"SELECT AVG(\"EMP\".\"SAL\") FROM \"EMP\", (VALUES (FALSE, TRUE, 'ab', DATE '2022-01-01')) AS \"t\" (\"$f0\", \"$f2\", \"$f4\", \"$f5\") GROUP BY \"t\".\"$f0\", \"EMP\".\"DEPTNO\", \"t\".\"$f2\", \"EMP\".\"EMPNO\", \"t\".\"$f4\", \"t\".\"$f5\"","rewritten query":"SELECT AVG(\"EMP0\".\"SAL\") FROM \"EMP\" AS \"EMP0\", (VALUES (FALSE, TRUE, 'ab', DATE '2022-01-01')) AS \"t3\" (\"$f0\", \"$f2\", \"$f4\", \"$f5\") GROUP BY \"t3\".\"$f0\", \"EMP0\".\"DEPTNO\", \"t3\".\"$f2\", \"EMP0\".\"EMPNO\", \"t3\".\"$f4\", \"t3\".\"$f5\""},{"index":329,"rewrite rule":"testSortJoinCopySemiJoinOrderByOffset","original query":"SELECT \"DEPT\".\"DEPTNO\", \"DEPT\".\"NAME\" FROM \"DEPT\" INNER JOIN (SELECT \"DEPTNO\" FROM \"EMP\" GROUP BY \"DEPTNO\") AS \"t0\" ON \"DEPT\".\"DEPTNO\" = \"t0\".\"DEPTNO\" ORDER BY \"DEPT\".\"DEPTNO\" OFFSET 2 ROWS","rewritten query":"SELECT * FROM (SELECT \"DEPTNO\", \"NAME\" FROM \"DEPT\" WHERE EXISTS (SELECT 1 FROM (SELECT \"DEPTNO\" FROM \"EMP\") AS \"t4\" WHERE \"DEPTNO\" = \"t4\".\"DEPTNO\") ORDER BY \"DEPTNO\") AS \"t3\" ORDER BY \"DEPTNO\" OFFSET 2 ROWS"},{"index":330,"rewrite rule":"testPullConstantThroughAggregatePermutedConstFirst","original query":"SELECT \"EMP\".\"DEPTNO\", MAX(\"EMP\".\"MGR\") FROM \"EMP\", (VALUES (4)) AS \"t\" (\"FOUR\") GROUP BY \"t\".\"FOUR\", \"EMP\".\"DEPTNO\"","rewritten query":"SELECT \"DEPTNO\", MAX(\"MGR\") FROM \"EMP\" GROUP BY \"DEPTNO\""},{"index":331,"rewrite rule":"testTransitiveInferenceUnion","original query":"SELECT 1 FROM (SELECT \"DEPTNO\" FROM \"EMP\" WHERE \"DEPTNO\" > 7 UNION ALL SELECT \"DEPTNO\" FROM \"EMP\" WHERE \"DEPTNO\" > 10) AS \"t3\" INNER JOIN \"EMP\" AS \"EMP1\" ON \"t3\".\"DEPTNO\" = \"EMP1\".\"DEPTNO\"","rewritten query":"SELECT 1 FROM (SELECT \"DEPTNO\" FROM \"EMP\" WHERE \"DEPTNO\" > 7 UNION ALL SELECT \"DEPTNO\" FROM \"EMP\" WHERE \"DEPTNO\" > 10) AS \"t9\" INNER JOIN (SELECT * FROM \"EMP\" WHERE \"DEPTNO\" > 7) AS \"t10\" ON \"t9\".\"DEPTNO\" = \"t10\".\"DEPTNO\""},{"index":332,"rewrite rule":"testPullAggregateThroughUnionAndAddProjects","original query":"SELECT \"JOB\", \"DEPTNO\" FROM (SELECT \"JOB\", \"DEPTNO\" FROM \"EMP\" GROUP BY \"JOB\", \"DEPTNO\" UNION ALL SELECT \"JOB\", \"DEPTNO\" FROM \"EMP\" GROUP BY \"JOB\", \"DEPTNO\") AS \"t3\" GROUP BY \"JOB\", \"DEPTNO\"","rewritten query":"SELECT \"JOB\", \"DEPTNO\" FROM (SELECT \"JOB\", \"DEPTNO\" FROM \"EMP\" UNION ALL SELECT \"JOB\", \"DEPTNO\" FROM \"EMP\") AS \"t7\" GROUP BY \"JOB\", \"DEPTNO\""},{"index":333,"rewrite rule":"testPullConstantIntoJoin","original query":"SELECT * FROM (SELECT * FROM \"EMP\" WHERE \"EMPNO\" = 10) AS \"t0\" LEFT JOIN \"DEPT\" ON \"t0\".\"EMPNO\" = \"DEPT\".\"DEPTNO\"","rewritten query":"SELECT * FROM (SELECT * FROM \"EMP\" WHERE \"EMPNO\" = 10) AS \"t3\" LEFT JOIN (SELECT * FROM \"DEPT\" WHERE \"DEPTNO\" = 10) AS \"t4\" ON TRUE"},{"index":334,"rewrite rule":"testReduceConstantsCaseEquals2","original query":"SELECT COUNT(*) FROM \"EMP\" WHERE CASE WHEN \"DEPTNO\" = 20 THEN 2 WHEN \"DEPTNO\" = 10 THEN 1 ELSE NULL END = 1","rewritten query":"SELECT COUNT(*) FROM \"EMP\" WHERE \"DEPTNO\" = 10"},{"index":335,"rewrite rule":"testReduceConstantsCaseEquals3","original query":"SELECT COUNT(*) FROM \"EMP\" WHERE CASE WHEN \"DEPTNO\" = 30 THEN 1 WHEN \"DEPTNO\" = 20 THEN 2 WHEN \"DEPTNO\" = 10 THEN 1 WHEN \"DEPTNO\" = 30 THEN 111 ELSE 0 END = 1","rewritten query":"SELECT COUNT(*) FROM \"EMP\" WHERE \"DEPTNO\" IN (10, 30)"},{"index":336,"rewrite rule":"testAggregateUnionTransposeWithTopLevelGroupSetRemapping","original query":"SELECT COUNT(\"T1\"), \"T2\" FROM (SELECT CASE WHEN \"DEPTNO\" = 0 THEN 1 ELSE NULL END AS \"T1\", 1 AS \"T2\" FROM \"EMP\" UNION ALL SELECT CASE WHEN \"DEPTNO\" = 0 THEN 1 ELSE NULL END AS \"T1\", 2 AS \"T2\" FROM \"EMP\") AS \"t1\" GROUP BY \"T2\"","rewritten query":"SELECT COALESCE(SUM(\"EXPR$0\"), 0), \"T2\" FROM (SELECT \"t5\".\"T2\", COUNT(CASE WHEN \"EMP1\".\"DEPTNO\" = 0 THEN 1 ELSE NULL END) AS \"EXPR$0\" FROM \"EMP\" AS \"EMP1\", (VALUES (1)) AS \"t5\" (\"T2\") GROUP BY \"t5\".\"T2\" UNION ALL SELECT \"t8\".\"T2\", COUNT(CASE WHEN \"EMP2\".\"DEPTNO\" = 0 THEN 1 ELSE NULL END) AS \"EXPR$0\" FROM \"EMP\" AS \"EMP2\", (VALUES (2)) AS \"t8\" (\"T2\") GROUP BY \"t8\".\"T2\") AS \"t11\" GROUP BY \"T2\""},{"index":337,"rewrite rule":"testPushProjectPastFilter3b","original query":"SELECT \"EMPNO\" + \"DEPTNO\" AS \"X\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"SLACKER\" FROM \"EMP\" WHERE \"SAL\" = 10 * \"COMM\" AND UPPER(\"ENAME\") = 'FOO'","rewritten query":"SELECT \"$f8\" AS \"X\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"SLACKER\" FROM (SELECT \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"SLACKER\", \"SAL\" = 10 * \"COMM\" AND UPPER(\"ENAME\") = 'FOO' AS \"$f7\", \"EMPNO\" + \"DEPTNO\" AS \"$f8\" FROM \"EMP\") AS \"t1\" WHERE \"$f7\""},{"index":338,"rewrite rule":"testPushProjectPastFilter3c","original query":"SELECT \"EMPNO\" + \"DEPTNO\" AS \"X\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"SLACKER\" FROM \"EMP\" WHERE \"SAL\" = 10 * \"COMM\" AND UPPER(\"ENAME\") = 'FOO'","rewritten query":"SELECT \"$f7\" AS \"X\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"SLACKER\" FROM (SELECT \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"SLACKER\", \"EMPNO\" + \"DEPTNO\" AS \"$f7\" FROM \"EMP\") AS \"t1\" WHERE \"SAL\" = 10 * \"COMM\" AND UPPER(\"ENAME\") = 'FOO'"},{"index":339,"rewrite rule":"testExpandJoinScalar","original query":"SELECT \"EMP\".\"EMPNO\" FROM \"EMP\" LEFT JOIN \"DEPT\" ON (((SELECT \"DEPTNO\" FROM \"EMP\" WHERE \"EMPNO\" < 20))) < (((SELECT \"DEPTNO\" FROM \"EMP\" WHERE \"EMPNO\" > 100)))","rewritten query":"SELECT \"EMP2\".\"EMPNO\" FROM \"EMP\" AS \"EMP2\" LEFT JOIN (\"DEPT\" AS \"DEPT0\" LEFT JOIN (SELECT SINGLE_VALUE(\"DEPTNO\") AS \"$f0\" FROM \"EMP\" WHERE \"EMPNO\" < 20) AS \"t6\" ON TRUE LEFT JOIN (SELECT SINGLE_VALUE(\"DEPTNO\") AS \"$f0\" FROM \"EMP\" WHERE \"EMPNO\" > 100) AS \"t9\" ON TRUE) ON \"t6\".\"$f0\" < \"t9\".\"$f0\""},{"index":340,"rewrite rule":"testPullConstantThroughAggregateAllLiterals","original query":"SELECT \"t\".\"EXPR$0\", 2 + 3 AS \"$f1\", MAX(\"t\".\"$f2\") FROM \"EMP\", (VALUES (4, 5)) AS \"t\" (\"EXPR$0\", \"$f2\") GROUP BY \"t\".\"EXPR$0\", 2 + 3","rewritten query":"SELECT \"t2\".\"EXPR$0\", 2 + 3, MAX(\"t2\".\"$f2\") FROM \"EMP\" AS \"EMP0\", (VALUES (4, 5)) AS \"t2\" (\"EXPR$0\", \"$f2\") GROUP BY \"t2\".\"EXPR$0\""},{"index":341,"rewrite rule":"testSwapOuterJoin","original query":"SELECT 1 FROM \"DEPT\" LEFT JOIN \"EMP\" ON \"DEPT\".\"DEPTNO\" = \"EMP\".\"DEPTNO\"","rewritten query":"SELECT 1 FROM \"EMP\" AS \"EMP0\" RIGHT JOIN \"DEPT\" AS \"DEPT0\" ON \"EMP0\".\"DEPTNO\" = \"DEPT0\".\"DEPTNO\""},{"index":342,"rewrite rule":"testPushJoinThroughUnionOnLeft","original query":"SELECT \"t1\".\"SAL\" FROM (SELECT * FROM \"EMP\" UNION ALL SELECT * FROM \"EMP\") AS \"t1\", \"EMP\" AS \"EMP1\"","rewritten query":"SELECT \"SAL\" FROM (SELECT * FROM (SELECT * FROM \"EMP\") AS \"t3\", \"EMP\" AS \"EMP3\" UNION ALL SELECT * FROM (SELECT * FROM \"EMP\") AS \"t4\", \"EMP\" AS \"EMP5\") AS \"t5\""},{"index":343,"rewrite rule":"testMergeUnionMixed2","original query":"SELECT * FROM (SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 10 UNION ALL SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 20) AS \"t\" UNION SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 30","rewritten query":"SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 10 UNION SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 20 UNION SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 30"},{"index":344,"rewrite rule":"testReduceConstantsEliminatesFilter","original query":"SELECT * FROM (VALUES (1, 2)) AS \"t\" (\"EXPR$0\", \"EXPR$1\") WHERE 1 + 2 > 3 + NULL","rewritten query":"SELECT * FROM (VALUES (NULL, NULL)) AS \"t\" (\"EXPR$0\", \"EXPR$1\") WHERE 1 = 0"},{"index":345,"rewrite rule":"testExpandFilterExists","original query":"SELECT \"EMPNO\" FROM \"EMP\" WHERE EXISTS (SELECT * FROM \"EMP\" WHERE \"EMPNO\" < 20) OR \"SAL\" < 100","rewritten query":"SELECT \"EMP1\".\"EMPNO\" FROM \"EMP\" AS \"EMP1\" LEFT JOIN (SELECT \"t3\".\"i\" FROM (SELECT * FROM \"EMP\" WHERE \"EMPNO\" < 20) AS \"t2\", (VALUES (TRUE)) AS \"t3\" (\"i\") GROUP BY \"t3\".\"i\") AS \"t5\" ON TRUE WHERE \"t5\".\"i\" IS NOT NULL OR \"EMP1\".\"SAL\" < 100"},{"index":346,"rewrite rule":"testAggregateProjectPullUpConstants","original query":"SELECT \"JOB\", \"EMPNO\", \"SAL\", SUM(\"SAL\") AS \"S\" FROM \"EMP\" WHERE \"EMPNO\" = 10 GROUP BY \"JOB\", \"EMPNO\", \"SAL\"","rewritten query":"SELECT \"JOB\", 10 AS \"EMPNO\", \"SAL\", SUM(\"SAL\") AS \"S\" FROM \"EMP\" WHERE \"EMPNO\" = 10 GROUP BY \"JOB\", \"SAL\""},{"index":347,"rewrite rule":"testPushProjectPastFilter2","original query":"SELECT COUNT(*) FROM \"EMP\" WHERE CASE WHEN \"MGR\" < 10 THEN TRUE ELSE FALSE END","rewritten query":"SELECT COUNT(*) FROM (SELECT \"MGR\" FROM \"EMP\") AS \"t2\" WHERE \"MGR\" < 10"},{"index":348,"rewrite rule":"testSemiJoinReduceConstants","original query":"SELECT \"t0\".\"SAL\" FROM (SELECT * FROM (SELECT \"SAL\", \"DEPTNO\" FROM \"EMP\") AS \"t\" WHERE \"DEPTNO\" = 200) AS \"t0\" INNER JOIN (SELECT \"DEPTNO\" FROM (SELECT \"SAL\", \"DEPTNO\" FROM \"EMP\") AS \"t1\" WHERE \"SAL\" = 100 GROUP BY \"DEPTNO\") AS \"t4\" ON \"t0\".\"DEPTNO\" = \"t4\".\"DEPTNO\"","rewritten query":"SELECT \"SAL\" FROM (SELECT * FROM (SELECT \"SAL\", \"DEPTNO\" FROM \"EMP\") AS \"t6\" WHERE \"DEPTNO\" = 200 AND EXISTS (SELECT 1 FROM (SELECT \"DEPTNO\" FROM (SELECT \"SAL\", \"DEPTNO\" FROM \"EMP\") AS \"t8\" WHERE \"SAL\" = 100) AS \"t10\" WHERE 200 = \"t10\".\"DEPTNO\")) AS \"t7\""},{"index":349,"rewrite rule":"testExpandProjectScalar","original query":"SELECT \"EMPNO\", (((SELECT \"DEPTNO\" FROM \"EMP\" WHERE \"EMPNO\" < 20))) AS \"D\" FROM \"EMP\"","rewritten query":"SELECT \"EMP1\".\"EMPNO\", \"t4\".\"$f0\" AS \"D\" FROM \"EMP\" AS \"EMP1\" LEFT JOIN (SELECT SINGLE_VALUE(\"DEPTNO\") AS \"$f0\" FROM \"EMP\" WHERE \"EMPNO\" < 20) AS \"t4\" ON TRUE"},{"index":350,"rewrite rule":"testFilterProjectTranspose","original query":"SELECT \"$cor0\".\"EMPNO\" FROM \"EMP\" AS \"$cor0\", LATERAL (SELECT MIN(TRUE) AS \"$f0\" FROM (SELECT \"DEPTNO\" * 2 AS \"TWICEDEPTNO\" FROM \"DEPT\") AS \"t\" WHERE \"$cor0\".\"DEPTNO\" = \"TWICEDEPTNO\") AS \"t2\" WHERE \"$cor0\".\"$f0\" IS NOT NULL","rewritten query":"SELECT \"$cor0\".\"EMPNO\" FROM \"EMP\" AS \"$cor0\", LATERAL (SELECT MIN(TRUE) AS \"$f0\" FROM \"DEPT\" WHERE \"$cor0\".\"DEPTNO\" = \"DEPTNO\" * 2) AS \"t8\" WHERE \"$cor0\".\"$f0\" IS NOT NULL"},{"index":351,"rewrite rule":"testProjectCorrelateTransposeRuleSemiCorrelate","original query":"SELECT \"$cor0\".\"f\" FROM (VALUES ('1', '2')) AS \"$cor0\" (\"f\", \"f2\"), LATERAL (SELECT \"f3\", \"$cor0\".\"f\" AS \"$f1\" FROM (VALUES ('1', '2')) AS \"t\" (\"f3\", \"f4\")) AS \"t1\"","rewritten query":"SELECT * FROM (SELECT \"f\" FROM (VALUES ('1', '2')) AS \"t\" (\"f\", \"f2\")) AS \"$cor0\", LATERAL (SELECT FROM (VALUES ('1', '2')) AS \"t\" (\"f3\", \"f4\")) AS \"t7\""},{"index":352,"rewrite rule":"testWithinDistinctFilteredAggsUniformDistinctKeysNoThrow","original query":"SELECT \"DEPTNO\", SUM(\"SAL\") FILTER (WHERE \"COMM\" > 10), AVG(\"COMM\") FILTER (WHERE \"ENAME\" LIKE '%ok%') FROM \"EMP\" GROUP BY \"DEPTNO\"","rewritten query":"SELECT \"DEPTNO\", CASE WHEN (COUNT(*) FILTER (WHERE \"$f6\")) = 0 THEN NULL ELSE COALESCE(SUM(\"$f2\") FILTER (WHERE \"$f6\"), 0) END, CAST(CASE WHEN (COUNT(*) FILTER (WHERE \"$f7\")) = 0 THEN NULL ELSE COALESCE(SUM(\"$f4\") FILTER (WHERE \"$f7\"), 0) END \/ (COUNT(*) FILTER (WHERE \"$f7\")) AS INTEGER) FROM (SELECT \"DEPTNO\", MIN(\"SAL\") FILTER (WHERE \"COMM\" > 10) AS \"$f2\", MIN(\"COMM\") FILTER (WHERE \"ENAME\" LIKE '%ok%') AS \"$f4\", (COUNT(*) FILTER (WHERE \"COMM\" > 10)) > 0 AS \"$f6\", (COUNT(*) FILTER (WHERE \"ENAME\" LIKE '%ok%')) > 0 AS \"$f7\" FROM \"EMP\" GROUP BY \"DEPTNO\", \"JOB\") AS \"t3\" GROUP BY \"DEPTNO\""},{"index":353,"rewrite rule":"testDistinctCountWithoutGroupBy","original query":"SELECT MAX(\"DEPTNO\"), COUNT(DISTINCT \"ENAME\") FROM \"EMP\"","rewritten query":"SELECT MIN(\"EXPR$0\") FILTER (WHERE \"$g_1\"), COUNT(\"ENAME\") FILTER (WHERE \"$g_0\") FROM (SELECT \"ENAME\", MAX(\"DEPTNO\") AS \"EXPR$0\", GROUPING(\"ENAME\") = 0 AS \"$g_0\", GROUPING(\"ENAME\") = 1 AS \"$g_1\" FROM \"EMP\" GROUP BY ROLLUP(\"ENAME\")) AS \"t2\""},{"index":354,"rewrite rule":"testDecorrelateUncorrelatedInAndCorrelatedExists","original query":"SELECT * FROM \"EMP\" WHERE \"JOB\" IN (SELECT \"JOB\" FROM \"EMP\" WHERE \"SAL\" = 34) AND EXISTS (SELECT * FROM \"EMP\" WHERE \"EMP\".\"DEPTNO\" = \"DEPTNO\")","rewritten query":"SELECT \"EMP2\".\"EMPNO\", \"EMP2\".\"ENAME\", \"EMP2\".\"JOB\", \"EMP2\".\"MGR\", \"EMP2\".\"HIREDATE\", \"EMP2\".\"SAL\", \"EMP2\".\"COMM\", \"EMP2\".\"DEPTNO\", \"EMP2\".\"SLACKER\" FROM \"EMP\" AS \"EMP2\" INNER JOIN (SELECT \"JOB\" FROM \"EMP\" WHERE \"SAL\" = 34 GROUP BY \"JOB\") AS \"t6\" ON \"EMP2\".\"JOB\" = \"t6\".\"JOB\" INNER JOIN (SELECT \"DEPTNO\", TRUE AS \"$f1\" FROM \"EMP\" GROUP BY \"DEPTNO\") AS \"t9\" ON \"EMP2\".\"DEPTNO\" = \"t9\".\"DEPTNO\""},{"index":355,"rewrite rule":"testSortRemovalAllKeysConstant","original query":"SELECT COUNT(*) AS \"C\", \"DEPTNO\" FROM \"EMP\" WHERE \"DEPTNO\" = 10 GROUP BY \"DEPTNO\", \"SAL\" ORDER BY \"DEPTNO\" DESC NULLS LAST","rewritten query":"SELECT COUNT(*) AS \"C\", \"DEPTNO\" FROM \"EMP\" WHERE \"DEPTNO\" = 10 GROUP BY \"DEPTNO\", \"SAL\""},{"index":356,"rewrite rule":"testDistinctCountMultipleNoGroup","original query":"SELECT COUNT(DISTINCT \"ENAME\"), COUNT(DISTINCT \"JOB\") FROM \"EMP\"","rewritten query":"SELECT COUNT(\"ENAME\") FILTER (WHERE \"$g_1\"), COUNT(\"JOB\") FILTER (WHERE \"$g_2\") FROM (SELECT \"ENAME\", \"JOB\", GROUPING(\"ENAME\", \"JOB\") = 1 AS \"$g_1\", GROUPING(\"ENAME\", \"JOB\") = 2 AS \"$g_2\" FROM \"EMP\" GROUP BY GROUPING SETS(\"ENAME\", \"JOB\")) AS \"t2\""},{"index":357,"rewrite rule":"testProjectSetOpTranspose","original query":"SELECT \"JOB\", SUM(\"SAL\" + 100) OVER (PARTITION BY \"DEPTNO\" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) FROM (SELECT * FROM \"EMP\" UNION ALL SELECT * FROM \"EMP\") AS \"t1\"","rewritten query":"SELECT \"JOB\", SUM(\"EXPR$0\") OVER (PARTITION BY \"DEPTNO\" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) FROM (SELECT \"JOB\", \"DEPTNO\", \"SAL\" + 100 AS \"EXPR$0\" FROM \"EMP\" UNION ALL SELECT \"JOB\", \"DEPTNO\", \"SAL\" + 100 AS \"EXPR$0\" FROM \"EMP\") AS \"t7\""},{"index":358,"rewrite rule":"testExpandProjectInNullable","original query":"SELECT \"EMPNO\", CASE WHEN TRUE THEN CAST(\"DEPTNO\" AS INTEGER) ELSE NULL END IN (SELECT \"DEPTNO\" FROM (SELECT \"EMPNO\", CASE WHEN TRUE THEN CAST(\"DEPTNO\" AS INTEGER) ELSE NULL END AS \"DEPTNO\" FROM \"EMP\") AS \"t\" WHERE \"EMPNO\" < 20) AS \"D\" FROM \"EMP\"","rewritten query":"SELECT \"EMP1\".\"EMPNO\", CASE WHEN \"t6\".\"c\" = 0 THEN FALSE WHEN CASE WHEN TRUE THEN CAST(\"EMP1\".\"DEPTNO\" AS INTEGER) ELSE NULL END IS NULL THEN NULL WHEN \"t11\".\"i\" IS NOT NULL THEN TRUE WHEN \"t6\".\"ck\" < \"t6\".\"c\" THEN NULL ELSE FALSE END AS \"D\" FROM \"EMP\" AS \"EMP1\" CROSS JOIN (SELECT COUNT(*) AS \"c\", COUNT(\"DEPTNO\") AS \"ck\" FROM (SELECT \"EMPNO\", CASE WHEN TRUE THEN CAST(\"DEPTNO\" AS INTEGER) ELSE NULL END AS \"DEPTNO\" FROM \"EMP\") AS \"t3\" WHERE \"EMPNO\" < 20) AS \"t6\" LEFT JOIN (SELECT \"t8\".\"DEPTNO\", \"t9\".\"i\" FROM (SELECT * FROM (SELECT \"EMPNO\", CASE WHEN TRUE THEN CAST(\"DEPTNO\" AS INTEGER) ELSE NULL END AS \"DEPTNO\" FROM \"EMP\") AS \"t7\" WHERE \"EMPNO\" < 20) AS \"t8\", (VALUES (TRUE)) AS \"t9\" (\"i\") GROUP BY \"t8\".\"DEPTNO\", \"t9\".\"i\") AS \"t11\" ON CASE WHEN TRUE THEN CAST(\"EMP1\".\"DEPTNO\" AS INTEGER) ELSE NULL END = \"t11\".\"DEPTNO\""},{"index":359,"rewrite rule":"testPullFilterThroughAggregate","original query":"SELECT \"ENAME\", \"SAL\", \"DEPTNO\" FROM \"EMP\" WHERE \"SAL\" > 5000 GROUP BY \"ENAME\", \"SAL\", \"DEPTNO\"","rewritten query":"SELECT \"ENAME\", \"SAL\", \"DEPTNO\" FROM \"EMP\" GROUP BY \"ENAME\", \"SAL\", \"DEPTNO\" HAVING \"SAL\" > 5000"},{"index":360,"rewrite rule":"testUncorrelatedCallInConjunctionIsFlattenedOnlyIfSiblingOfCorrelation","original query":"SELECT \"$cor0\".\"EMPNO\", \"$cor0\".\"ENAME\", \"$cor0\".\"JOB\", \"$cor0\".\"MGR\", \"$cor0\".\"HIREDATE\", \"$cor0\".\"SAL\", \"$cor0\".\"COMM\", \"$cor0\".\"DEPTNO\", \"$cor0\".\"SLACKER\" FROM \"EMP\" AS \"$cor0\", LATERAL (SELECT MIN(TRUE) AS \"$f0\" FROM \"EMP\" WHERE \"EMPNO\" + 50 < 20 AND \"$cor0\".\"DEPTNO\" >= 30 + \"DEPTNO\") AS \"t1\" WHERE \"$cor0\".\"$f0\" IS NOT NULL","rewritten query":"SELECT \"$cor0\".\"EMPNO\", \"$cor0\".\"ENAME\", \"$cor0\".\"JOB\", \"$cor0\".\"MGR\", \"$cor0\".\"HIREDATE\", \"$cor0\".\"SAL\", \"$cor0\".\"COMM\", \"$cor0\".\"DEPTNO\", \"$cor0\".\"SLACKER\" FROM \"EMP\" AS \"$cor0\", LATERAL (SELECT MIN(TRUE) AS \"$f0\" FROM (SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\", 30 + \"DEPTNO\" AS \"$f9\" FROM \"EMP\") AS \"t4\" WHERE \"EMPNO\" + 50 < 20 AND \"$cor0\".\"DEPTNO\" >= \"$f9\") AS \"t8\" WHERE \"$cor0\".\"$f0\" IS NOT NULL"},{"index":361,"rewrite rule":"testAggregateConstantKeyRule3","original query":"SELECT \"JOB\" FROM \"EMP\" WHERE \"MGR\" IS NULL AND \"JOB\" = 'Clerk' GROUP BY \"MGR\", \"JOB\" HAVING COUNT(*) > 3","rewritten query":"SELECT \"JOB\" FROM (SELECT \"MGR\", 'Clerk' AS \"JOB\", COUNT(*) AS \"$f2\" FROM \"EMP\" WHERE \"MGR\" IS NULL AND \"JOB\" = 'Clerk' GROUP BY \"MGR\") AS \"t7\" WHERE \"$f2\" > 3"},{"index":362,"rewrite rule":"testPullConstantIntoJoin2","original query":"SELECT \"t0\".\"EMPNO\", \"t0\".\"ENAME\", \"t0\".\"JOB\", \"t0\".\"MGR\", \"t0\".\"HIREDATE\", \"t0\".\"SAL\", \"t0\".\"COMM\", \"t0\".\"DEPTNO\", \"t0\".\"SLACKER\", \"t1\".\"DEPTNO\" AS \"DEPTNO0\", \"t1\".\"NAME\" FROM (SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\", \"DEPTNO\" + \"EMPNO\" AS \"$f9\" FROM \"EMP\" WHERE \"EMPNO\" = 10) AS \"t0\" INNER JOIN (SELECT \"DEPTNO\", \"NAME\", \"DEPTNO\" + 5 AS \"$f2\" FROM \"DEPT\") AS \"t1\" ON \"t0\".\"EMPNO\" = \"t1\".\"DEPTNO\" AND \"t0\".\"$f9\" = \"t1\".\"$f2\"","rewritten query":"SELECT 10 AS \"EMPNO\", \"t4\".\"ENAME\", \"t4\".\"JOB\", \"t4\".\"MGR\", \"t4\".\"HIREDATE\", \"t4\".\"SAL\", \"t4\".\"COMM\", \"t4\".\"DEPTNO\", \"t4\".\"SLACKER\", 10 AS \"DEPTNO0\", \"t6\".\"NAME\" FROM (SELECT 10 AS \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\", \"DEPTNO\" + 10 AS \"$f9\" FROM \"EMP\" WHERE \"EMPNO\" = 10) AS \"t4\" INNER JOIN (SELECT 10 AS \"DEPTNO\", \"NAME\", 15 AS \"$f2\" FROM \"DEPT\" WHERE \"DEPTNO\" = 10) AS \"t6\" ON \"t4\".\"$f9\" = 15"},{"index":363,"rewrite rule":"testSortRemovalOneKeyConstant","original query":"SELECT COUNT(*) AS \"C\", \"DEPTNO\", \"SAL\" FROM \"EMP\" WHERE \"DEPTNO\" = 10 GROUP BY \"DEPTNO\", \"SAL\" ORDER BY \"DEPTNO\", \"SAL\" DESC","rewritten query":"SELECT COUNT(*) AS \"C\", \"DEPTNO\", \"SAL\" FROM \"EMP\" WHERE \"DEPTNO\" = 10 GROUP BY \"DEPTNO\", \"SAL\" ORDER BY \"SAL\" DESC"},{"index":364,"rewrite rule":"testFilterJoinRuleAndIsNotNull","original query":"SELECT * FROM \"EMP\" LEFT JOIN \"DEPT\" ON \"EMP\".\"EMPNO\" = \"DEPT\".\"DEPTNO\" WHERE \"DEPT\".\"DEPTNO\" IS NOT NULL AND \"DEPT\".\"NAME\" IS NOT NULL","rewritten query":"SELECT \"EMP0\".\"EMPNO\", \"EMP0\".\"ENAME\", \"EMP0\".\"JOB\", \"EMP0\".\"MGR\", \"EMP0\".\"HIREDATE\", \"EMP0\".\"SAL\", \"EMP0\".\"COMM\", \"EMP0\".\"DEPTNO\", \"EMP0\".\"SLACKER\", CAST(\"DEPT0\".\"DEPTNO\" AS INTEGER) AS \"DEPTNO0\", CAST(\"DEPT0\".\"NAME\" AS VARCHAR(10)) AS \"NAME\" FROM \"EMP\" AS \"EMP0\" INNER JOIN \"DEPT\" AS \"DEPT0\" ON \"EMP0\".\"EMPNO\" = \"DEPT0\".\"DEPTNO\""},{"index":365,"rewrite rule":"testPushProjectPastInnerJoinStrong","original query":"SELECT COUNT(*), CASE WHEN \"EMP\".\"SAL\" < 11 THEN -1 * \"EMP\".\"SAL\" ELSE \"EMP\".\"SAL\" END FROM \"EMP\" INNER JOIN \"BONUS\" ON \"EMP\".\"ENAME\" = \"BONUS\".\"ENAME\" GROUP BY CASE WHEN \"EMP\".\"SAL\" < 11 THEN -1 * \"EMP\".\"SAL\" ELSE \"EMP\".\"SAL\" END","rewritten query":"SELECT COUNT(*), \"t2\".\"EXPR$1\" FROM (SELECT \"ENAME\", CASE WHEN \"SAL\" < 11 THEN -1 * \"SAL\" ELSE \"SAL\" END AS \"EXPR$1\" FROM \"EMP\") AS \"t2\" INNER JOIN (SELECT \"ENAME\" FROM \"BONUS\") AS \"t3\" ON \"t2\".\"ENAME\" = \"t3\".\"ENAME\" GROUP BY \"t2\".\"EXPR$1\""},{"index":366,"rewrite rule":"testMinReuseDistinctAttrWithMixedOptionality","original query":"SELECT SUM(DISTINCT \"DEPTNO\"), COUNT(DISTINCT \"DEPTNO\"), MIN(\"DEPTNO\") FROM \"EMP\"","rewritten query":"SELECT SUM(\"DEPTNO\"), COUNT(\"DEPTNO\"), MIN(\"DEPTNO\") FROM (SELECT \"DEPTNO\" FROM \"EMP\" GROUP BY \"DEPTNO\") AS \"t2\""},{"index":367,"rewrite rule":"testWithinDistinctNoThrow","original query":"SELECT \"DEPTNO\", SUM(\"SAL\"), SUM(\"SAL\") FROM \"EMP\" GROUP BY \"DEPTNO\"","rewritten query":"SELECT \"DEPTNO\", CAST(MIN(\"$f2\") FILTER (WHERE \"$f5\") AS INTEGER) AS \"$f1\", COALESCE(SUM(\"$f3\") FILTER (WHERE \"$f6\"), 0) AS \"$f2\" FROM (SELECT \"DEPTNO\", COALESCE(SUM(\"SAL\"), 0) AS \"$f2\", MIN(\"SAL\") AS \"$f3\", GROUPING(\"DEPTNO\", \"JOB\") = 1 AS \"$f5\", GROUPING(\"DEPTNO\", \"JOB\") = 0 AS \"$f6\" FROM \"EMP\" GROUP BY GROUPING SETS((\"DEPTNO\", \"JOB\"), \"DEPTNO\")) AS \"t3\" GROUP BY \"DEPTNO\""},{"index":368,"rewrite rule":"testPushProjectPastLeftJoinSwap","original query":"SELECT COUNT(*), CASE WHEN \"EMP\".\"SAL\" < 11 THEN 11 ELSE -1 * \"EMP\".\"SAL\" END FROM \"BONUS\" LEFT JOIN \"EMP\" ON \"BONUS\".\"ENAME\" = \"EMP\".\"ENAME\" GROUP BY CASE WHEN \"EMP\".\"SAL\" < 11 THEN 11 ELSE -1 * \"EMP\".\"SAL\" END","rewritten query":"SELECT COUNT(*), CASE WHEN \"t3\".\"EXPR$0\" THEN 11 ELSE \"t3\".\"EXPR$1\" END FROM (SELECT \"ENAME\" FROM \"BONUS\") AS \"t2\" LEFT JOIN (SELECT \"ENAME\", \"SAL\" < 11 AS \"EXPR$0\", -1 * \"SAL\" AS \"EXPR$1\" FROM \"EMP\") AS \"t3\" ON \"t2\".\"ENAME\" = \"t3\".\"ENAME\" GROUP BY CASE WHEN \"t3\".\"EXPR$0\" THEN 11 ELSE \"t3\".\"EXPR$1\" END"},{"index":369,"rewrite rule":"testSemiJoinRuleLeft","original query":"SELECT \"DEPT\".\"NAME\" FROM \"DEPT\" LEFT JOIN (SELECT \"DEPTNO\" FROM (SELECT \"SAL\", \"DEPTNO\" FROM \"EMP\") AS \"t\" WHERE \"SAL\" > 100 GROUP BY \"DEPTNO\") AS \"t2\" ON \"DEPT\".\"DEPTNO\" = \"t2\".\"DEPTNO\"","rewritten query":"SELECT \"NAME\" FROM \"DEPT\""},{"index":370,"rewrite rule":"testProjectJoinRemove1","original query":"SELECT \"EMP\".\"DEPTNO\", \"DEPT0\".\"DEPTNO\" AS \"DEPTNO0\" FROM \"EMP\" LEFT JOIN \"DEPT\" ON \"EMP\".\"DEPTNO\" = \"DEPT\".\"DEPTNO\" LEFT JOIN \"DEPT\" AS \"DEPT0\" ON \"EMP\".\"DEPTNO\" = \"DEPT0\".\"DEPTNO\"","rewritten query":"SELECT \"EMP0\".\"DEPTNO\", \"DEPT1\".\"DEPTNO\" AS \"DEPTNO0\" FROM \"EMP\" AS \"EMP0\" LEFT JOIN \"DEPT\" AS \"DEPT1\" ON \"EMP0\".\"DEPTNO\" = \"DEPT1\".\"DEPTNO\""},{"index":371,"rewrite rule":"testProjectJoinRemove4","original query":"SELECT \"EMP\".\"DEPTNO\" FROM \"EMP\" LEFT JOIN \"DEPT\" ON \"EMP\".\"DEPTNO\" = \"DEPT\".\"DEPTNO\"","rewritten query":"SELECT \"DEPTNO\" FROM \"EMP\""},{"index":372,"rewrite rule":"testProjectJoinRemove7","original query":"SELECT \"EMP\".\"DEPTNO\" FROM \"DEPT\" RIGHT JOIN \"EMP\" ON \"DEPT\".\"DEPTNO\" = \"EMP\".\"DEPTNO\"","rewritten query":"SELECT \"DEPTNO\" FROM \"EMP\""},{"index":373,"rewrite rule":"testExpandProjectInComposite","original query":"SELECT \"EMPNO\", (\"EMPNO\", \"DEPTNO\") IN (SELECT \"EMPNO\", \"DEPTNO\" FROM \"EMP\" WHERE \"EMPNO\" < 20) AS \"D\" FROM \"EMP\"","rewritten query":"SELECT \"EMP1\".\"EMPNO\", CASE WHEN \"t3\".\"i\" IS NOT NULL THEN TRUE ELSE FALSE END AS \"D\" FROM \"EMP\" AS \"EMP1\" LEFT JOIN (SELECT \"EMPNO\", \"DEPTNO\", TRUE AS \"i\" FROM \"EMP\" WHERE \"EMPNO\" < 20) AS \"t3\" ON \"EMP1\".\"EMPNO\" = \"t3\".\"EMPNO\" AND \"EMP1\".\"DEPTNO\" = \"t3\".\"DEPTNO\""},{"index":374,"rewrite rule":"testFilterRemoveIsNotDistinctFromRule","original query":"SELECT * FROM \"EMP\" WHERE \"DEPTNO\" IS NOT DISTINCT FROM 20","rewritten query":"SELECT * FROM \"EMP\" WHERE \"DEPTNO\" = 20"},{"index":375,"rewrite rule":"testReduceNestedCaseWhen","original query":"SELECT \"SAL\" FROM \"EMP\" WHERE CASE WHEN \"SAL\" = 1000 THEN CASE WHEN \"SAL\" = 1000 THEN NULL ELSE 1 END IS NULL ELSE CASE WHEN \"SAL\" = 2000 THEN NULL ELSE 1 END IS NULL END IS TRUE","rewritten query":"SELECT \"SAL\" FROM \"EMP\" WHERE \"SAL\" IN (1000, 2000)"},{"index":376,"rewrite rule":"testTransitiveInferenceRightOuterJoin","original query":"SELECT 1 FROM \"EMP\" RIGHT JOIN \"EMP\" AS \"EMP0\" ON \"EMP\".\"DEPTNO\" = \"EMP0\".\"DEPTNO\" WHERE \"EMP\".\"DEPTNO\" > 7 AND \"EMP0\".\"DEPTNO\" > 9","rewritten query":"SELECT 1 FROM (SELECT * FROM \"EMP\" WHERE \"DEPTNO\" > 9) AS \"t1\" RIGHT JOIN (SELECT * FROM \"EMP\" WHERE \"DEPTNO\" > 9) AS \"t2\" ON \"t1\".\"DEPTNO\" = \"t2\".\"DEPTNO\" WHERE \"t1\".\"DEPTNO\" > 7"},{"index":377,"rewrite rule":"testDistinctCountMixed2","original query":"SELECT \"DEPTNO\", COUNT(DISTINCT \"ENAME\") AS \"CDE\", COUNT(DISTINCT \"JOB\", \"ENAME\") AS \"CDJE\", COUNT(DISTINCT \"DEPTNO\", \"JOB\") AS \"CDDJ\", SUM(\"SAL\") AS \"S\" FROM \"EMP\" GROUP BY \"DEPTNO\"","rewritten query":"SELECT \"DEPTNO\", COUNT(\"ENAME\") FILTER (WHERE \"$g_1\") AS \"CDE\", COUNT(\"JOB\", \"ENAME\") FILTER (WHERE \"$g_0\") AS \"CDJE\", COUNT(\"DEPTNO\", \"JOB\") FILTER (WHERE \"$g_2\") AS \"CDDJ\", CAST(MIN(\"S\") FILTER (WHERE \"$g_3\") AS INTEGER) AS \"S\" FROM (SELECT \"DEPTNO\", \"ENAME\", \"JOB\", SUM(\"SAL\") AS \"S\", GROUPING(\"DEPTNO\", \"ENAME\", \"JOB\") = 0 AS \"$g_0\", GROUPING(\"DEPTNO\", \"ENAME\", \"JOB\") = 1 AS \"$g_1\", GROUPING(\"DEPTNO\", \"ENAME\", \"JOB\") = 2 AS \"$g_2\", GROUPING(\"DEPTNO\", \"ENAME\", \"JOB\") = 3 AS \"$g_3\" FROM \"EMP\" GROUP BY GROUPING SETS((\"ENAME\", \"JOB\", \"DEPTNO\"), (\"ENAME\", \"DEPTNO\"), (\"JOB\", \"DEPTNO\"), \"DEPTNO\")) AS \"t2\" GROUP BY \"DEPTNO\""},{"index":378,"rewrite rule":"testPushSumNullConstantGroupingSetsThroughUnion","original query":"SELECT \"DEPTNO\", \"JOB\", SUM(\"U\") FROM (SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\", CAST(NULL AS INTEGER) AS \"U\" FROM \"EMP\" UNION ALL SELECT \"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\", CAST(NULL AS INTEGER) AS \"U\" FROM \"EMP\") AS \"t1\" GROUP BY ROLLUP(\"DEPTNO\", \"JOB\")","rewritten query":"SELECT \"DEPTNO\", \"JOB\", SUM(\"EXPR$2\") FROM (SELECT \"DEPTNO\", \"JOB\", SUM(CAST(NULL AS INTEGER)) AS \"EXPR$2\" FROM \"EMP\" GROUP BY \"DEPTNO\", \"JOB\" UNION ALL SELECT \"DEPTNO\", \"JOB\", SUM(CAST(NULL AS INTEGER)) AS \"EXPR$2\" FROM \"EMP\" GROUP BY \"DEPTNO\", \"JOB\") AS \"t8\" GROUP BY ROLLUP(\"DEPTNO\", \"JOB\")"},{"index":379,"rewrite rule":"testExpandFilterIn3Value","original query":"SELECT \"EMPNO\" FROM \"EMP\" WHERE \"EMPNO\" < CASE WHEN \"DEPTNO\" IN (SELECT CASE WHEN TRUE THEN CAST(\"DEPTNO\" AS INTEGER) ELSE NULL END FROM \"EMP\" WHERE \"EMPNO\" < 20) = TRUE THEN 10 WHEN \"DEPTNO\" IN (SELECT CASE WHEN TRUE THEN CAST(\"DEPTNO\" AS INTEGER) ELSE NULL END FROM \"EMP\" WHERE \"EMPNO\" < 20) = FALSE THEN 20 ELSE 30 END","rewritten query":"SELECT \"EMP2\".\"EMPNO\" FROM \"EMP\" AS \"EMP2\" CROSS JOIN (SELECT COUNT(*) AS \"c\", COUNT(CASE WHEN TRUE THEN CAST(\"DEPTNO\" AS INTEGER) ELSE NULL END) AS \"ck\" FROM \"EMP\" WHERE \"EMPNO\" < 20) AS \"t7\" LEFT JOIN (SELECT CASE WHEN TRUE THEN CAST(\"t8\".\"DEPTNO\" AS INTEGER) ELSE NULL END AS \"$f0\", \"t9\".\"i\" FROM (SELECT * FROM \"EMP\" WHERE \"EMPNO\" < 20) AS \"t8\", (VALUES (TRUE)) AS \"t9\" (\"i\") GROUP BY CASE WHEN TRUE THEN CAST(\"t8\".\"DEPTNO\" AS INTEGER) ELSE NULL END, \"t9\".\"i\") AS \"t11\" ON \"EMP2\".\"DEPTNO\" = \"t11\".\"$f0\" WHERE \"EMP2\".\"EMPNO\" < CASE WHEN CASE WHEN \"t7\".\"c\" = 0 THEN FALSE WHEN \"t11\".\"i\" IS NOT NULL THEN TRUE WHEN \"t7\".\"ck\" < \"t7\".\"c\" THEN NULL ELSE FALSE END = TRUE THEN 10 WHEN CASE WHEN \"t7\".\"c\" = 0 THEN FALSE WHEN \"t11\".\"i\" IS NOT NULL THEN TRUE WHEN \"t7\".\"ck\" < \"t7\".\"c\" THEN NULL ELSE FALSE END = FALSE THEN 20 ELSE 30 END"},{"index":380,"rewrite rule":"testLeftEmptyFullJoin","original query":"SELECT * FROM (SELECT * FROM \"EMP\" WHERE FALSE) AS \"t0\" FULL JOIN \"DEPT\" ON \"t0\".\"DEPTNO\" = \"DEPT\".\"DEPTNO\"","rewritten query":"SELECT CAST(NULL AS INTEGER) AS \"EMPNO\", CAST(NULL AS VARCHAR(20)) AS \"ENAME\", CAST(NULL AS VARCHAR(10)) AS \"JOB\", CAST(NULL AS INTEGER) AS \"MGR\", CAST(NULL AS TIMESTAMP(0)) AS \"HIREDATE\", CAST(NULL AS INTEGER) AS \"SAL\", CAST(NULL AS INTEGER) AS \"COMM\", CAST(NULL AS INTEGER) AS \"DEPTNO\", CAST(NULL AS BOOLEAN) AS \"SLACKER\", CAST(\"DEPTNO\" AS INTEGER) AS \"DEPTNO0\", CAST(\"NAME\" AS VARCHAR(10)) AS \"NAME\" FROM \"DEPT\""},{"index":381,"rewrite rule":"testSortUnionTranspose2","original query":"SELECT * FROM (SELECT \"NAME\" FROM \"DEPT\" UNION ALL SELECT \"NAME\" FROM \"DEPT\") AS \"t1\" ORDER BY \"NAME\"","rewritten query":"SELECT * FROM ((SELECT \"NAME\" FROM \"DEPT\" ORDER BY \"NAME\") UNION ALL (SELECT \"NAME\" FROM \"DEPT\" ORDER BY \"NAME\")) AS \"t\" ORDER BY \"NAME\""},{"index":382,"rewrite rule":"testSortUnionTranspose3","original query":"SELECT * FROM (SELECT \"NAME\" FROM \"DEPT\" UNION ALL SELECT \"NAME\" FROM \"DEPT\") AS \"t1\" ORDER BY \"NAME\" FETCH NEXT 0 ROWS ONLY","rewritten query":"SELECT * FROM ((SELECT \"NAME\" FROM \"DEPT\" ORDER BY \"NAME\" FETCH NEXT 0 ROWS ONLY) UNION ALL (SELECT \"NAME\" FROM \"DEPT\" ORDER BY \"NAME\" FETCH NEXT 0 ROWS ONLY)) AS \"t\" ORDER BY \"NAME\" FETCH NEXT 0 ROWS ONLY"},{"index":383,"rewrite rule":"testTransitiveInferenceComplexPredicate","original query":"SELECT 1 FROM \"EMP\" INNER JOIN \"EMP\" AS \"EMP0\" ON \"EMP\".\"DEPTNO\" = \"EMP0\".\"DEPTNO\" WHERE \"EMP\".\"DEPTNO\" > 7 AND \"EMP0\".\"SAL\" = \"EMP0\".\"DEPTNO\" AND \"EMP\".\"COMM\" = \"EMP\".\"DEPTNO\" AND \"EMP\".\"COMM\" + \"EMP\".\"DEPTNO\" > \"EMP\".\"COMM\" \/ 2","rewritten query":"SELECT 1 FROM (SELECT * FROM \"EMP\" WHERE \"DEPTNO\" > 7 AND \"COMM\" = \"DEPTNO\" AND \"COMM\" + \"DEPTNO\" > \"COMM\" \/ 2) AS \"t1\" INNER JOIN (SELECT * FROM (SELECT * FROM \"EMP\" WHERE \"SAL\" = \"DEPTNO\") AS \"t2\" WHERE \"DEPTNO\" > 7) AS \"t3\" ON \"t1\".\"DEPTNO\" = \"t3\".\"DEPTNO\""},{"index":384,"rewrite rule":"testExpandFilterScalar","original query":"SELECT \"EMPNO\" FROM \"EMP\" WHERE (((SELECT \"DEPTNO\" FROM \"EMP\" WHERE \"EMPNO\" < 20))) < (((SELECT \"DEPTNO\" FROM \"EMP\" WHERE \"EMPNO\" > 100))) OR \"SAL\" < 100","rewritten query":"SELECT \"EMP2\".\"EMPNO\" FROM \"EMP\" AS \"EMP2\" LEFT JOIN (SELECT SINGLE_VALUE(\"DEPTNO\") AS \"$f0\" FROM \"EMP\" WHERE \"EMPNO\" < 20) AS \"t7\" ON TRUE LEFT JOIN (SELECT SINGLE_VALUE(\"DEPTNO\") AS \"$f0\" FROM \"EMP\" WHERE \"EMPNO\" > 100) AS \"t10\" ON TRUE WHERE \"t7\".\"$f0\" < \"t10\".\"$f0\" OR \"EMP2\".\"SAL\" < 100"},{"index":385,"rewrite rule":"testRightEmptyRightJoin","original query":"SELECT * FROM \"EMP\" RIGHT JOIN (SELECT * FROM \"DEPT\" WHERE FALSE) AS \"t0\" ON \"EMP\".\"DEPTNO\" = \"t0\".\"DEPTNO\"","rewritten query":"SELECT * FROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"EMPNO\", \"ENAME\", \"JOB\", \"MGR\", \"HIREDATE\", \"SAL\", \"COMM\", \"DEPTNO\", \"SLACKER\", \"DEPTNO0\", \"NAME\") WHERE 1 = 0"},{"index":386,"rewrite rule":"testDigestOfApproximateDistinctAggregateCall","original query":"SELECT * FROM (SELECT \"DEPTNO\", COUNT(DISTINCT \"EMPNO\") AS \"EXPR$1\" FROM \"EMP\" GROUP BY \"DEPTNO\" UNION ALL SELECT \"DEPTNO\", COUNT(DISTINCT \"EMPNO\") AS \"EXPR$1\" FROM \"EMP\" GROUP BY \"DEPTNO\") AS \"t3\"","rewritten query":"SELECT * FROM (SELECT \"DEPTNO\", COUNT(DISTINCT \"EMPNO\") AS \"EXPR$1\" FROM \"EMP\" GROUP BY \"DEPTNO\" UNION ALL SELECT \"DEPTNO\", COUNT(DISTINCT \"EMPNO\") AS \"EXPR$1\" FROM \"EMP\" GROUP BY \"DEPTNO\") AS \"t7\""},{"index":387,"rewrite rule":"testAlreadyFalseEliminatesFilter","original query":"SELECT * FROM (VALUES (1, 2)) AS \"t\" (\"EXPR$0\", \"EXPR$1\") WHERE FALSE","rewritten query":"SELECT * FROM (VALUES (NULL, NULL)) AS \"t\" (\"EXPR$0\", \"EXPR$1\") WHERE 1 = 0"},{"index":388,"rewrite rule":"testDistinctWithMultipleInputsAndGroupby","original query":"SELECT \"DEPTNO\", SUM(\"COMM\"), MIN(\"COMM\"), COUNT(DISTINCT \"SAL\", \"DEPTNO\", \"COMM\") FROM \"EMP\" GROUP BY \"DEPTNO\"","rewritten query":"SELECT \"DEPTNO\", SUM(\"EXPR$1\"), MIN(\"EXPR$2\"), COUNT(\"SAL\", \"DEPTNO\", \"COMM\") FROM (SELECT \"DEPTNO\", \"COMM\", \"SAL\", SUM(\"COMM\") AS \"EXPR$1\", MIN(\"COMM\") AS \"EXPR$2\" FROM \"EMP\" GROUP BY \"DEPTNO\", \"COMM\", \"SAL\") AS \"t2\" GROUP BY \"DEPTNO\""},{"index":389,"rewrite rule":"testPushFilterWithIsNotDistinctFromPastJoin","original query":"SELECT * FROM \"EMP\" INNER JOIN \"EMP\" AS \"EMP0\" ON \"EMP\".\"DEPTNO\" = \"EMP0\".\"DEPTNO\" WHERE \"EMP\".\"ENAME\" IS NULL AND \"EMP0\".\"ENAME\" IS NULL OR \"EMP\".\"ENAME\" = \"EMP0\".\"ENAME\" IS TRUE","rewritten query":"SELECT * FROM \"EMP\" AS \"EMP1\" INNER JOIN \"EMP\" AS \"EMP2\" ON \"EMP1\".\"DEPTNO\" = \"EMP2\".\"DEPTNO\" AND \"EMP1\".\"ENAME\" IS NOT DISTINCT FROM \"EMP2\".\"ENAME\""},{"index":390,"rewrite rule":"testSomeWithEquality2","original query":"SELECT * FROM \"EMP\" WHERE \"ENAME\" IN (SELECT \"NAME\" FROM \"DEPT\")","rewritten query":"SELECT \"EMP0\".\"EMPNO\", \"EMP0\".\"ENAME\", \"EMP0\".\"JOB\", \"EMP0\".\"MGR\", \"EMP0\".\"HIREDATE\", \"EMP0\".\"SAL\", \"EMP0\".\"COMM\", \"EMP0\".\"DEPTNO\", \"EMP0\".\"SLACKER\" FROM \"EMP\" AS \"EMP0\" INNER JOIN (SELECT \"NAME\" FROM \"DEPT\" GROUP BY \"NAME\") AS \"t3\" ON \"EMP0\".\"ENAME\" = \"t3\".\"NAME\""},{"index":391,"rewrite rule":"testPushMaxNullableThroughUnion","original query":"SELECT \"ENAME\", MAX(\"MGR\") FROM (SELECT * FROM \"EMP\" UNION ALL SELECT * FROM \"EMP\") AS \"t1\" GROUP BY \"ENAME\"","rewritten query":"SELECT \"ENAME\", MAX(\"EXPR$1\") FROM (SELECT \"ENAME\", MAX(\"MGR\") AS \"EXPR$1\" FROM \"EMP\" GROUP BY \"ENAME\" UNION ALL SELECT \"ENAME\", MAX(\"MGR\") AS \"EXPR$1\" FROM \"EMP\" GROUP BY \"ENAME\") AS \"t8\" GROUP BY \"ENAME\""},{"index":392,"rewrite rule":"testPullConstantIntoProjectWithIsNotDistinctFromDate","original query":"SELECT \"HIREDATE\" FROM \"EMP\" WHERE \"HIREDATE\" IS NOT DISTINCT FROM DATE '2020-12-11'","rewritten query":"SELECT CAST(DATE '2020-12-11' AS DATE) AS \"HIREDATE\" FROM \"EMP\" WHERE \"HIREDATE\" IS NOT DISTINCT FROM DATE '2020-12-11'"},{"index":393,"rewrite rule":"testPullConstantThroughUnion3","original query":"SELECT 2, 3 FROM \"EMP\" UNION ALL SELECT 2, 3 FROM \"EMP\"","rewritten query":"SELECT 2, 3 FROM (SELECT 2 AS \"EXPR$0\" FROM \"EMP\" UNION ALL SELECT 2 AS \"EXPR$0\" FROM \"EMP\") AS \"t4\""},{"index":394,"rewrite rule":"testAggregateDynamicFunction","original query":"SELECT \"HIREDATE\" FROM \"EMP\" WHERE \"MGR\" IS NULL AND \"HIREDATE\" = CURRENT_TIMESTAMP GROUP BY \"MGR\", \"HIREDATE\" HAVING COUNT(*) > 3","rewritten query":"SELECT \"HIREDATE\" FROM (SELECT \"MGR\", CURRENT_TIMESTAMP AS \"HIREDATE\", COUNT(*) AS \"$f2\" FROM \"EMP\" WHERE \"MGR\" IS NULL AND \"HIREDATE\" = CURRENT_TIMESTAMP GROUP BY \"MGR\") AS \"t7\" WHERE \"$f2\" > 3"},{"index":395,"rewrite rule":"testPushProjectPastRightJoin","original query":"SELECT COUNT(*), CASE WHEN \"EMP\".\"SAL\" < 11 THEN 11 ELSE -1 * \"EMP\".\"SAL\" END FROM \"EMP\" RIGHT JOIN \"BONUS\" ON \"EMP\".\"ENAME\" = \"BONUS\".\"ENAME\" GROUP BY CASE WHEN \"EMP\".\"SAL\" < 11 THEN 11 ELSE -1 * \"EMP\".\"SAL\" END","rewritten query":"SELECT COUNT(*), CASE WHEN \"t2\".\"EXPR$0\" THEN 11 ELSE \"t2\".\"EXPR$1\" END FROM (SELECT \"ENAME\", \"SAL\" < 11 AS \"EXPR$0\", -1 * \"SAL\" AS \"EXPR$1\" FROM \"EMP\") AS \"t2\" RIGHT JOIN (SELECT \"ENAME\" FROM \"BONUS\") AS \"t3\" ON \"t2\".\"ENAME\" = \"t3\".\"ENAME\" GROUP BY CASE WHEN \"t2\".\"EXPR$0\" THEN 11 ELSE \"t2\".\"EXPR$1\" END"},{"index":396,"rewrite rule":"testJoinDeriveIsNotNullFilterRule12","original query":"SELECT \"EMPNULLABLES\".\"DEPTNO\" FROM \"EMPNULLABLES\" INNER JOIN \"EMPNULLABLES\" AS \"EMPNULLABLES0\" ON \"EMPNULLABLES\".\"ENAME\" = \"EMPNULLABLES0\".\"ENAME\" AND \"EMPNULLABLES\".\"MGR\" IS NOT DISTINCT FROM \"EMPNULLABLES0\".\"MGR\"","rewritten query":"SELECT \"t0\".\"DEPTNO\" FROM (SELECT * FROM \"EMPNULLABLES\" WHERE \"ENAME\" IS NOT NULL) AS \"t0\" INNER JOIN (SELECT * FROM \"EMPNULLABLES\" WHERE \"ENAME\" IS NOT NULL) AS \"t1\" ON \"t0\".\"ENAME\" = \"t1\".\"ENAME\" AND \"t0\".\"MGR\" IS NOT DISTINCT FROM \"t1\".\"MGR\""}]}