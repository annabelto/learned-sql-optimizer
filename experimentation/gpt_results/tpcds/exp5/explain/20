                                                                                                QUERY PLAN                                                                                                 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=24114.26..24114.51 rows=100 width=291)
   ->  Sort  (cost=24114.26..24114.73 rows=188 width=291)
         Sort Key: item.i_category, item.i_class, item.i_item_id, item.i_item_desc, ((((sum(catalog_sales.cs_ext_sales_price)) * '100'::numeric) / sum((sum(catalog_sales.cs_ext_sales_price))) OVER (?)))
         ->  WindowAgg  (cost=24102.93..24107.16 rows=188 width=291)
               ->  Sort  (cost=24102.93..24103.40 rows=188 width=259)
                     Sort Key: item.i_class
                     ->  Finalize GroupAggregate  (cost=24075.72..24095.83 rows=188 width=259)
                           Group Key: item.i_item_id, item.i_item_desc, item.i_category, item.i_class, item.i_current_price
                           ->  Gather Merge  (cost=24075.72..24091.53 rows=111 width=259)
                                 Workers Planned: 1
                                 ->  Partial GroupAggregate  (cost=23075.71..23079.04 rows=111 width=259)
                                       Group Key: item.i_item_id, item.i_item_desc, item.i_category, item.i_class, item.i_current_price
                                       ->  Sort  (cost=23075.71..23075.98 rows=111 width=233)
                                             Sort Key: item.i_item_id, item.i_item_desc, item.i_category, item.i_class, item.i_current_price
                                             ->  Nested Loop  (cost=0.71..23071.93 rows=111 width=233)
                                                   ->  Nested Loop  (cost=0.43..22956.69 rows=369 width=10)
                                                         ->  Parallel Seq Scan on date_dim  (cost=0.00..2049.55 rows=19 width=4)
                                                               Filter: ((d_date >= '2002-06-18'::date) AND (d_date <= '2002-07-18 00:00:00'::timestamp without time zone))
                                                         ->  Index Scan using idx_catalog_sales_date_customer on catalog_sales  (cost=0.43..1092.54 rows=784 width=14)
                                                               Index Cond: (cs_sold_date_sk = date_dim.d_date_sk)
                                                   ->  Index Scan using item_pkey on item  (cost=0.29..0.31 rows=1 width=231)
                                                         Index Cond: (i_item_sk = catalog_sales.cs_item_sk)
                                                         Filter: (i_category = ANY ('{Books,Music,Sports}'::bpchar[]))
(23 rows)

    i_item_id     |                                                                                               i_item_desc                                                                                                |                     i_category                     |                      i_class                       | i_current_price | itemrevenue |      revenueratio      
------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------+----------------------------------------------------+-----------------+-------------+------------------------
 AAAAAAAAABEDAAAA | No longer soft cameras mean select, small policies. Also famous arms could want irish, different connections. Attacks should remove black r                                                              | Books                                              | arts                                               |            1.52 |     1949.31 |     1.1147258167699354
 AAAAAAAAAKLBAAAA | Assets might operate there local, sophisticated investors; poets should not get well domestic, sorry disputes. Voluntary bedrooms make at least professional states. Later vi                            | Books                                              | arts                                               |            1.54 |      198.80 | 0.11368509491761862208
 AAAAAAAAAKLCAAAA | Regulations go almost. Complex operations may stay at present countries. Widely special modules can rest also in ne                                                                                      | Books                                              | arts                                               |           76.12 |     8781.96 |     5.0220219122873744
 AAAAAAAABFHDAAAA | Little days answer in a emotions; players touch.                                                                                                                                                         | Books                                              | arts                                               |            2.58 |    20575.89 |    11.7664587910688120
 AAAAAAAABHDCAAAA | Minor heads close common children; recently strong firms provide. Useful, young men ought to create changes. Popular, common regulations might decide. Points fit. Obvious, glad officials               | Books                                              | arts                                               |            3.88 |      209.95 | 0.12006129616677077316
 AAAAAAAACDEEAAAA | A                                                                                                                                                                                                        | Books                                              | arts                                               |            4.97 |     4506.66 |     2.5771633292828729
 AAAAAAAACGOAAAAA | The                                                                                                                                                                                                      | Books                                              | arts                                               |           19.32 |      997.89 | 0.57064999681761794157
 AAAAAAAACHFDAAAA | Free feet experience too powerful coins. Mild details                                                                                                                                                    | Books                                              | arts                                               |            1.16 |     1338.86 | 0.76563594658653354302
 AAAAAAAACMIDAAAA | Very                                                                                                                                                                                                     | Books                                              | arts                                               |            5.87 |     3741.92 |     2.1398417020831764
 AAAAAAAACOPAAAAA | Equations get subsequently total skills. Now due features know domestic families. So subjecti                                                                                                            | Books                                              | arts                                               |            2.87 |      453.18 | 0.25915398045657146455
 AAAAAAAADCCDAAAA | Glad users understand very almost original jobs. Towns can understand. Supreme, following days work by a parents; german, crucial weapons work sure; fair pictur                                         | Books                                              | arts                                               |            7.18 |    11211.63 |     6.4114447722898414
 AAAAAAAAEAEAAAAA | Communications grab as. Never new minutes release unfair occ                                                                                                                                             | Books                                              | arts                                               |            1.09 |      259.94 | 0.14864840831431481198
 AAAAAAAAFBMBAAAA | Years light glasses. Contemporary members might detect even drawings. Private instructions ought to expect well main streets. Children will say well; usually young members ought to ensure enough.      | Books                                              | arts                                               |            4.78 |    17301.98 |     9.8942517030318866
 AAAAAAAAFCKCAAAA | Brilliant, acceptable resources might not pick as. Positive, married parties support only strongly impossible needs. Photogra                                                                            | Books                                              | arts                                               |            2.44 |     8789.00 |     5.0260477828518615
 AAAAAAAAGAHAAAAA | Negative classes may not pinpoint later peculiar, possible instruments. D                                                                                                                                | Books                                              | arts                                               |            0.54 |     5042.23 |     2.8834325761894575
 AAAAAAAAGMFDAAAA | Professional, likely elections collect children. New figures would continue however well only rates. Also concerned territories cover at all new, star losses. Much black exports would develop liabili  | Books                                              | arts                                               |            4.21 |     8443.71 |     4.8285914125092834
 AAAAAAAAHPNCAAAA | Correct, certain humans cut                                                                                                                                                                              | Books                                              | arts                                               |           37.98 |     3842.31 |     2.1972503875901167
 AAAAAAAAIBCAAAAA | Common, old modules express alone enterprises. British, other obligations provide criminal, old details. Complete eyes used to make inside radical t                                                     | Books                                              | arts                                               |            6.17 |    12425.78 |     7.1057644805102974
 AAAAAAAAICDEAAAA | Natural, particular words speak dangerous suppliers. Necess                                                                                                                                              | Books                                              | arts                                               |            2.82 |     9502.34 |     5.4339759800778880
 AAAAAAAAILMDAAAA | Tight difficult waters make even affairs. Great men change new, serious pages. Stil                                                                                                                      | Books                                              | arts                                               |            0.46 |     1552.73 | 0.88793892068125735944
 AAAAAAAAIOMDAAAA | Wrong, labour standards affect minutes.                                                                                                                                                                  | Books                                              | arts                                               |            1.91 |     1885.89 |     1.0784586702926951
 AAAAAAAAJJDBAAAA | Problems compete with a sets. Interesting, automatic pounds tell complete hills.                                                                                                                         | Books                                              | arts                                               |            1.20 |       43.50 | 0.02487576272090749527
 AAAAAAAAKFDEAAAA | Men know. Schools should discuss national provisions. Institu                                                                                                                                            | Books                                              | arts                                               |            2.85 |      281.52 | 0.16098907405034202458
 AAAAAAAAKKDDAAAA | Only tall games meet both in a periods; bad, misleading homes think to a months. Clear detailed numbers                                                                                                  | Books                                              | arts                                               |            0.22 |     5403.00 |     3.0897412869209930
 AAAAAAAAKODEAAAA | Central powers proceed in a levels. Jointly hard roads will                                                                                                                                              | Books                                              | arts                                               |            7.67 |     3031.65 |     1.7336691046629703
 AAAAAAAAMHDAAAAA | Other, good sales keep logical objectives. Surprising, roman councils must pa                                                                                                                            | Books                                              | arts                                               |            7.39 |      839.44 | 0.48003931628594454786
 AAAAAAAAMHJDAAAA | Little, gold books used to laugh only from the forests. More external dates would say districts. There stupid contacts may rec                                                                           | Books                                              | arts                                               |            0.66 |     4442.86 |     2.5406788772922086
 AAAAAAAAMJNBAAAA | Forces should not like too; only sufficient facts might not think vast police. Here occasional weeks see exte                                                                                            | Books                                              | arts                                               |            5.58 |     4981.83 |     2.8488924366873238
 AAAAAAAANIBAAAAA | Beneath decent wives write t                                                                                                                                                                             | Books                                              | arts                                               |            2.72 |    16712.03 |     9.5568848934410963
 AAAAAAAAOAKBAAAA | Ugly, long men should keep by a rules. Particular                                                                                                                                                        | Books                                              | arts                                               |            6.34 |     1768.58 | 1.01137417087224317219
 AAAAAAAAOLMAAAAA | Particular le                                                                                                                                                                                            | Books                                              | arts                                               |            4.10 |    11100.40 |     6.3478371610841738
 AAAAAAAAOMBEAAAA | Words show on a teachers. Equally real officers could want clean from a ideas. European, right costs will not keep eyes. Aut                                                                             | Books                                              | arts                                               |            4.75 |      779.00 | 0.44547630251923997282
 AAAAAAAAONHDAAAA | Sessions write however; tests ought to make eithe                                                                                                                                                        | Books                                              | arts                                               |            8.43 |     2473.24 |     1.4143386526863736
 AAAAAAAAADLDAAAA | Circumstances say well also ideal magazines. Available committees bet even aged a losses. Likely hot services identify. Disabled, single example                                                         | Books                                              | business                                           |           54.45 |     3367.00 |     2.2160006302471647
 AAAAAAAAAIECAAAA | Lovers should not afford good, technological gains; distinctive cats might not find ambitious, different                                                                                                 | Books                                              | business                                           |            0.15 |     1441.50 | 0.94872732655220906041
 AAAAAAAABKACAAAA | Total pp. accept with a questions; able, generous a                                                                                                                                                      | Books                                              | business                                           |            5.25 |    12998.92 |     8.5552761842983291
 AAAAAAAABMDDAAAA | Head facts resolve even. Characteristics put. Toxic, genuine officials shall not meet. Difficult chil                                                                                                    | Books                                              | business                                           |            3.85 |     3788.96 |     2.4937148048652501
 AAAAAAAACEABAAAA | National times should take more full women. Large markets may not                                                                                                                                        | Books                                              | business                                           |            6.66 |     2542.86 |     1.6735905442917449
 AAAAAAAACEBAAAAA | Somehow similar prisoners forget at a companies. Points matter; small, isolated studies travel necessarily that chri                                                                                     | Books                                              | business                                           |            0.83 |      969.32 | 0.63796071604133700065
 AAAAAAAACJMDAAAA | Ways take as important pp.                                                                                                                                                                               | Books                                              | business                                           |            7.86 |     1823.76 |     1.2003128332104452
 AAAAAAAADHNCAAAA | Originally major industries matter mediterranean bodies. Cases should not                                                                                                                                | Books                                              | business                                           |           45.06 |      921.58 | 0.60654049920498427048
 AAAAAAAADNDDAAAA | Clear, harsh police used to include large, appropriate plans. Prices could produce more. There white weapons expect directly free conclusions. Responsibl                                                | Books                                              | business                                           |            4.57 |     4643.76 |     3.0563038570586794
 AAAAAAAAEDJDAAAA | Warm circumstances warrant sudden comments. S                                                                                                                                                            | Books                                              | business                                           |            1.05 |     2983.82 |     1.9638096229712192
 AAAAAAAAEMADAAAA | P                                                                                                                                                                                                        | Books                                              | business                                           |            3.95 |     4476.36 |     2.9461290707493906
 AAAAAAAAFGJCAAAA | Secondary, red structures may seek eyes. High true titles should make now junior fat thoughts. Partly excellent authorities receive direct, net parties. Parents look most also other issues. Empty, con | Books                                              | business                                           |            8.59 |      979.85 | 0.64489106550272774738
 AAAAAAAAFLMDAAAA | Significantly relevant colleges extract knowingly broad investors. Entire members stay. Mediterranean legs would cut on the knees. Forthcoming, particular students u                                    | Books                                              | business                                           |            4.81 |     1663.00 |     1.0945081817941892
 AAAAAAAAFNOCAAAA | Wonderful systems ask also very parliamentary orders; british companies                                                                                                                                  | Books                                              | business                                           |           87.12 |     2923.45 |     1.9240769356982696
 AAAAAAAAGCAAAAAA | Cheap problems can draw please over good stars. Either long children would pass similar, different metres; base, large surroundings                                                                      | Books                                              | business                                           |            5.07 |    11003.52 |     7.2419979967143694
 AAAAAAAAGONBAAAA | Ever top offers might struggle far, automatic men. Long-term, long goods dare however; new, other gr                                                                                                     | Books                                              | business                                           |            5.83 |      236.73 | 0.15580452307645123196
 AAAAAAAAIEEAAAAA | Medical, old shops would not put very likely stones; clergy will maximise for good negotiations. Technically hard months leave just subsequent parents. Good, social banks shall not c                   | Books                                              | business                                           |            0.93 |      922.56 | 0.60718548899341379866
 AAAAAAAAINFAAAAA | Sen                                                                                                                                                                                                      | Books                                              | business                                           |            9.83 |      427.68 | 0.28147880889340879012
 AAAAAAAAJMEDAAAA | Personal, significant activities agree only by a couples. Elaborate aut                                                                                                                                  | Books                                              | business                                           |            3.06 |     7009.80 |     4.6135198152380680
 AAAAAAAAKHDAAAAA | Great, extraordinary goals must not take later good, irrelevant centuries; obvious, bright daughters shall                                                                                               | Books                                              | business                                           |            1.81 |     3661.02 |     2.4095107298329299
 AAAAAAAAKHHCAAAA | Especially firm buses listen major, individual calls. New daughters help internal, general eggs. Here l                                                                                                  | Books                                              | business                                           |            2.81 |      303.16 | 0.19952561659213853538
 AAAAAAAAKPGBAAAA | Amazing, victorian materials let immensely years; well happy systems must not see undoubtedly within a days. Major, physical parents must imply small, different parents. Easy teeth me                  | Books                                              | business                                           |            9.42 |     1811.84 |     1.1924676512940371
 AAAAAAAALDFAAAAA | Hands may not allow only in a lands; linear, other pubs say; social, precise women identify for a patients. Preferences develop alone now rich motives. Ever good tas                                    | Books                                              | business                                           |            3.68 |     5110.72 |     3.3636349097168962
 AAAAAAAALGBBAAAA | Modern records retain about there civil plans. Social bodies survive. Great, living losses bother late, coherent others. About british sports ought to use cautiously from                               | Books                                              | business                                           |            1.94 |     4396.80 |     2.8937664303744383
 AAAAAAAALPDCAAAA | So small edges will understand currently in a things. New trains point usually systems. Years look growing questions. Different cases could sell just alive, late rules; big, large results will make    | Books                                              | business                                           |            4.12 |     4329.18 |     2.8492621349728008
 AAAAAAAAMEIBAAAA | Police achieve quite; hard, administrative fingers include years. Irish, excellent trees issue upstream able mothers. Stores used to like advertisements. Services mediate perhap                        | Books                                              | business                                           |            9.80 |     4090.53 |     2.6921939584333040
 AAAAAAAAMHABAAAA | American, other circumstances tackle also with the facts. Passive                                                                                                                                        | Books                                              | business                                           |            0.71 |    19313.01 |    12.7109124835075124
 AAAAAAAAMIODAAAA | Organisations think types; attempts announce nevertheless men. Complete, difficult results seem for a kids. Then massive sales give                                                                      | Books                                              | business                                           |            2.31 |     8635.91 |     5.6837487385678028
 AAAAAAAAMNKCAAAA | Political modes choose main institutions. I                                                                                                                                                              | Books                                              | business                                           |            4.41 |     6064.24 |     3.9911968108019204
 AAAAAAAANACBAAAA | New teachers might demand never assets. Deeply bright ministers make generally never prime imports. Odd writings step common readers; talks take young, r                                                | Books                                              | business                                           |            2.95 |      737.40 | 0.48532190815095314682
 AAAAAAAAOGCEAAAA | Lively, regular decisions ought to think separately clear networks; english, little levels ought to keep years. Students make then until the organisers. Significant, st                                 | Books                                              | business                                           |            2.42 |     7267.94 |     4.7834153907331684
 AAAAAAAAOLLCAAAA | Necessary, old controls may not attend as sharp arguments. Reaction                                                                                                                                      | Books                                              | business                                           |            8.93 |     3132.57 |     2.0617098587149868
 AAAAAAAAOMGCAAAA | Local points may not understand away from a students. Sometimes united figures w                                                                                                                         | Books                                              | business                                           |           46.36 |     1699.20 |     1.1183333147953615
 AAAAAAAAPDNAAAAA | Local, unlikely bits sign completely. Areas feel only manufacturing legs. Amounts must go personal, very things; areas could take clo                                                                    | Books                                              | business                                           |            5.20 |      258.00 | 0.16980343409675333860
 AAAAAAAAPEKCAAAA | Alone countries must use so old, international functions. Only public cases see in a words. Normal methods forget even communist changes; technical numbers convert either natu                          | Books                                              | business                                           |            4.67 |    12486.24 |     8.2178543835513388
 AAAAAAAAPHJAAAAA | Possibly great customs suit close looks. Capable, frequent processes shall pass possible dangers; hard, private words act measures. Mysterious, acceptable fac                                           | Books                                              | business                                           |            6.64 |     3518.20 |     2.3155133404620062
 AAAAAAAAACIDAAAA | About military signals could consider swiftly also international records. Good, following owners get fairly obvious sales; players might understand with                                                 | Books                                              | computers                                          |            4.31 |     3038.61 |     1.2039849528131060
 AAAAAAAABHEEAAAA | Subjects may remain officials. Forward, straight objects used to see wh                                                                                                                                  | Books                                              | computers                                          |            6.97 |     5848.60 |     2.3173840654189684
 AAAAAAAABLMBAAAA | External improvements effect so tough words. Great roads cause quickly popular, black stories. Clearly white members might ask enough details. Min                                                       | Books                                              | computers                                          |           31.74 |      374.85 | 0.14852638527550188328
 AAAAAAAACCKAAAAA | New problems sho                                                                                                                                                                                         | Books                                              | computers                                          |            0.12 |     8046.22 |     3.1881445157568328
 AAAAAAAACEHDAAAA | Well new years would feel with a rights. Of course easy places increase always before a schools. Eyes shal                                                                                               | Books                                              | computers                                          |           49.66 |     7872.00 |     3.1191135251133809
 AAAAAAAACIPAAAAA | Multiple stars give in general for a panels. Real schools                                                                                                                                                | Books                                              | computers                                          |           24.22 |     1614.60 | 0.63975110488415457046
 AAAAAAAACMHCAAAA | Partners used to say in a measures; special uses know symptoms. New, high minutes eat. Extremely vital candidates might go parties; we                                                                   | Books                                              | computers                                          |            3.18 |     3813.39 |     1.5109751429791813
 AAAAAAAACOOBAAAA | Stiff old products mean; etc basic requirements shall eliminate proposed comparisons. Still little years reach royal services. Rathe                                                                     | Books                                              | computers                                          |            4.00 |     7660.44 |     3.0352873491259588
 AAAAAAAAEBGDAAAA | Main, due rooms would come fairly likely, relevant cattle; players avoid otherwise eyes. Fans will not ban potentially. Literally religious peasants can endeavou                                        | Books                                              | computers                                          |            3.31 |      513.80 | 0.20358238429919399127
 AAAAAAAAEGJBAAAA | Clients would win at all public arms. Fresh, great plans could get. Findings sit th                                                                                                                      | Books                                              | computers                                          |            0.75 |    13203.47 |     5.2315957641550776
 AAAAAAAAELMBAAAA | Always large steps like today with a patients. Sufficient records let; operations might provide below. High, human stations say military, mental birds. Sp                                               | Books                                              | computers                                          |            1.23 |     3892.56 |     1.5423445812138392
 AAAAAAAAFEEAAAAA | Capital, united feelings paint only things. Greatly financial economies should not pay somewhere soviet necessary armies; educational concepts mus                                                       | Books                                              | computers                                          |            3.83 |     1292.22 | 0.51201484748755247061
 AAAAAAAAFLFEAAAA | Social weeks may hope. However parental objects shall get just potential logical stations. Agreements attend on a arms; circa real reforms may interpret dogs. T                                         | Books                                              | computers                                          |            2.06 |     2414.86 | 0.95683720620621175896
 AAAAAAAAGDACAAAA | Children convince just to the miners. Prime, considerable components shall explain policies; single tasks know just all the same long shares; known police shall not draw co                             | Books                                              | computers                                          |            3.25 |    16214.42 |     6.4246210269142410
 AAAAAAAAGHDDAAAA | Signs put only                                                                                                                                                                                           | Books                                              | computers                                          |            9.88 |     7221.02 |     2.8611764668590226
 AAAAAAAAGHHDAAAA | Thus european cats work also later psychological problems. Cell                                                                                                                                          | Books                                              | computers                                          |            2.71 |     5518.17 |     2.1864581657615479
 AAAAAAAAGMNAAAAA | Old, particular factors must not name by a ladies. Components can pay perhaps other si                                                                                                                   | Books                                              | computers                                          |            4.32 |     1473.59 | 0.58387887442477476371
 AAAAAAAAGNIBAAAA | Pounds shall look for ever bitterly european things; more technical lengths find never with a reasons. Signs change. Familiar, safe others would not take ne                                             | Books                                              | computers                                          |            8.69 |      310.76 | 0.12313207813315983793
 AAAAAAAAGPHDAAAA | Nuclear, long women improve better years; complex characters should not take away middle, clear players. Arms delete. Doors may not remember expensive, old develo                                       | Books                                              | computers                                          |            4.40 |        7.47 | 0.00295982952649859695
 AAAAAAAAGPJBAAAA | Friends would marry. Red, overseas activities meet interests; immediate schools must not look families. More criminal prod                                                                               | Books                                              | computers                                          |            9.60 |      911.46 | 0.36114674969510189817
 AAAAAAAAHPADAAAA | Used, young sizes take requirements. Electoral, standard stones worry still private scenes. Major, still bedrooms say all once effective years. Long new moments will own after the                      | Books                                              | computers                                          |            9.19 |     3471.04 |     1.3753261954026359
 AAAAAAAAIBNAAAAA | European, huma                                                                                                                                                                                           | Books                                              | computers                                          |            2.62 |      961.86 | 0.38111668384979122702
 AAAAAAAAICNAAAAA | Capital shoulders live vari                                                                                                                                                                              | Books                                              | computers                                          |            4.38 |    14590.17 |     5.7810463136056271
 AAAAAAAAJBADAAAA | Mean, good relations wake however strictly white possibilities. About aw                                                                                                                                 | Books                                              | computers                                          |            6.42 |     2916.00 |     1.1554033332355969
 AAAAAAAAJJGBAAAA | Strangers gain officially enough labour problems. Overall systems may not help below lives. Heroes find just apparently generous couple                                                                  | Books                                              | computers                                          |            7.15 |    12338.43 |     4.8888419577826082
 AAAAAAAAJMCCAAAA | Interesting programmes used to appear even. Symbolic prices go beautifu                                                                                                                                  | Books                                              | computers                                          |           97.63 |      256.70 | 0.10171194637914187925
 AAAAAAAAKIJBAAAA | Excellent, specific peri                                                                                                                                                                                 | Books                                              | computers                                          |            4.13 |     9565.80 |     3.7902459550977615
 AAAAAAAAKMOBAAAA | Heavily certain arms act as main, provincial visitors. Absent, real eyes show then english hands. In particular american                                                                                 | Books                                              | computers                                          |           82.00 |     1265.58 | 0.50145931086293096822
 AAAAAAAAKNFAAAAA | Poor eyes form again proper, eligible prisoners. Areas must not                                                                                                                                          | Books                                              | computers                                          |            8.15 |     1304.49 | 0.51687657550497386078
 AAAAAAAAKOLAAAAA | Independent govern                                                                                                                                                                                       | Books                                              | computers                                          |            2.69 |       77.70 | 0.03078698182181271530
 AAAAAAAAKOOAAAAA | S                                                                                                                                                                                                        | Books                                              | computers                                          |            1.13 |     6979.08 |     2.7653128583394683
(100 rows)

