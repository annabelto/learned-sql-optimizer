                                                                                                                                                                  QUERY PLAN                                                                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=70842.67..70842.92 rows=100 width=266)
   ->  Sort  (cost=70842.67..70842.96 rows=119 width=266)
         Sort Key: ((tmp1.sum_sales - tmp1.avg_monthly_sales)), tmp1.s_store_name
         ->  Subquery Scan on tmp1  (cost=70758.44..70838.56 rows=119 width=266)
               Filter: (CASE WHEN (tmp1.avg_monthly_sales <> '0'::numeric) THEN (abs((tmp1.sum_sales - tmp1.avg_monthly_sales)) / tmp1.avg_monthly_sales) ELSE NULL::numeric END > 0.1)
               ->  WindowAgg  (cost=70758.44..70830.21 rows=358 width=234)
                     ->  Incremental Sort  (cost=70758.44..70822.16 rows=358 width=202)
                           Sort Key: item.i_category, item.i_brand, store.s_store_name, store.s_company_name
                           Presorted Key: item.i_category
                           ->  Finalize GroupAggregate  (cost=70751.93..70801.60 rows=358 width=202)
                                 Group Key: item.i_category, item.i_class, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_moy
                                 ->  Gather Merge  (cost=70751.93..70791.17 rows=298 width=202)
                                       Workers Planned: 2
                                       ->  Partial GroupAggregate  (cost=69751.91..69756.75 rows=149 width=202)
                                             Group Key: item.i_category, item.i_class, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_moy
                                             ->  Sort  (cost=69751.91..69752.28 rows=149 width=176)
                                                   Sort Key: item.i_category, item.i_class, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_moy
                                                   ->  Hash Join  (cost=1499.92..69746.53 rows=149 width=176)
                                                         Hash Cond: (store_sales.ss_store_sk = store.s_store_sk)
                                                         ->  Nested Loop  (cost=1498.65..69744.71 rows=157 width=167)
                                                               ->  Parallel Hash Join  (cost=1498.34..68347.21 rows=32938 width=167)
                                                                     Hash Cond: (store_sales.ss_item_sk = item.i_item_sk)
                                                                     ->  Parallel Seq Scan on store_sales  (cost=0.00..63697.68 rows=1200168 width=18)
                                                                     ->  Parallel Hash  (cost=1494.71..1494.71 rows=291 width=157)
                                                                           ->  Parallel Seq Scan on item  (cost=0.00..1494.71 rows=291 width=157)
                                                                                 Filter: (((i_category = ANY ('{Books,Children,Electronics}'::bpchar[])) AND (i_class = ANY ('{history,school-uniforms,audio}'::bpchar[]))) OR ((i_category = ANY ('{Men,Sports,Shoes}'::bpchar[])) AND (i_class = ANY ('{pants,tennis,womens}'::bpchar[]))))
                                                               ->  Memoize  (cost=0.30..0.32 rows=1 width=8)
                                                                     Cache Key: store_sales.ss_sold_date_sk
                                                                     Cache Mode: logical
                                                                     ->  Index Scan using date_dim_pkey on date_dim  (cost=0.29..0.31 rows=1 width=8)
                                                                           Index Cond: (d_date_sk = store_sales.ss_sold_date_sk)
                                                                           Filter: (d_year = 2001)
                                                         ->  Hash  (cost=1.12..1.12 rows=12 width=17)
                                                               ->  Seq Scan on store  (cost=0.00..1.12 rows=12 width=17)
(34 rows)

                     i_category                     |                      i_class                       |                      i_brand                       | s_store_name | s_company_name | d_moy | sum_sales |   avg_monthly_sales   
----------------------------------------------------+----------------------------------------------------+----------------------------------------------------+--------------+----------------+-------+-----------+-----------------------
 Men                                                | pants                                              | exportiimporto #2                                  | ought        | Unknown        |     3 |   2678.97 | 6704.5391666666666667
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | eing         | Unknown        |     4 |   3046.94 | 6954.4608333333333333
 Shoes                                              | womens                                             | amalgedu pack #2                                   | bar          | Unknown        |     1 |   3255.61 | 7129.9958333333333333
 Shoes                                              | womens                                             | amalgedu pack #2                                   | eing         | Unknown        |     3 |   3288.54 | 7079.0716666666666667
 Men                                                | pants                                              | exportiimporto #2                                  | eing         | Unknown        |     2 |   3319.34 | 7022.5750000000000000
 Men                                                | pants                                              | exportiimporto #2                                  | eing         | Unknown        |     4 |   3349.29 | 7022.5750000000000000
 Shoes                                              | womens                                             | amalgedu pack #2                                   | bar          | Unknown        |     2 |   3474.82 | 7129.9958333333333333
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | ese          | Unknown        |     3 |   3365.94 | 7020.6200000000000000
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | able         | Unknown        |     2 |   3224.24 | 6854.8266666666666667
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | ation        | Unknown        |     1 |   3283.80 | 6849.8325000000000000
 Shoes                                              | womens                                             | amalgedu pack #2                                   | able         | Unknown        |     3 |   3572.60 | 7117.0308333333333333
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | able         | Unknown        |     3 |   3320.38 | 6854.8266666666666667
 Shoes                                              | womens                                             | amalgedu pack #2                                   | able         | Unknown        |     7 |   3589.10 | 7117.0308333333333333
 Men                                                | pants                                              | exportiimporto #2                                  | ought        | Unknown        |     6 |   3201.23 | 6704.5391666666666667
 Shoes                                              | womens                                             | amalgedu pack #2                                   | ese          | Unknown        |     4 |   3508.75 | 7011.8750000000000000
 Shoes                                              | womens                                             | amalgedu pack #2                                   | ought        | Unknown        |     2 |   3434.56 | 6922.0475000000000000
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | eing         | Unknown        |     2 |   3469.77 | 6954.4608333333333333
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | ought        | Unknown        |     7 |   3519.64 | 6992.5216666666666667
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | bar          | Unknown        |     2 |   3096.99 | 6548.2816666666666667
 Men                                                | pants                                              | exportiimporto #2                                  | able         | Unknown        |     2 |   3568.39 | 6978.7941666666666667
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | ought        | Unknown        |     5 |   3602.84 | 6992.5216666666666667
 Men                                                | pants                                              | exportiimporto #2                                  | eing         | Unknown        |     5 |   3633.60 | 7022.5750000000000000
 Men                                                | pants                                              | exportiimporto #2                                  | ese          | Unknown        |     3 |   3332.14 | 6714.6558333333333333
 Shoes                                              | womens                                             | amalgedu pack #2                                   | ese          | Unknown        |     2 |   3670.91 | 7011.8750000000000000
 Shoes                                              | womens                                             | amalgedu pack #2                                   | bar          | Unknown        |     7 |   3800.81 | 7129.9958333333333333
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | able         | Unknown        |     4 |   3540.66 | 6854.8266666666666667
 Shoes                                              | womens                                             | amalgedu pack #2                                   | ese          | Unknown        |     5 |   3698.86 | 7011.8750000000000000
 Men                                                | pants                                              | exportiimporto #2                                  | ation        | Unknown        |     3 |   3193.41 | 6475.4650000000000000
 Shoes                                              | womens                                             | amalgedu pack #2                                   | able         | Unknown        |     6 |   3838.61 | 7117.0308333333333333
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | ese          | Unknown        |     5 |   3742.69 | 7020.6200000000000000
 Shoes                                              | womens                                             | amalgedu pack #2                                   | bar          | Unknown        |     4 |   3858.39 | 7129.9958333333333333
 Men                                                | pants                                              | exportiimporto #2                                  | ation        | Unknown        |     7 |   3209.92 | 6475.4650000000000000
 Shoes                                              | womens                                             | amalgedu pack #2                                   | ation        | Unknown        |     2 |   3602.10 | 6845.8316666666666667
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | eing         | Unknown        |     5 |   3740.57 | 6954.4608333333333333
 Men                                                | pants                                              | exportiimporto #2                                  | ation        | Unknown        |     4 |   3294.16 | 6475.4650000000000000
 Men                                                | pants                                              | exportiimporto #2                                  | ese          | Unknown        |     4 |   3546.41 | 6714.6558333333333333
 Men                                                | pants                                              | exportiimporto #2                                  | eing         | Unknown        |     7 |   3857.06 | 7022.5750000000000000
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | bar          | Unknown        |     5 |   3396.37 | 6548.2816666666666667
 Men                                                | pants                                              | exportiimporto #2                                  | able         | Unknown        |     3 |   3845.76 | 6978.7941666666666667
 Shoes                                              | womens                                             | amalgedu pack #2                                   | bar          | Unknown        |     3 |   4006.25 | 7129.9958333333333333
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | ought        | Unknown        |     2 |   3870.50 | 6992.5216666666666667
 Men                                                | pants                                              | exportiimporto #2                                  | bar          | Unknown        |     3 |   3533.24 | 6651.8550000000000000
 Shoes                                              | womens                                             | amalgedu pack #2                                   | able         | Unknown        |     2 |   3999.84 | 7117.0308333333333333
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | ought        | Unknown        |     6 |   3884.41 | 6992.5216666666666667
 Men                                                | pants                                              | exportiimporto #2                                  | ought        | Unknown        |     2 |   3598.85 | 6704.5391666666666667
 Shoes                                              | womens                                             | amalgedu pack #2                                   | ought        | Unknown        |     3 |   3821.83 | 6922.0475000000000000
 Shoes                                              | womens                                             | amalgedu pack #2                                   | ation        | Unknown        |     4 |   3749.21 | 6845.8316666666666667
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | ese          | Unknown        |     2 |   3960.68 | 7020.6200000000000000
 Shoes                                              | womens                                             | amalgedu pack #2                                   | ought        | Unknown        |     6 |   3866.87 | 6922.0475000000000000
 Shoes                                              | womens                                             | amalgedu pack #2                                   | able         | Unknown        |     4 |   4061.98 | 7117.0308333333333333
 Shoes                                              | womens                                             | amalgedu pack #2                                   | eing         | Unknown        |     5 |   4040.06 | 7079.0716666666666667
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | ese          | Unknown        |     7 |   3982.40 | 7020.6200000000000000
 Shoes                                              | womens                                             | amalgedu pack #2                                   | eing         | Unknown        |     4 |   4065.33 | 7079.0716666666666667
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | bar          | Unknown        |     1 |   3534.77 | 6548.2816666666666667
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | eing         | Unknown        |     3 |   3951.69 | 6954.4608333333333333
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | ation        | Unknown        |     3 |   3849.53 | 6849.8325000000000000
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | eing         | Unknown        |     6 |   3955.18 | 6954.4608333333333333
 Shoes                                              | womens                                             | amalgedu pack #2                                   | ought        | Unknown        |     4 |   3957.74 | 6922.0475000000000000
 Men                                                | pants                                              | exportiimporto #2                                  | able         | Unknown        |     5 |   4024.18 | 6978.7941666666666667
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | ought        | Unknown        |     4 |   4039.94 | 6992.5216666666666667
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | bar          | Unknown        |     3 |   3620.02 | 6548.2816666666666667
 Shoes                                              | womens                                             | amalgedu pack #2                                   | ation        | Unknown        |     3 |   3920.05 | 6845.8316666666666667
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | able         | Unknown        |     1 |   3968.66 | 6854.8266666666666667
 Men                                                | pants                                              | exportiimporto #2                                  | bar          | Unknown        |     4 |   3767.67 | 6651.8550000000000000
 Shoes                                              | womens                                             | amalgedu pack #2                                   | ation        | Unknown        |     6 |   3966.96 | 6845.8316666666666667
 Shoes                                              | womens                                             | amalgedu pack #2                                   | ation        | Unknown        |     5 |   3971.62 | 6845.8316666666666667
 Men                                                | pants                                              | exportiimporto #2                                  | ese          | Unknown        |     6 |   3840.80 | 6714.6558333333333333
 Men                                                | pants                                              | exportiimporto #2                                  | ought        | Unknown        |     4 |   3830.69 | 6704.5391666666666667
 Shoes                                              | womens                                             | amalgedu pack #2                                   | eing         | Unknown        |     2 |   4214.02 | 7079.0716666666666667
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | ation        | Unknown        |     6 |   3985.43 | 6849.8325000000000000
 Men                                                | pants                                              | exportiimporto #2                                  | able         | Unknown        |     1 |   4120.15 | 6978.7941666666666667
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | able         | Unknown        |     6 |   4018.48 | 6854.8266666666666667
 Men                                                | pants                                              | exportiimporto #2                                  | bar          | Unknown        |     1 |   3817.35 | 6651.8550000000000000
 Shoes                                              | womens                                             | amalgedu pack #2                                   | ation        | Unknown        |     7 |   4024.14 | 6845.8316666666666667
 Shoes                                              | womens                                             | amalgedu pack #2                                   | ought        | Unknown        |     1 |   4102.87 | 6922.0475000000000000
 Shoes                                              | womens                                             | amalgedu pack #2                                   | able         | Unknown        |     5 |   4316.05 | 7117.0308333333333333
 Men                                                | pants                                              | exportiimporto #2                                  | ese          | Unknown        |     7 |   3933.64 | 6714.6558333333333333
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | ation        | Unknown        |     2 |   4082.04 | 6849.8325000000000000
 Men                                                | pants                                              | exportiimporto #2                                  | eing         | Unknown        |     3 |   4270.78 | 7022.5750000000000000
 Shoes                                              | womens                                             | amalgedu pack #2                                   | eing         | Unknown        |     6 |   4340.44 | 7079.0716666666666667
 Shoes                                              | womens                                             | amalgedu pack #2                                   | ese          | Unknown        |     3 |   4277.15 | 7011.8750000000000000
 Men                                                | pants                                              | exportiimporto #2                                  | ese          | Unknown        |     5 |   3985.32 | 6714.6558333333333333
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | ought        | Unknown        |     1 |   4268.19 | 6992.5216666666666667
 Men                                                | pants                                              | exportiimporto #2                                  | ation        | Unknown        |     2 |   3766.32 | 6475.4650000000000000
 Shoes                                              | womens                                             | amalgedu pack #2                                   | bar          | Unknown        |     5 |   4421.69 | 7129.9958333333333333
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | bar          | Unknown        |     4 |   3867.04 | 6548.2816666666666667
 Shoes                                              | womens                                             | amalgedu pack #2                                   | ese          | Unknown        |     6 |   4334.41 | 7011.8750000000000000
 Men                                                | pants                                              | exportiimporto #2                                  | bar          | Unknown        |     6 |   3994.01 | 6651.8550000000000000
 Men                                                | pants                                              | exportiimporto #2                                  | able         | Unknown        |     4 |   4351.16 | 6978.7941666666666667
 Shoes                                              | womens                                             | amalgedu pack #2                                   | ese          | Unknown        |     1 |   4424.39 | 7011.8750000000000000
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | ation        | Unknown        |     5 |   4270.38 | 6849.8325000000000000
 Men                                                | pants                                              | exportiimporto #2                                  | ation        | Unknown        |     5 |   3926.87 | 6475.4650000000000000
 Men                                                | pants                                              | exportiimporto #2                                  | ese          | Unknown        |     2 |   4185.45 | 6714.6558333333333333
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | able         | Unknown        |     7 |   4335.34 | 6854.8266666666666667
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | ation        | Unknown        |     4 |   4358.50 | 6849.8325000000000000
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | eing         | Unknown        |     7 |   4471.60 | 6954.4608333333333333
 Men                                                | pants                                              | exportiimporto #2                                  | ation        | Unknown        |     1 |   4003.72 | 6475.4650000000000000
 Men                                                | pants                                              | exportiimporto #2                                  | bar          | Unknown        |     2 |   4180.85 | 6651.8550000000000000
 Men                                                | pants                                              | exportiimporto #2                                  | able         | Unknown        |     7 |   4512.94 | 6978.7941666666666667
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | ese          | Unknown        |     1 |   4572.52 | 7020.6200000000000000
(100 rows)

