                                                                                                                                                                  QUERY PLAN                                                                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=70842.67..70842.92 rows=100 width=266)
   ->  Sort  (cost=70842.67..70842.96 rows=119 width=266)
         Sort Key: ((tmp1.sum_sales - tmp1.avg_monthly_sales)) DESC, tmp1.s_store_name
         ->  Subquery Scan on tmp1  (cost=70758.44..70838.56 rows=119 width=266)
               Filter: (CASE WHEN (tmp1.avg_monthly_sales <> '0'::numeric) THEN (abs((tmp1.sum_sales - tmp1.avg_monthly_sales)) / tmp1.avg_monthly_sales) ELSE NULL::numeric END > 0.1)
               ->  WindowAgg  (cost=70758.44..70830.21 rows=358 width=234)
                     ->  Incremental Sort  (cost=70758.44..70822.16 rows=358 width=202)
                           Sort Key: item.i_category, item.i_brand, store.s_store_name, store.s_company_name
                           Presorted Key: item.i_category
                           ->  Finalize GroupAggregate  (cost=70751.93..70801.60 rows=358 width=202)
                                 Group Key: item.i_category, item.i_class, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_moy
                                 ->  Gather Merge  (cost=70751.93..70791.17 rows=298 width=202)
                                       Workers Planned: 2
                                       ->  Partial GroupAggregate  (cost=69751.91..69756.75 rows=149 width=202)
                                             Group Key: item.i_category, item.i_class, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_moy
                                             ->  Sort  (cost=69751.91..69752.28 rows=149 width=176)
                                                   Sort Key: item.i_category, item.i_class, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_moy
                                                   ->  Hash Join  (cost=1499.92..69746.53 rows=149 width=176)
                                                         Hash Cond: (store_sales.ss_store_sk = store.s_store_sk)
                                                         ->  Nested Loop  (cost=1498.65..69744.71 rows=157 width=167)
                                                               ->  Parallel Hash Join  (cost=1498.34..68347.21 rows=32938 width=167)
                                                                     Hash Cond: (store_sales.ss_item_sk = item.i_item_sk)
                                                                     ->  Parallel Seq Scan on store_sales  (cost=0.00..63697.68 rows=1200168 width=18)
                                                                     ->  Parallel Hash  (cost=1494.71..1494.71 rows=291 width=157)
                                                                           ->  Parallel Seq Scan on item  (cost=0.00..1494.71 rows=291 width=157)
                                                                                 Filter: (((i_category = ANY ('{Books,Children,Electronics}'::bpchar[])) AND (i_class = ANY ('{history,school-uniforms,audio}'::bpchar[]))) OR ((i_category = ANY ('{Men,Sports,Shoes}'::bpchar[])) AND (i_class = ANY ('{pants,tennis,womens}'::bpchar[]))))
                                                               ->  Memoize  (cost=0.30..0.32 rows=1 width=8)
                                                                     Cache Key: store_sales.ss_sold_date_sk
                                                                     Cache Mode: logical
                                                                     ->  Index Scan using date_dim_pkey on date_dim  (cost=0.29..0.31 rows=1 width=8)
                                                                           Index Cond: (d_date_sk = store_sales.ss_sold_date_sk)
                                                                           Filter: (d_year = 2001)
                                                         ->  Hash  (cost=1.12..1.12 rows=12 width=17)
                                                               ->  Seq Scan on store  (cost=0.00..1.12 rows=12 width=17)
(34 rows)

                     i_category                     |                      i_class                       |                      i_brand                       | s_store_name | s_company_name | d_moy | sum_sales |   avg_monthly_sales   
----------------------------------------------------+----------------------------------------------------+----------------------------------------------------+--------------+----------------+-------+-----------+-----------------------
 Shoes                                              | womens                                             | amalgedu pack #2                                   | ought        | Unknown        |    12 |  15496.54 | 6922.0475000000000000
 Men                                                | pants                                              | exportiimporto #2                                  | ation        | Unknown        |    12 |  14411.24 | 6475.4650000000000000
 Shoes                                              | womens                                             | amalgedu pack #2                                   | bar          | Unknown        |    12 |  14996.77 | 7129.9958333333333333
 Men                                                | pants                                              | exportiimporto #2                                  | eing         | Unknown        |    12 |  14816.59 | 7022.5750000000000000
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | ese          | Unknown        |    12 |  14692.02 | 7020.6200000000000000
 Shoes                                              | womens                                             | amalgedu pack #2                                   | able         | Unknown        |    12 |  14713.02 | 7117.0308333333333333
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | bar          | Unknown        |    12 |  14107.94 | 6548.2816666666666667
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | eing         | Unknown        |    12 |  14473.25 | 6954.4608333333333333
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | ought        | Unknown        |    12 |  14382.35 | 6992.5216666666666667
 Men                                                | pants                                              | exportiimporto #2                                  | ese          | Unknown        |    12 |  14091.50 | 6714.6558333333333333
 Men                                                | pants                                              | exportiimporto #2                                  | ation        | Unknown        |    11 |  13838.90 | 6475.4650000000000000
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | able         | Unknown        |    11 |  14200.87 | 6854.8266666666666667
 Shoes                                              | womens                                             | amalgedu pack #2                                   | eing         | Unknown        |    12 |  14219.92 | 7079.0716666666666667
 Men                                                | pants                                              | exportiimporto #2                                  | bar          | Unknown        |    12 |  13721.65 | 6651.8550000000000000
 Shoes                                              | womens                                             | amalgedu pack #2                                   | ation        | Unknown        |    12 |  13867.63 | 6845.8316666666666667
 Men                                                | pants                                              | exportiimporto #2                                  | ought        | Unknown        |    12 |  13583.96 | 6704.5391666666666667
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | able         | Unknown        |    12 |  13648.07 | 6854.8266666666666667
 Shoes                                              | womens                                             | amalgedu pack #2                                   | able         | Unknown        |    11 |  13783.48 | 7117.0308333333333333
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | ation        | Unknown        |    11 |  13486.10 | 6849.8325000000000000
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | eing         | Unknown        |    11 |  13556.78 | 6954.4608333333333333
 Shoes                                              | womens                                             | amalgedu pack #2                                   | bar          | Unknown        |    11 |  13729.83 | 7129.9958333333333333
 Men                                                | pants                                              | exportiimporto #2                                  | eing         | Unknown        |    11 |  13485.70 | 7022.5750000000000000
 Shoes                                              | womens                                             | amalgedu pack #2                                   | ation        | Unknown        |    11 |  13179.59 | 6845.8316666666666667
 Shoes                                              | womens                                             | amalgedu pack #2                                   | ought        | Unknown        |    11 |  13214.56 | 6922.0475000000000000
 Shoes                                              | womens                                             | amalgedu pack #2                                   | ese          | Unknown        |    11 |  13233.26 | 7011.8750000000000000
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | ation        | Unknown        |    12 |  13059.82 | 6849.8325000000000000
 Shoes                                              | womens                                             | amalgedu pack #2                                   | eing         | Unknown        |    11 |  13161.90 | 7079.0716666666666667
 Shoes                                              | womens                                             | amalgedu pack #2                                   | ese          | Unknown        |    12 |  13045.12 | 7011.8750000000000000
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | ought        | Unknown        |    11 |  12924.47 | 6992.5216666666666667
 Men                                                | pants                                              | exportiimporto #2                                  | able         | Unknown        |    12 |  12904.94 | 6978.7941666666666667
 Men                                                | pants                                              | exportiimporto #2                                  | able         | Unknown        |    11 |  12839.98 | 6978.7941666666666667
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | ese          | Unknown        |    11 |  12190.37 | 7020.6200000000000000
 Men                                                | pants                                              | exportiimporto #2                                  | ese          | Unknown        |    11 |  11692.02 | 6714.6558333333333333
 Men                                                | pants                                              | exportiimporto #2                                  | ought        | Unknown        |    11 |  11654.28 | 6704.5391666666666667
 Men                                                | pants                                              | exportiimporto #2                                  | bar          | Unknown        |    11 |  11403.99 | 6651.8550000000000000
 Shoes                                              | womens                                             | amalgedu pack #2                                   | eing         | Unknown        |    10 |  11268.16 | 7079.0716666666666667
 Shoes                                              | womens                                             | amalgedu pack #2                                   | bar          | Unknown        |    10 |  11000.49 | 7129.9958333333333333
 Men                                                | pants                                              | exportiimporto #2                                  | bar          | Unknown        |    10 |  10519.05 | 6651.8550000000000000
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | ought        | Unknown        |     8 |  10740.06 | 6992.5216666666666667
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | eing         | Unknown        |     8 |  10682.25 | 6954.4608333333333333
 Men                                                | pants                                              | exportiimporto #2                                  | ought        | Unknown        |     8 |  10365.35 | 6704.5391666666666667
 Shoes                                              | womens                                             | amalgedu pack #2                                   | ese          | Unknown        |     9 |  10592.00 | 7011.8750000000000000
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | bar          | Unknown        |    11 |   9962.34 | 6548.2816666666666667
 Men                                                | pants                                              | exportiimporto #2                                  | eing         | Unknown        |     8 |  10307.61 | 7022.5750000000000000
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | bar          | Unknown        |     8 |   9616.76 | 6548.2816666666666667
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | ation        | Unknown        |    10 |   9908.52 | 6849.8325000000000000
 Shoes                                              | womens                                             | amalgedu pack #2                                   | ation        | Unknown        |    10 |   9825.40 | 6845.8316666666666667
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | able         | Unknown        |     8 |   9816.71 | 6854.8266666666666667
 Men                                                | pants                                              | exportiimporto #2                                  | able         | Unknown        |     8 |   9882.98 | 6978.7941666666666667
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | ese          | Unknown        |     8 |   9914.37 | 7020.6200000000000000
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | bar          | Unknown        |     9 |   9436.55 | 6548.2816666666666667
 Men                                                | pants                                              | exportiimporto #2                                  | able         | Unknown        |    10 |   9764.59 | 6978.7941666666666667
 Shoes                                              | womens                                             | amalgedu pack #2                                   | ought        | Unknown        |     8 |   9668.15 | 6922.0475000000000000
 Men                                                | pants                                              | exportiimporto #2                                  | ese          | Unknown        |    10 |   9367.57 | 6714.6558333333333333
 Shoes                                              | womens                                             | amalgedu pack #2                                   | bar          | Unknown        |     8 |   9770.19 | 7129.9958333333333333
 Shoes                                              | womens                                             | amalgedu pack #2                                   | ese          | Unknown        |    10 |   9645.20 | 7011.8750000000000000
 Men                                                | pants                                              | exportiimporto #2                                  | ese          | Unknown        |     9 |   9300.51 | 6714.6558333333333333
 Shoes                                              | womens                                             | amalgedu pack #2                                   | able         | Unknown        |     8 |   9665.82 | 7117.0308333333333333
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | able         | Unknown        |    10 |   9398.75 | 6854.8266666666666667
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | eing         | Unknown        |    10 |   9421.79 | 6954.4608333333333333
 Shoes                                              | womens                                             | amalgedu pack #2                                   | ought        | Unknown        |    10 |   9288.06 | 6922.0475000000000000
 Men                                                | pants                                              | exportiimporto #2                                  | ought        | Unknown        |     9 |   9006.31 | 6704.5391666666666667
 Men                                                | pants                                              | exportiimporto #2                                  | ese          | Unknown        |     8 |   8974.08 | 6714.6558333333333333
 Men                                                | pants                                              | exportiimporto #2                                  | able         | Unknown        |     9 |   9170.85 | 6978.7941666666666667
 Men                                                | pants                                              | exportiimporto #2                                  | bar          | Unknown        |     9 |   8814.58 | 6651.8550000000000000
 Men                                                | pants                                              | exportiimporto #2                                  | ation        | Unknown        |    10 |   8608.34 | 6475.4650000000000000
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | ation        | Unknown        |     8 |   8961.91 | 6849.8325000000000000
 Men                                                | pants                                              | exportiimporto #2                                  | ought        | Unknown        |    10 |   8776.17 | 6704.5391666666666667
 Shoes                                              | womens                                             | amalgedu pack #2                                   | ese          | Unknown        |     8 |   9051.25 | 7011.8750000000000000
 Men                                                | pants                                              | exportiimporto #2                                  | eing         | Unknown        |     9 |   9038.74 | 7022.5750000000000000
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | ese          | Unknown        |     9 |   9018.40 | 7020.6200000000000000
 Shoes                                              | womens                                             | amalgedu pack #2                                   | able         | Unknown        |    10 |   9047.46 | 7117.0308333333333333
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | ese          | Unknown        |    10 |   8916.65 | 7020.6200000000000000
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | bar          | Unknown        |    10 |   8378.82 | 6548.2816666666666667
 Shoes                                              | womens                                             | amalgedu pack #2                                   | ation        | Unknown        |     9 |   8625.94 | 6845.8316666666666667
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | ought        | Unknown        |    10 |   8767.86 | 6992.5216666666666667
 Shoes                                              | womens                                             | amalgedu pack #2                                   | able         | Unknown        |     9 |   8714.11 | 7117.0308333333333333
 Shoes                                              | womens                                             | amalgedu pack #2                                   | ation        | Unknown        |     8 |   8426.63 | 6845.8316666666666667
 Men                                                | pants                                              | exportiimporto #2                                  | ation        | Unknown        |     9 |   7932.83 | 6475.4650000000000000
 Shoes                                              | womens                                             | amalgedu pack #2                                   | bar          | Unknown        |     9 |   8545.24 | 7129.9958333333333333
 Shoes                                              | womens                                             | amalgedu pack #2                                   | eing         | Unknown        |     9 |   8462.33 | 7079.0716666666666667
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | ought        | Unknown        |     9 |   8299.80 | 6992.5216666666666667
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | ation        | Unknown        |     9 |   8051.69 | 6849.8325000000000000
 Shoes                                              | womens                                             | amalgedu pack #2                                   | eing         | Unknown        |     8 |   8247.29 | 7079.0716666666666667
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | able         | Unknown        |     9 |   7992.67 | 6854.8266666666666667
 Books                                              | history                                            | scholarmaxi #2                                     | able         | Unknown        |    12 |   1508.83 |  553.4025000000000000
 Children                                           | school-uniforms                                    | edu packexporti #2                                 | eing         | Unknown        |     9 |   7878.82 | 6954.4608333333333333
 Books                                              | history                                            | scholarmaxi #12                                    | ese          | Unknown        |    11 |   1299.87 |  400.9816666666666667
 Books                                              | history                                            | scholarmaxi #6                                     | eing         | Unknown        |    11 |   1214.99 |  402.4816666666666667
 Books                                              | history                                            | scholarmaxi #6                                     | able         | Unknown        |    12 |   1139.09 |  341.3308333333333333
 Men                                                | pants                                              | exportiimporto #2                                  | eing         | Unknown        |    10 |   7797.00 | 7022.5750000000000000
 Books                                              | history                                            | scholarmaxi #12                                    | bar          | Unknown        |    11 |   1095.91 |  395.6941666666666667
 Men                                                | pants                                              | exportiimporto #2                                  | bar          | Unknown        |     8 |   7348.98 | 6651.8550000000000000
 Books                                              | history                                            | scholarmaxi #10                                    | ought        | Unknown        |    12 |    956.10 |  287.1983333333333333
 Books                                              | history                                            | scholarmaxi #2                                     | able         | Unknown        |    10 |   1217.66 |  553.4025000000000000
 Sports                                             | tennis                                             | edu packmaxi #10                                   | able         | Unknown        |    12 |    951.38 |  290.1633333333333333
 Books                                              | history                                            | scholarmaxi #2                                     | ought        | Unknown        |    10 |   1142.16 |  522.9066666666666667
 Books                                              | history                                            | scholarmaxi #2                                     | bar          | Unknown        |    12 |   1075.96 |  458.4808333333333333
 Books                                              | history                                            | scholarmaxi #6                                     | ese          | Unknown        |    12 |   1000.68 |  401.7316666666666667
 Books                                              | history                                            | scholarmaxi #6                                     | ese          | Unknown        |    11 |    980.81 |  401.7316666666666667
(100 rows)

