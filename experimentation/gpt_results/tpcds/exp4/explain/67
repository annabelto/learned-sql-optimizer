                                                                                           QUERY PLAN                                                                                            
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=69778.88..69833.47 rows=100 width=273)
   ->  Incremental Sort  (cost=69778.88..81310.50 rows=21124 width=273)
         Sort Key: dw2.i_category, dw2.i_class, dw2.i_brand, dw2.i_product_name, dw2.d_year, dw2.d_qoy, dw2.d_moy, dw2.s_store_id, dw2.sumsales, dw2.rk
         Presorted Key: dw2.i_category
         ->  Subquery Scan on dw2  (cost=69722.41..79858.29 rows=21124 width=273)
               Filter: (dw2.rk <= 100)
               ->  WindowAgg  (cost=69722.41..79066.15 rows=63371 width=273)
                     ->  Incremental Sort  (cost=69722.41..77957.16 rows=63371 width=265)
                           Sort Key: dw1.i_category, dw1.sumsales DESC
                           Presorted Key: dw1.i_category
                           ->  Subquery Scan on dw1  (cost=69685.43..72855.29 rows=63371 width=265)
                                 ->  GroupAggregate  (cost=69685.43..72221.58 rows=63371 width=265)
                                       Group Key: item.i_category, item.i_class, item.i_brand, item.i_product_name, date_dim.d_year, date_dim.d_qoy, date_dim.d_moy, store.s_store_id
                                       Group Key: item.i_category, item.i_class, item.i_brand, item.i_product_name, date_dim.d_year, date_dim.d_qoy, date_dim.d_moy
                                       Group Key: item.i_category, item.i_class, item.i_brand, item.i_product_name, date_dim.d_year, date_dim.d_qoy
                                       Group Key: item.i_category, item.i_class, item.i_brand, item.i_product_name, date_dim.d_year
                                       Group Key: item.i_category, item.i_class, item.i_brand, item.i_product_name
                                       Group Key: item.i_category, item.i_class, item.i_brand
                                       Group Key: item.i_category, item.i_class
                                       Group Key: item.i_category
                                       Group Key: ()
                                       ->  Gather Merge  (cost=69685.43..71096.31 rows=12114 width=243)
                                             Workers Planned: 2
                                             ->  Sort  (cost=68685.41..68698.03 rows=5048 width=243)
                                                   Sort Key: item.i_category, item.i_class, item.i_brand, item.i_product_name, date_dim.d_year, date_dim.d_qoy, date_dim.d_moy, store.s_store_id
                                                   ->  Parallel Hash Join  (cost=1494.78..68374.92 rows=5048 width=243)
                                                         Hash Cond: (store_sales.ss_item_sk = item.i_item_sk)
                                                         ->  Hash Join  (cost=26.55..66893.43 rows=5048 width=43)
                                                               Hash Cond: (store_sales.ss_store_sk = store.s_store_sk)
                                                               ->  Hash Join  (cost=25.28..66873.58 rows=5295 width=30)
                                                                     Hash Cond: (store_sales.ss_sold_date_sk = date_dim.d_date_sk)
                                                                     ->  Parallel Seq Scan on store_sales  (cost=0.00..63697.68 rows=1200168 width=22)
                                                                     ->  Hash  (cost=21.05..21.05 rows=338 width=16)
                                                                           ->  Index Scan using idx_date_dim_month_seq on date_dim  (cost=0.29..21.05 rows=338 width=16)
                                                                                 Index Cond: ((d_month_seq >= 1217) AND (d_month_seq <= 1228))
                                                               ->  Hash  (cost=1.12..1.12 rows=12 width=21)
                                                                     ->  Seq Scan on store  (cost=0.00..1.12 rows=12 width=21)
                                                         ->  Parallel Hash  (cost=1335.88..1335.88 rows=10588 width=208)
                                                               ->  Parallel Seq Scan on item  (cost=0.00..1335.88 rows=10588 width=208)
(39 rows)

                     i_category                     |                      i_class                       |                      i_brand                       |                   i_product_name                   | d_year | d_qoy | d_moy |    s_store_id    | sumsales | rk 
----------------------------------------------------+----------------------------------------------------+----------------------------------------------------+----------------------------------------------------+--------+-------+-------+------------------+----------+----
 Books                                              | arts                                               | amalgmaxi #1                                       | eingbaroughtpri                                    |   2002 |     1 |     2 | AAAAAAAAKAAAAAAA |          |  1
 Books                                              | arts                                               | amalgmaxi #1                                       | eingbaroughtpri                                    |   2002 |     1 |     2 |                  |          |  1
 Books                                              | arts                                               | amalgmaxi #1                                       | eingcallybarese                                    |   2002 |     1 |     1 | AAAAAAAAHAAAAAAA |          |  1
 Books                                              | arts                                               | amalgmaxi #1                                       | eingeingpriationought                              |   2002 |     1 |     2 | AAAAAAAAKAAAAAAA |          |  1
 Books                                              | arts                                               | amalgmaxi #1                                       | eingeseeingcallyought                              |   2002 |     2 |     5 | AAAAAAAABAAAAAAA |          |  1
 Books                                              | arts                                               | amalgmaxi #10                                      | ationprianti                                       |   2001 |     2 |     6 | AAAAAAAAHAAAAAAA |          |  1
 Books                                              | arts                                               | amalgmaxi #10                                      | ationprianti                                       |   2001 |     2 |     6 |                  |          |  1
 Books                                              | arts                                               | amalgmaxi #10                                      | ationprianti                                       |   2001 |     2 |       |                  |          |  1
 Books                                              | arts                                               | amalgmaxi #10                                      | n stcallyoughtoughtought                           |   2001 |     2 |     6 | AAAAAAAAEAAAAAAA |          |  1
 Books                                              | arts                                               | amalgmaxi #10                                      | prioughtoughtcallyought                            |   2001 |     4 |    11 | AAAAAAAAKAAAAAAA |          |  1
 Books                                              | arts                                               | amalgmaxi #12                                      | ationbarought                                      |   2001 |     3 |     7 | AAAAAAAAIAAAAAAA |          |  1
 Books                                              | arts                                               | amalgmaxi #12                                      | oughtoughtationoughtought                          |   2001 |     4 |    12 | AAAAAAAAHAAAAAAA |          |  1
 Books                                              | arts                                               | amalgmaxi #12                                      | prieseantieing                                     |   2001 |     4 |    11 | AAAAAAAACAAAAAAA |          |  1
 Books                                              | arts                                               | amalgmaxi #2                                       | priationbarn st                                    |   2001 |     3 |     7 | AAAAAAAAEAAAAAAA |          |  1
 Books                                              | arts                                               | amalgmaxi #2                                       | priationbarn st                                    |   2001 |     3 |     7 |                  |          |  1
 Books                                              | arts                                               | amalgmaxi #2                                       | prioughteseanti                                    |   2002 |     2 |     5 | AAAAAAAABAAAAAAA |          |  1
 Books                                              | arts                                               | amalgmaxi #6                                       | anticallycallypri                                  |   2001 |     4 |    11 | AAAAAAAAEAAAAAAA |          |  1
 Books                                              | arts                                               | amalgmaxi #7                                       | eseationbaration                                   |   2002 |     2 |     4 | AAAAAAAAKAAAAAAA |          |  1
 Books                                              | arts                                               | amalgmaxi #8                                       | antiprieingableought                               |   2002 |     1 |     3 | AAAAAAAAEAAAAAAA |          |  1
 Books                                              | arts                                               | amalgmaxi #8                                       | ationcallyationoughtought                          |   2002 |     1 |     3 | AAAAAAAAIAAAAAAA |          |  1
 Books                                              | business                                           | importomaxi #1                                     | esecallyoughtese                                   |   2002 |     2 |     5 | AAAAAAAAKAAAAAAA |          |  1
 Books                                              | business                                           | importomaxi #10                                    | antieseprin st                                     |   2002 |     1 |     2 | AAAAAAAAKAAAAAAA |          |  1
 Books                                              | business                                           | importomaxi #10                                    | n steingableanti                                   |   2001 |     2 |     6 | AAAAAAAAHAAAAAAA |          |  1
 Books                                              | business                                           | importomaxi #10                                    | oughtableableese                                   |   2001 |     4 |    11 | AAAAAAAAEAAAAAAA |          |  1
 Books                                              | business                                           | importomaxi #10                                    | priantioughtantiought                              |   2001 |     3 |     7 | AAAAAAAAEAAAAAAA |          |  1
 Books                                              | business                                           | importomaxi #12                                    | ationeingn steing                                  |   2001 |     4 |    10 | AAAAAAAAKAAAAAAA |          |  1
 Books                                              | business                                           | importomaxi #12                                    | prieingeingought                                   |   2001 |     3 |     7 | AAAAAAAACAAAAAAA |          |  1
 Books                                              | business                                           | importomaxi #12                                    | prieingeingought                                   |   2001 |     3 |     7 | AAAAAAAAHAAAAAAA |          |  1
 Books                                              | business                                           | importomaxi #2                                     | ationn stantibarought                              |   2002 |     1 |     1 | AAAAAAAAEAAAAAAA |          |  1
 Books                                              | business                                           | importomaxi #4                                     | ationbaroughtbarought                              |   2001 |     4 |    12 | AAAAAAAAIAAAAAAA |          |  1
 Books                                              | business                                           | importomaxi #4                                     | ationcallyeseought                                 |   2001 |     2 |     6 | AAAAAAAACAAAAAAA |          |  1
 Books                                              | business                                           | importomaxi #6                                     | antieingesecally                                   |   2001 |     3 |     8 | AAAAAAAACAAAAAAA |          |  1
 Books                                              | business                                           | importomaxi #6                                     | oughteingeingantiought                             |   2001 |     3 |     7 | AAAAAAAABAAAAAAA |          |  1
 Books                                              | business                                           | importomaxi #6                                     | oughteingn stoughtought                            |   2001 |     2 |     6 | AAAAAAAAKAAAAAAA |          |  1
 Books                                              | business                                           | importomaxi #7                                     | eseationn stbarought                               |   2002 |     2 |     4 | AAAAAAAABAAAAAAA |          |  1
 Books                                              | business                                           | importomaxi #8                                     | antipricallyoughtought                             |   2002 |     1 |     1 | AAAAAAAAEAAAAAAA |          |  1
 Books                                              | business                                           | importomaxi #8                                     | ationcallyablepriought                             |   2001 |     4 |    12 | AAAAAAAAKAAAAAAA |          |  1
 Books                                              | business                                           | importomaxi #8                                     | oughtoughtablen st                                 |   2001 |     2 |     6 | AAAAAAAACAAAAAAA |          |  1
 Books                                              | computers                                          | exportimaxi #1                                     | ableationn stpri                                   |   2002 |     2 |     5 | AAAAAAAABAAAAAAA |          |  1
 Books                                              | computers                                          | exportimaxi #1                                     | barcallyprically                                   |   2002 |     2 |     4 | AAAAAAAAIAAAAAAA |          |  1
 Books                                              | computers                                          | exportimaxi #1                                     | barcallyprically                                   |   2002 |     2 |     4 |                  |          |  1
 Books                                              | computers                                          | exportimaxi #1                                     | callyationoughtpriought                            |   2002 |     1 |     1 | AAAAAAAACAAAAAAA |          |  1
 Books                                              | computers                                          | exportimaxi #1                                     | eseeseoughtableought                               |   2002 |     1 |     3 | AAAAAAAABAAAAAAA |          |  1
 Books                                              | computers                                          | exportimaxi #1                                     | eseeseoughtableought                               |   2002 |     1 |     3 |                  |          |  1
 Books                                              | computers                                          | exportimaxi #10                                    | antibarcallycallyought                             |   2001 |     3 |     9 | AAAAAAAACAAAAAAA |          |  1
 Books                                              | computers                                          | exportimaxi #10                                    | ationantiationationought                           |   2002 |     1 |     3 | AAAAAAAAHAAAAAAA |          |  1
 Books                                              | computers                                          | exportimaxi #10                                    | oughtbarantically                                  |   2001 |     4 |    10 | AAAAAAAAEAAAAAAA |          |  1
 Books                                              | computers                                          | exportimaxi #12                                    | antin stbarpri                                     |   2001 |     3 |     7 | AAAAAAAACAAAAAAA |          |  1
 Books                                              | computers                                          | exportimaxi #12                                    | antin stbarpri                                     |   2001 |     3 |     7 |                  |          |  1
 Books                                              | computers                                          | exportimaxi #12                                    | antioughtoughtbarought                             |   2001 |     4 |    11 | AAAAAAAAEAAAAAAA |          |  1
 Books                                              | computers                                          | exportimaxi #12                                    | antipriantiese                                     |   2001 |     3 |     7 | AAAAAAAAEAAAAAAA |          |  1
 Books                                              | computers                                          | exportimaxi #12                                    | ationableeseought                                  |   2001 |     3 |     9 | AAAAAAAAIAAAAAAA |          |  1
 Books                                              | computers                                          | exportimaxi #12                                    | ationcallyn stpriought                             |   2001 |     3 |     9 | AAAAAAAACAAAAAAA |          |  1
 Books                                              | computers                                          | exportimaxi #12                                    | ationcallyn stpriought                             |   2001 |     4 |    10 | AAAAAAAABAAAAAAA |          |  1
 Books                                              | computers                                          | exportimaxi #12                                    | n stn stationese                                   |   2001 |     4 |    11 | AAAAAAAAIAAAAAAA |          |  1
 Books                                              | computers                                          | exportimaxi #12                                    | prieingationeseought                               |   2001 |     2 |     6 | AAAAAAAAEAAAAAAA |          |  1
 Books                                              | computers                                          | exportimaxi #2                                     | antibarn steing                                    |   2002 |     1 |     2 | AAAAAAAAHAAAAAAA |          |  1
 Books                                              | computers                                          | exportimaxi #4                                     | ationcallyantipri                                  |   2001 |     3 |     8 | AAAAAAAACAAAAAAA |          |  1
 Books                                              | computers                                          | exportimaxi #4                                     | ationcallyantipri                                  |   2001 |     4 |    11 | AAAAAAAABAAAAAAA |          |  1
 Books                                              | computers                                          | exportimaxi #4                                     | ationeingcallycally                                |   2002 |     1 |     3 | AAAAAAAAIAAAAAAA |          |  1
 Books                                              | computers                                          | exportimaxi #4                                     | ationeseableeing                                   |   2001 |     4 |    12 | AAAAAAAAIAAAAAAA |          |  1
 Books                                              | computers                                          | exportimaxi #4                                     | n stationoughtbarought                             |   2001 |     4 |    11 | AAAAAAAAEAAAAAAA |          |  1
 Books                                              | computers                                          | exportimaxi #6                                     | oughtcallyeingationought                           |   2001 |     4 |    10 | AAAAAAAAIAAAAAAA |          |  1
 Books                                              | computers                                          | exportimaxi #6                                     | oughtcallyeingationought                           |   2001 |     4 |    11 | AAAAAAAAEAAAAAAA |          |  1
 Books                                              | computers                                          | exportimaxi #7                                     | callyableableoughtought                            |   2002 |     2 |     4 | AAAAAAAABAAAAAAA |          |  1
 Books                                              | computers                                          | exportimaxi #7                                     | eingoughtoughtationought                           |   2002 |     2 |     5 | AAAAAAAACAAAAAAA |          |  1
 Books                                              | computers                                          | exportimaxi #7                                     | eseantiationanti                                   |   2002 |     1 |     3 | AAAAAAAAKAAAAAAA |          |  1
 Books                                              | computers                                          | exportimaxi #8                                     | ationcallyoughtationought                          |   2001 |     3 |     9 | AAAAAAAACAAAAAAA |          |  1
 Books                                              | computers                                          | exportimaxi #8                                     | n stn stableeseought                               |   2001 |     2 |     6 | AAAAAAAAKAAAAAAA |          |  1
 Books                                              | computers                                          | exportimaxi #8                                     | n stn stableeseought                               |   2002 |     1 |     2 | AAAAAAAAIAAAAAAA |          |  1
 Books                                              | computers                                          | exportimaxi #8                                     | n stn stantioughtought                             |   2001 |     3 |     9 | AAAAAAAABAAAAAAA |          |  1
 Books                                              | computers                                          | exportimaxi #8                                     | n stn stantioughtought                             |   2002 |     1 |     3 | AAAAAAAAKAAAAAAA |          |  1
 Books                                              | computers                                          | exportimaxi #8                                     | prieingableableought                               |   2001 |     2 |     7 | AAAAAAAACAAAAAAA |          |  1
 Books                                              | computers                                          | exportimaxi #8                                     | prieingableableought                               |   2001 |     2 |     7 |                  |          |  1
 Books                                              | cooking                                            | amalgunivamalg #1                                  | ablen stantiationought                             |   2002 |     1 |     3 | AAAAAAAAEAAAAAAA |          |  1
 Books                                              | cooking                                            | amalgunivamalg #10                                 | antieseeseoughtought                               |   2002 |     2 |     4 | AAAAAAAAHAAAAAAA |          |  1
 Books                                              | cooking                                            | amalgunivamalg #10                                 | antieseeseoughtought                               |   2002 |     2 |     4 |                  |          |  1
 Books                                              | cooking                                            | amalgunivamalg #10                                 | priationantiableought                              |   2002 |     1 |     1 | AAAAAAAAKAAAAAAA |          |  1
 Books                                              | cooking                                            | amalgunivamalg #12                                 | n stantiationeing                                  |   2001 |     3 |     9 | AAAAAAAACAAAAAAA |          |  1
 Books                                              | cooking                                            | amalgunivamalg #2                                  | antieseationcally                                  |   2001 |     4 |    12 | AAAAAAAAHAAAAAAA |          |  1
 Books                                              | cooking                                            | amalgunivamalg #2                                  | oughtbareseanti                                    |   2002 |     1 |     1 | AAAAAAAAHAAAAAAA |          |  1
 Books                                              | cooking                                            | amalgunivamalg #2                                  | priantiantipri                                     |   2001 |     4 |    10 | AAAAAAAABAAAAAAA |          |  1
 Books                                              | cooking                                            | amalgunivamalg #2                                  | priantiantipri                                     |   2001 |     4 |    11 | AAAAAAAAKAAAAAAA |          |  1
 Books                                              | cooking                                            | amalgunivamalg #4                                  | antiationantibarought                              |   2002 |     1 |     1 | AAAAAAAAIAAAAAAA |          |  1
 Books                                              | cooking                                            | amalgunivamalg #4                                  | n stprin stableought                               |   2002 |     1 |     3 | AAAAAAAAIAAAAAAA |          |  1
 Books                                              | cooking                                            | amalgunivamalg #4                                  | n stpripriantiought                                |   2002 |     2 |     5 | AAAAAAAAHAAAAAAA |          |  1
 Books                                              | cooking                                            | amalgunivamalg #6                                  | oughteingationcallyought                           |   2001 |     2 |     6 | AAAAAAAAEAAAAAAA |          |  1
 Books                                              | cooking                                            | amalgunivamalg #8                                  | antiationcallyought                                |   2001 |     4 |    12 | AAAAAAAABAAAAAAA |          |  1
 Books                                              | cooking                                            | amalgunivamalg #8                                  | ationeingeingationought                            |   2001 |     3 |     8 | AAAAAAAAEAAAAAAA |          |  1
 Books                                              | cooking                                            | amalgunivamalg #8                                  | n stn stoughtcally                                 |   2002 |     1 |     3 | AAAAAAAAHAAAAAAA |          |  1
 Books                                              | entertainments                                     | edu packmaxi #1                                    | bareingcallycallyought                             |   2002 |     1 |     3 | AAAAAAAAIAAAAAAA |          |  1
 Books                                              | entertainments                                     | edu packmaxi #1                                    | bareingeseantiought                                |   2002 |     2 |     5 | AAAAAAAABAAAAAAA |          |  1
 Books                                              | entertainments                                     | edu packmaxi #1                                    | callyprianticallyought                             |   2002 |     1 |     2 | AAAAAAAAKAAAAAAA |          |  1
 Books                                              | entertainments                                     | edu packmaxi #10                                   | antiablebareseought                                |   2001 |     2 |     6 | AAAAAAAABAAAAAAA |          |  1
 Books                                              | entertainments                                     | edu packmaxi #10                                   | antieseeingought                                   |   2002 |     1 |     1 | AAAAAAAAEAAAAAAA |          |  1
 Books                                              | entertainments                                     | edu packmaxi #10                                   | antieseeseationought                               |   2002 |     2 |     5 | AAAAAAAACAAAAAAA |          |  1
 Books                                              | entertainments                                     | edu packmaxi #10                                   | n stableation                                      |   2001 |     3 |     7 | AAAAAAAABAAAAAAA |          |  1
 Books                                              | entertainments                                     | edu packmaxi #10                                   | n stbarantiought                                   |   2001 |     3 |     9 | AAAAAAAAIAAAAAAA |          |  1
 Books                                              | entertainments                                     | edu packmaxi #10                                   | n steingpricallyought                              |   2001 |     3 |     8 | AAAAAAAAEAAAAAAA |          |  1
 Books                                              | entertainments                                     | edu packmaxi #10                                   | n steingpricallyought                              |   2001 |     4 |    12 | AAAAAAAAHAAAAAAA |          |  1
(100 rows)

