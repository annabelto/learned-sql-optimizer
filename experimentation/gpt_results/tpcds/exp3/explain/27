                                                                              QUERY PLAN                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=5988.94..39329.09 rows=100 width=152)
   ->  GroupAggregate  (cost=5988.94..126346.89 rows=361 width=152)
         Group Key: item.i_item_id, store.s_state
         Group Key: item.i_item_id
         Group Key: ()
         ->  Nested Loop  (cost=5988.94..126336.07 rows=180 width=39)
               Join Filter: (store_sales.ss_item_sk = item.i_item_sk)
               ->  Gather Merge  (cost=3043.71..5095.18 rows=18000 width=21)
                     Workers Planned: 1
                     ->  Sort  (cost=2043.70..2070.17 rows=10588 width=21)
                           Sort Key: item.i_item_id
                           ->  Parallel Seq Scan on item  (cost=0.00..1335.88 rows=10588 width=21)
               ->  Materialize  (cost=2945.23..72641.34 rows=180 width=26)
                     ->  Nested Loop  (cost=2945.23..72640.44 rows=180 width=26)
                           Join Filter: (store_sales.ss_store_sk = store.s_store_sk)
                           ->  Gather  (cost=2945.23..72607.71 rows=188 width=27)
                                 Workers Planned: 2
                                 ->  Nested Loop  (cost=1945.23..71588.91 rows=78 width=27)
                                       ->  Parallel Hash Join  (cost=1944.80..68794.21 rows=5702 width=31)
                                             Hash Cond: (store_sales.ss_sold_date_sk = date_dim.d_date_sk)
                                             ->  Parallel Seq Scan on store_sales  (cost=0.00..63698.56 rows=1200256 width=35)
                                             ->  Parallel Hash  (cost=1942.12..1942.12 rows=214 width=4)
                                                   ->  Parallel Seq Scan on date_dim  (cost=0.00..1942.12 rows=214 width=4)
                                                         Filter: (d_year = 1999)
                                       ->  Index Scan using customer_demographics_pkey on customer_demographics  (cost=0.43..0.49 rows=1 width=4)
                                             Index Cond: (cd_demo_sk = store_sales.ss_cdemo_sk)
                                             Filter: ((cd_gender = 'M'::bpchar) AND (cd_marital_status = 'W'::bpchar) AND (cd_education_status = 'Secondary'::bpchar))
                           ->  Materialize  (cost=0.00..1.21 rows=12 width=7)
                                 ->  Seq Scan on store  (cost=0.00..1.15 rows=12 width=7)
                                       Filter: (s_state = 'TN'::bpchar)
(30 rows)

    i_item_id     | s_state | g_state |        agg1         |         agg2         |          agg3          |          agg4          
------------------+---------+---------+---------------------+----------------------+------------------------+------------------------
 AAAAAAAAAABBAAAA | TN      |       0 | 34.5000000000000000 |  69.7250000000000000 | 0.00000000000000000000 |    20.3550000000000000
 AAAAAAAAAABBAAAA |         |       1 | 34.5000000000000000 |  69.7250000000000000 | 0.00000000000000000000 |    20.3550000000000000
 AAAAAAAAAABDAAAA | TN      |       0 | 46.6666666666666667 |  51.1233333333333333 | 0.00000000000000000000 |    47.1266666666666667
 AAAAAAAAAABDAAAA |         |       1 | 46.6666666666666667 |  51.1233333333333333 | 0.00000000000000000000 |    47.1266666666666667
 AAAAAAAAAACCAAAA | TN      |       0 | 94.0000000000000000 |  78.2400000000000000 | 0.00000000000000000000 |    26.6000000000000000
 AAAAAAAAAACCAAAA |         |       1 | 94.0000000000000000 |  78.2400000000000000 | 0.00000000000000000000 |    26.6000000000000000
 AAAAAAAAAACDAAAA | TN      |       0 | 34.6666666666666667 |  74.5866666666666667 | 0.00000000000000000000 |    47.8000000000000000
 AAAAAAAAAACDAAAA |         |       1 | 34.6666666666666667 |  74.5866666666666667 | 0.00000000000000000000 |    47.8000000000000000
 AAAAAAAAAADCAAAA | TN      |       0 | 15.0000000000000000 |  96.4300000000000000 | 0.00000000000000000000 |    40.5000000000000000
 AAAAAAAAAADCAAAA |         |       1 | 15.0000000000000000 |  96.4300000000000000 | 0.00000000000000000000 |    40.5000000000000000
 AAAAAAAAAADEAAAA | TN      |       0 | 62.0000000000000000 |  79.5800000000000000 | 0.00000000000000000000 |    78.7800000000000000
 AAAAAAAAAADEAAAA |         |       1 | 62.0000000000000000 |  79.5800000000000000 | 0.00000000000000000000 |    78.7800000000000000
 AAAAAAAAAAEAAAAA | TN      |       0 | 16.0000000000000000 |  83.1200000000000000 | 0.00000000000000000000 |    29.0900000000000000
 AAAAAAAAAAEAAAAA |         |       1 | 16.0000000000000000 |  83.1200000000000000 | 0.00000000000000000000 |    29.0900000000000000
 AAAAAAAAAAEBAAAA | TN      |       0 | 14.0000000000000000 |  52.1900000000000000 | 0.00000000000000000000 |     4.1150000000000000
 AAAAAAAAAAEBAAAA |         |       1 | 14.0000000000000000 |  52.1900000000000000 | 0.00000000000000000000 |     4.1150000000000000
 AAAAAAAAAAEEAAAA | TN      |       0 | 19.0000000000000000 |  68.4700000000000000 | 0.00000000000000000000 |    30.1200000000000000
 AAAAAAAAAAEEAAAA |         |       1 | 19.0000000000000000 |  68.4700000000000000 | 0.00000000000000000000 |    30.1200000000000000
 AAAAAAAAAAFAAAAA | TN      |       0 | 57.0000000000000000 |  40.2500000000000000 |   219.5100000000000000 |    13.2800000000000000
 AAAAAAAAAAFAAAAA |         |       1 | 57.0000000000000000 |  40.2500000000000000 |   219.5100000000000000 |    13.2800000000000000
 AAAAAAAAAAFCAAAA | TN      |       0 | 41.0000000000000000 | 110.2500000000000000 | 0.00000000000000000000 |    41.8900000000000000
 AAAAAAAAAAFCAAAA |         |       1 | 41.0000000000000000 | 110.2500000000000000 | 0.00000000000000000000 |    41.8900000000000000
 AAAAAAAAAAFDAAAA | TN      |       0 | 74.5000000000000000 | 133.5550000000000000 | 0.00000000000000000000 |    66.9800000000000000
 AAAAAAAAAAFDAAAA |         |       1 | 74.5000000000000000 | 133.5550000000000000 | 0.00000000000000000000 |    66.9800000000000000
 AAAAAAAAAAGCAAAA | TN      |       0 | 33.5000000000000000 |  15.8900000000000000 | 0.00000000000000000000 |    15.0350000000000000
 AAAAAAAAAAGCAAAA |         |       1 | 33.5000000000000000 |  15.8900000000000000 | 0.00000000000000000000 |    15.0350000000000000
 AAAAAAAAAAHAAAAA | TN      |       0 | 77.0000000000000000 |  63.7100000000000000 | 0.00000000000000000000 |    47.1400000000000000
 AAAAAAAAAAHAAAAA |         |       1 | 77.0000000000000000 |  63.7100000000000000 | 0.00000000000000000000 |    47.1400000000000000
 AAAAAAAAAAIAAAAA | TN      |       0 |  6.0000000000000000 |  97.2800000000000000 | 0.00000000000000000000 |    30.6150000000000000
 AAAAAAAAAAIAAAAA |         |       1 |  6.0000000000000000 |  97.2800000000000000 | 0.00000000000000000000 |    30.6150000000000000
 AAAAAAAAAAICAAAA | TN      |       0 | 95.0000000000000000 | 130.7600000000000000 |  2194.6900000000000000 |    40.5300000000000000
 AAAAAAAAAAICAAAA |         |       1 | 95.0000000000000000 | 130.7600000000000000 |  2194.6900000000000000 |    40.5300000000000000
 AAAAAAAAAAIDAAAA | TN      |       0 | 66.5000000000000000 | 130.9400000000000000 | 0.00000000000000000000 |    76.4250000000000000
 AAAAAAAAAAIDAAAA |         |       1 | 66.5000000000000000 | 130.9400000000000000 | 0.00000000000000000000 |    76.4250000000000000
 AAAAAAAAAAJBAAAA | TN      |       0 | 96.0000000000000000 |  62.4200000000000000 |   278.6400000000000000 |    58.0500000000000000
 AAAAAAAAAAJBAAAA |         |       1 | 96.0000000000000000 |  62.4200000000000000 |   278.6400000000000000 |    58.0500000000000000
 AAAAAAAAAAJCAAAA | TN      |       0 | 57.0000000000000000 | 101.6400000000000000 | 0.00000000000000000000 |    10.1600000000000000
 AAAAAAAAAAJCAAAA |         |       1 | 57.0000000000000000 | 101.6400000000000000 | 0.00000000000000000000 |    10.1600000000000000
 AAAAAAAAAAKAAAAA | TN      |       0 | 47.0000000000000000 | 148.0600000000000000 |  1928.8800000000000000 |   114.0000000000000000
 AAAAAAAAAAKAAAAA |         |       1 | 47.0000000000000000 | 148.0600000000000000 |  1928.8800000000000000 |   114.0000000000000000
 AAAAAAAAAAKBAAAA | TN      |       0 | 55.0000000000000000 |  88.3000000000000000 | 0.00000000000000000000 |    39.2050000000000000
 AAAAAAAAAAKBAAAA |         |       1 | 55.0000000000000000 |  88.3000000000000000 | 0.00000000000000000000 |    39.2050000000000000
 AAAAAAAAAAKDAAAA | TN      |       0 | 37.5000000000000000 |  80.0300000000000000 | 0.00000000000000000000 |    41.5100000000000000
 AAAAAAAAAAKDAAAA |         |       1 | 37.5000000000000000 |  80.0300000000000000 | 0.00000000000000000000 |    41.5100000000000000
 AAAAAAAAAALAAAAA | TN      |       0 | 71.0000000000000000 | 135.6150000000000000 | 0.00000000000000000000 |    79.4100000000000000
 AAAAAAAAAALAAAAA |         |       1 | 71.0000000000000000 | 135.6150000000000000 | 0.00000000000000000000 |    79.4100000000000000
 AAAAAAAAAALCAAAA | TN      |       0 |  4.0000000000000000 | 119.9800000000000000 | 0.00000000000000000000 |    33.5900000000000000
 AAAAAAAAAALCAAAA |         |       1 |  4.0000000000000000 | 119.9800000000000000 | 0.00000000000000000000 |    33.5900000000000000
 AAAAAAAAAALDAAAA | TN      |       0 | 52.5000000000000000 |  26.6600000000000000 |     9.2600000000000000 |     6.7700000000000000
 AAAAAAAAAALDAAAA |         |       1 | 52.5000000000000000 |  26.6600000000000000 |     9.2600000000000000 |     6.7700000000000000
 AAAAAAAAAAMBAAAA | TN      |       0 | 45.0000000000000000 | 138.8600000000000000 |   638.5600000000000000 |   101.3600000000000000
 AAAAAAAAAAMBAAAA |         |       1 | 45.0000000000000000 | 138.8600000000000000 |   638.5600000000000000 |   101.3600000000000000
 AAAAAAAAAAMCAAAA | TN      |       0 | 23.0000000000000000 |  58.8000000000000000 | 0.00000000000000000000 |    26.4600000000000000
 AAAAAAAAAAMCAAAA |         |       1 | 23.0000000000000000 |  58.8000000000000000 | 0.00000000000000000000 |    26.4600000000000000
 AAAAAAAAAANAAAAA | TN      |       0 | 79.0000000000000000 |  32.2200000000000000 | 0.00000000000000000000 |     4.8300000000000000
 AAAAAAAAAANAAAAA |         |       1 | 79.0000000000000000 |  32.2200000000000000 | 0.00000000000000000000 |     4.8300000000000000
 AAAAAAAAAANBAAAA | TN      |       0 | 39.5000000000000000 |  42.7850000000000000 | 0.70000000000000000000 |    23.8300000000000000
 AAAAAAAAAANBAAAA |         |       1 | 39.5000000000000000 |  42.7850000000000000 | 0.70000000000000000000 |    23.8300000000000000
 AAAAAAAAAANDAAAA | TN      |       0 | 15.0000000000000000 |  89.8300000000000000 |   122.3600000000000000 |    43.8200000000000000
 AAAAAAAAAANDAAAA |         |       1 | 15.0000000000000000 |  89.8300000000000000 |   122.3600000000000000 |    43.8200000000000000
 AAAAAAAAAAOAAAAA | TN      |       0 | 92.0000000000000000 | 149.2600000000000000 | 0.00000000000000000000 |    65.6700000000000000
 AAAAAAAAAAOAAAAA |         |       1 | 92.0000000000000000 | 149.2600000000000000 | 0.00000000000000000000 |    65.6700000000000000
 AAAAAAAAAAODAAAA | TN      |       0 | 82.0000000000000000 |  74.4700000000000000 | 0.00000000000000000000 |    58.8300000000000000
 AAAAAAAAAAODAAAA |         |       1 | 82.0000000000000000 |  74.4700000000000000 | 0.00000000000000000000 |    58.8300000000000000
 AAAAAAAAAAPBAAAA | TN      |       0 | 97.0000000000000000 |  75.4700000000000000 | 0.00000000000000000000 |    30.1800000000000000
 AAAAAAAAAAPBAAAA |         |       1 | 97.0000000000000000 |  75.4700000000000000 | 0.00000000000000000000 |    30.1800000000000000
 AAAAAAAAABADAAAA | TN      |       0 | 77.0000000000000000 | 138.6800000000000000 | 0.00000000000000000000 |    54.0800000000000000
 AAAAAAAAABADAAAA |         |       1 | 77.0000000000000000 | 138.6800000000000000 | 0.00000000000000000000 |    54.0800000000000000
 AAAAAAAAABAEAAAA | TN      |       0 | 64.5000000000000000 |  54.4000000000000000 | 0.00000000000000000000 |    12.9300000000000000
 AAAAAAAAABAEAAAA |         |       1 | 64.5000000000000000 |  54.4000000000000000 | 0.00000000000000000000 |    12.9300000000000000
 AAAAAAAAABBAAAAA | TN      |       0 |  2.0000000000000000 |  75.4000000000000000 | 0.00000000000000000000 |    21.1100000000000000
 AAAAAAAAABBAAAAA |         |       1 |  2.0000000000000000 |  75.4000000000000000 | 0.00000000000000000000 |    21.1100000000000000
 AAAAAAAAABBDAAAA | TN      |       0 | 49.0000000000000000 |  56.8300000000000000 |    35.1250000000000000 |    34.8950000000000000
 AAAAAAAAABBDAAAA |         |       1 | 49.0000000000000000 |  56.8300000000000000 |    35.1250000000000000 |    34.8950000000000000
 AAAAAAAAABCCAAAA | TN      |       0 | 40.0000000000000000 |  90.4600000000000000 | 0.00000000000000000000 |    72.3600000000000000
 AAAAAAAAABCCAAAA |         |       1 | 40.0000000000000000 |  90.4600000000000000 | 0.00000000000000000000 |    72.3600000000000000
 AAAAAAAAABCEAAAA | TN      |       0 | 73.0000000000000000 |  46.4000000000000000 |  2212.5050000000000000 |    33.8950000000000000
 AAAAAAAAABCEAAAA |         |       1 | 73.0000000000000000 |  46.4000000000000000 |  2212.5050000000000000 |    33.8950000000000000
 AAAAAAAAABDBAAAA | TN      |       0 | 73.0000000000000000 |  47.9200000000000000 | 0.00000000000000000000 |    20.6000000000000000
 AAAAAAAAABDBAAAA |         |       1 | 73.0000000000000000 |  47.9200000000000000 | 0.00000000000000000000 |    20.6000000000000000
 AAAAAAAAABDDAAAA | TN      |       0 | 30.0000000000000000 |  84.6400000000000000 | 0.00000000000000000000 |    35.5400000000000000
 AAAAAAAAABDDAAAA |         |       1 | 30.0000000000000000 |  84.6400000000000000 | 0.00000000000000000000 |    35.5400000000000000
 AAAAAAAAABDEAAAA | TN      |       0 | 33.0000000000000000 | 128.5900000000000000 | 0.00000000000000000000 |    99.0100000000000000
 AAAAAAAAABDEAAAA |         |       1 | 33.0000000000000000 | 128.5900000000000000 | 0.00000000000000000000 |    99.0100000000000000
 AAAAAAAAABEAAAAA | TN      |       0 | 54.0000000000000000 |  13.7900000000000000 | 0.00000000000000000000 |     4.4100000000000000
 AAAAAAAAABEAAAAA |         |       1 | 54.0000000000000000 |  13.7900000000000000 | 0.00000000000000000000 |     4.4100000000000000
 AAAAAAAAABECAAAA | TN      |       0 | 85.0000000000000000 |   3.5000000000000000 | 0.00000000000000000000 | 0.21000000000000000000
 AAAAAAAAABECAAAA |         |       1 | 85.0000000000000000 |   3.5000000000000000 | 0.00000000000000000000 | 0.21000000000000000000
 AAAAAAAAABEDAAAA | TN      |       0 | 95.0000000000000000 |  93.7100000000000000 |  3642.8700000000000000 |    87.1500000000000000
 AAAAAAAAABEDAAAA |         |       1 | 95.0000000000000000 |  93.7100000000000000 |  3642.8700000000000000 |    87.1500000000000000
 AAAAAAAAABFBAAAA | TN      |       0 |  5.0000000000000000 |  48.6800000000000000 |     4.8100000000000000 |     2.9200000000000000
 AAAAAAAAABFBAAAA |         |       1 |  5.0000000000000000 |  48.6800000000000000 |     4.8100000000000000 |     2.9200000000000000
 AAAAAAAAABFCAAAA | TN      |       0 | 26.0000000000000000 |  64.1000000000000000 | 0.00000000000000000000 | 0.64000000000000000000
 AAAAAAAAABFCAAAA |         |       1 | 26.0000000000000000 |  64.1000000000000000 | 0.00000000000000000000 | 0.64000000000000000000
 AAAAAAAAABFEAAAA | TN      |       0 | 48.0000000000000000 | 112.7900000000000000 | 0.00000000000000000000 |    49.6200000000000000
 AAAAAAAAABFEAAAA |         |       1 | 48.0000000000000000 | 112.7900000000000000 | 0.00000000000000000000 |    49.6200000000000000
 AAAAAAAAABGBAAAA | TN      |       0 | 57.0000000000000000 | 118.7166666666666667 | 0.00000000000000000000 |    31.4766666666666667
 AAAAAAAAABGBAAAA |         |       1 | 57.0000000000000000 | 118.7166666666666667 | 0.00000000000000000000 |    31.4766666666666667
 AAAAAAAAABGDAAAA | TN      |       0 | 15.0000000000000000 |  68.1550000000000000 | 0.39000000000000000000 |    54.3650000000000000
 AAAAAAAAABGDAAAA |         |       1 | 15.0000000000000000 |  68.1550000000000000 | 0.39000000000000000000 |    54.3650000000000000
(100 rows)

